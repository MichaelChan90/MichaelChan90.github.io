<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Michael Chan"><meta name="copyright" content="Michael Chan"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>Centos7å®‰è£…MySQL | MichaelChan Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="mask-icon" href="/favicon.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"michaelchan90.github.io","root":"/","title":"æ˜Ÿæ— å°˜çš„åšå®¢","version":"1.10.9","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=UA-164931119-1"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-164931119-1');
}</script><script data-ad-client="ca-pub-9775647830683925" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="[toc] ä¸‹è½½å®‰è£…ç³»ç»Ÿï¼šCentos7 MySQL 5.7ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;cdn.mysql.com&#x2F;archives&#x2F;mysql-5.7&#x2F;mysql-5.7.40-1.el7.x86_64.rpm-bundle.tar MySQL 8.0ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;cdn.mysql.com&#x2F;&#x2F;Downloads&#x2F;MySQL-8.0&#x2F;mysql-8.0.32-1.el7.x86_64.">
<meta property="og:type" content="article">
<meta property="og:title" content="Centos7å®‰è£…MySQL">
<meta property="og:url" content="http://michaelchan90.github.io/2023/02/10/Centos7%E5%AE%89%E8%A3%85MySQL/index.html">
<meta property="og:site_name" content="MichaelChan Blog">
<meta property="og:description" content="[toc] ä¸‹è½½å®‰è£…ç³»ç»Ÿï¼šCentos7 MySQL 5.7ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;cdn.mysql.com&#x2F;archives&#x2F;mysql-5.7&#x2F;mysql-5.7.40-1.el7.x86_64.rpm-bundle.tar MySQL 8.0ä¸‹è½½åœ°å€ï¼šhttps:&#x2F;&#x2F;cdn.mysql.com&#x2F;&#x2F;Downloads&#x2F;MySQL-8.0&#x2F;mysql-8.0.32-1.el7.x86_64.">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-02-10T09:46:44.000Z">
<meta property="article:modified_time" content="2023-03-28T03:01:15.975Z">
<meta property="article:author" content="Michael Chan">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="Michael Chan"><img width="96" loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/go.jpg" alt="Michael Chan"><span class="site-author-status" title="åˆæ˜¯æ–°çš„ä¸€å¤©">ğŸ¤”</span></a><div class="site-author-name"><a href="/about/">Michael Chan</a></div><a class="site-name" href="/about/site.html">MichaelChan Blog</a><sub class="site-subtitle">æ˜Ÿæ— å°˜</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="ä¸»é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£(archives)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">22</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»(categories)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">20</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾(tags)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">3</span></a></div></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/michaelchan90" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:michaelchan90@outlook.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.</span> <span class="toc-text">ä¸‹è½½</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E6%A3%80%E6%9F%A5"><span class="toc-number">2.1.</span> <span class="toc-text">é¢„æ£€æŸ¥</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rpm%E5%AE%89%E8%A3%85"><span class="toc-number">2.2.</span> <span class="toc-text">rpmå®‰è£…</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">é…ç½®</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5"><span class="toc-number">4.</span> <span class="toc-text">é—®é¢˜æ’æŸ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql-%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99Host-name-could-not-be-resolved%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">mysql å¯åŠ¨æŠ¥é”™Host name could not be resolvedè§£å†³åŠæ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%88%90%E5%90%8E%EF%BC%8C%E5%90%AF%E5%8A%A8mysql%E6%9C%8D%E5%8A%A1%E5%90%8E%EF%BC%8C%E8%BF%9E%E6%8E%A5mysql%E6%8A%A5%E9%94%99%EF%BC%9AERROR-2002-HY000-Can%E2%80%99t-connect-to-local-MySQL-server-through-socket-%E2%80%98-x2F-var-x2F-lib-x2F-mysql-x2F-mysql-sock%E2%80%99-2"><span class="toc-number">4.2.</span> <span class="toc-text">mysqlé…ç½®å®Œæˆåï¼Œå¯åŠ¨mysqlæœåŠ¡åï¼Œè¿æ¥mysqlæŠ¥é”™ï¼šERROR 2002 (HY000): Canâ€™t connect to local MySQL server through socket â€˜&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sockâ€™ (2)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%BA%E5%A4%B1%E5%8C%85"><span class="toc-number">4.3.</span> <span class="toc-text">ç¼ºå¤±åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85mysql-community-libs-compat%E6%97%B6%E6%8A%A5%E9%94%99%E5%A6%82%E4%B8%8B%EF%BC%9A"><span class="toc-number">4.3.1.</span> <span class="toc-text">å®‰è£…mysql-community-libs-compatæ—¶æŠ¥é”™å¦‚ä¸‹ï¼š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85mysql-community-client%E6%97%B6%E9%94%99%E6%8A%A5"><span class="toc-number">4.3.2.</span> <span class="toc-text">å®‰è£…mysql-community-clientæ—¶é”™æŠ¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85mysql-community-server%E6%8A%A5%E9%94%99"><span class="toc-number">4.4.</span> <span class="toc-text">å®‰è£…mysql-community-serveræŠ¥é”™</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E7%9B%AE%E5%BD%95%E5%90%8E%E5%90%AF%E5%8A%A8%E6%8A%A5%E9%94%99"><span class="toc-number">4.5.</span> <span class="toc-text">ä¿®æ”¹æ•°æ®ç›®å½•åå¯åŠ¨æŠ¥é”™</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://michaelchan90.github.io/2023/02/10/Centos7%E5%AE%89%E8%A3%85MySQL/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Michael Chan"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="MichaelChan Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Centos7å®‰è£…MySQL</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-10 17:46:44" itemprop="dateCreated datePublished" datetime="2023-02-10T17:46:44+08:00">2023-02-10</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-03-28 11:01:15" itemprop="dateModified" datetime="2023-03-28T11:01:15+08:00">2023-03-28</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">8.8k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">34m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ•°æ®åº“</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">MySQL</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>[toc]</p>
<h1 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h1><p>å®‰è£…ç³»ç»Ÿï¼šCentos7</p>
<p>MySQL 5.7ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.40-1.el7.x86_64.rpm-bundle.tar">https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.40-1.el7.x86_64.rpm-bundle.tar</a></p>
<p>MySQL 8.0ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.32-1.el7.x86_64.rpm-bundle.tar">https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.32-1.el7.x86_64.rpm-bundle.tar</a></p>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><h2 id="é¢„æ£€æŸ¥"><a href="#é¢„æ£€æŸ¥" class="headerlink" title="é¢„æ£€æŸ¥"></a>é¢„æ£€æŸ¥</h2><p>1ã€æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…MySQLæˆ–è€…Mariadbï¼Œå­˜åœ¨åˆ™è¿›è¡Œå¸è½½</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rpmæŸ¥çœ‹å·²å®‰è£…è½¯ä»¶</span></span><br><span class="line">rpm -qa|grep mariadb</span><br><span class="line">rpm -qa|grep mysql</span><br><span class="line"><span class="comment"># rpmå¸è½½è½¯ä»¶</span></span><br><span class="line">rpm -e --nodeps ******</span><br><span class="line"></span><br><span class="line"><span class="comment"># yumæŸ¥çœ‹å·²å®‰è£…è½¯ä»¶</span></span><br><span class="line">yum list installed |grep mariadb</span><br><span class="line">yum list installed |grep mysql</span><br><span class="line"><span class="comment"># yumå¸è½½è½¯ä»¶</span></span><br><span class="line">yum remove ******</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤etcç›®å½•ä¸‹my.cnf</span></span><br><span class="line"><span class="built_in">rm</span> /etc/my.cnf</span><br></pre></td></tr></table></figure>



<p>2ã€Centos7åˆ›å»ºç”¨æˆ·</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç»„mysql</span></span><br><span class="line">groupadd mysql</span><br><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·mysql</span></span><br><span class="line">useradd -r -g mysql mysql</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”¨æˆ·</span></span><br><span class="line"><span class="built_in">cat</span> /etc/passwd</span><br></pre></td></tr></table></figure>

<p>3ã€è§£å‹æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">tar -xvf mysql-5.7.40-1.el7.x86_64.rpm-bundle.tar</span><br><span class="line"><span class="comment"># ä¿®æ”¹è§£å‹åŒ…ä¸‹æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·ç»„ã€ç”¨æˆ·ä»¥åŠæƒé™</span></span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql mysqlç›®å½•</span><br><span class="line"><span class="built_in">chmod</span> -R 755 mysqlç›®å½•</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="rpmå®‰è£…"><a href="#rpmå®‰è£…" class="headerlink" title="rpmå®‰è£…"></a>rpmå®‰è£…</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‰é¡ºåºå®‰è£…ä»¥ä¸‹åŒ…</span></span><br><span class="line">rpm -ivh mysql-community-common*</span><br><span class="line">rpm -ivh mysql-community-libs*</span><br><span class="line">rpm -ivh mysql-community-client*</span><br><span class="line">rpm -ivh mysql-community-server*</span><br></pre></td></tr></table></figure>



<h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><p>1ã€å¯åŠ¨æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨MySQLæœåŠ¡</span></span><br><span class="line">service mysqld start</span><br><span class="line"><span class="comment"># æŸ¥çœ‹MySQLå¯åŠ¨çŠ¶æ€</span></span><br><span class="line">service mysqld status</span><br><span class="line"><span class="comment"># è®¾ç½®MySQLå¼€æœºå¯åŠ¨</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld.service</span><br><span class="line"><span class="comment"># æŸ¥çœ‹MySQLå¼€æœºå¯åŠ¨çŠ¶æ€</span></span><br><span class="line">systemctl status mysqld.service</span><br></pre></td></tr></table></figure>



<p>2ã€ä¿®æ”¹MySQL rootç”¨æˆ·å¯†ç </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éšæœºç”Ÿæˆå¯†ç  </span></span><br><span class="line"><span class="built_in">tr</span> -dc   <span class="string">&#x27;A-Za-z0-9!&quot;#$%&amp;&#x27;</span>\<span class="string">&#x27;&#x27;</span>()*+,-./:;&lt;=&gt;?@[\]^_`&#123;|&#125;~<span class="string">&#x27;   &lt;/dev/urandom | head -c 15; echo</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># æŸ¥çœ‹åˆå§‹åŒ–å¯†ç </span></span><br><span class="line"><span class="string">cat /var/log/mysqld.log|grep password</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ä½¿ç”¨åˆå§‹åŒ–å¯†ç ç™»å½•mysql</span></span><br><span class="line"><span class="string">mysql -uroot -p</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># åˆå§‹ä¿®æ”¹rootç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="string">alter user user() identified by &#x27;</span>Hyjz@123<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ä¿®æ”¹rootå¯ä»¥è¿œç¨‹ç™»å½•</span></span><br><span class="line"><span class="string">use mysql;</span></span><br><span class="line"><span class="string">update user set host = &#x27;</span>%<span class="string">&#x27; where user = &#x27;</span>root<span class="string">&#x27;;</span></span><br><span class="line"><span class="string">FLUSH PRIVILEGES;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># æŸ¥çœ‹å¯†ç ç­–ç•¥ï¼ˆæµ‹è¯•ç¯å¢ƒç”¨äºç®€çŸ­çš„å¯†ç ï¼‰</span></span><br><span class="line"><span class="string">show variables like &#x27;</span>validate_password%<span class="string">&#x27;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ===================å¯†ç è§„åˆ™è®¾ç½®====================</span></span><br><span class="line"><span class="string"># 1ï¼‰ã€validate_password_length å›ºå®šå¯†ç çš„æ€»é•¿åº¦ï¼›</span></span><br><span class="line"><span class="string"># 2ï¼‰ã€validate_password_dictionary_file æŒ‡å®šå¯†ç éªŒè¯çš„æ–‡ä»¶è·¯å¾„ï¼›</span></span><br><span class="line"><span class="string"># 3ï¼‰ã€validate_password_mixed_case_count æ•´ä¸ªå¯†ç ä¸­è‡³å°‘è¦åŒ…å«å¤§/å°å†™å­—æ¯çš„æ€»ä¸ªæ•°ï¼›</span></span><br><span class="line"><span class="string"># 4ï¼‰ã€validate_password_number_count æ•´ä¸ªå¯†ç ä¸­è‡³å°‘è¦åŒ…å«é˜¿æ‹‰ä¼¯æ•°å­—çš„ä¸ªæ•°ï¼›</span></span><br><span class="line"><span class="string"># 5ï¼‰ã€validate_password_policy æŒ‡å®šå¯†ç çš„å¼ºåº¦éªŒè¯ç­‰çº§ï¼Œé»˜è®¤ä¸º MEDIUMï¼›</span></span><br><span class="line"><span class="string">#    å…³äº validate_password_policy çš„å–å€¼ï¼š</span></span><br><span class="line"><span class="string">#    0/LOWï¼šåªéªŒè¯é•¿åº¦ï¼›</span></span><br><span class="line"><span class="string">#    1/MEDIUMï¼šéªŒè¯é•¿åº¦ã€æ•°å­—ã€å¤§å°å†™ã€ç‰¹æ®Šå­—ç¬¦ï¼›</span></span><br><span class="line"><span class="string">#    2/STRONGï¼šéªŒè¯é•¿åº¦ã€æ•°å­—ã€å¤§å°å†™ã€ç‰¹æ®Šå­—ç¬¦ã€å­—å…¸æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="string"># 6ï¼‰ã€validate_password_special_char_count æ•´ä¸ªå¯†ç ä¸­è‡³å°‘è¦åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ä¸ªæ•°ï¼›</span></span><br><span class="line"><span class="string"># ===================å¯†ç è§„åˆ™è®¾ç½®====================</span></span><br><span class="line"><span class="string">set global validate_password_policy=LOW;</span></span><br><span class="line"><span class="string">set global validate_password_length=6;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># äºŒæ¬¡ä¿®æ”¹rootç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="string">set password for &#x27;</span>root<span class="string">&#x27;@&#x27;</span>localhost<span class="string">&#x27;=password(&#x27;</span>hyjz@123<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>



<p>3ã€è‡ªå®šä¹‰mysqlé…ç½®æ–‡ä»¶ï¼ˆ&#x2F;etc&#x2F;my.cnfä¸­é…ç½®ï¼‰</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[client]</span></span><br><span class="line"><span class="comment"># MySQL å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ç«¯æ—¶ä½¿ç”¨çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸º 3306</span></span><br><span class="line"><span class="attr">port</span>=<span class="string">3306</span></span><br><span class="line"><span class="comment"># å¥—æ¥å­—æ–‡ä»¶æ‰€åœ¨ç›®å½•(ä¸mysqld,mysqlé…ç½®ä¸€è‡´)</span></span><br><span class="line"><span class="attr">socket</span>=<span class="string">/var/run/mysql/mysql.sock</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">[mysqldump]</span></span><br><span class="line"><span class="comment"># æ”¯æŒè¾ƒå¤§çš„æ•°æ®åº“è½¬å‚¨ï¼Œå¯¼å‡ºéå¸¸å·¨å¤§çš„è¡¨æ—¶éœ€è¦æ­¤é¡¹ ã€‚</span></span><br><span class="line"><span class="attr">quick</span></span><br><span class="line"><span class="comment"># æœåŠ¡æ‰€èƒ½å¤„ç†çš„è¯·æ±‚åŒ…çš„æœ€å¤§å¤§å°ä»¥åŠæœåŠ¡æ‰€èƒ½å¤„ç†çš„æœ€å¤§çš„è¯·æ±‚å¤§å°ï¼ˆå½“ä¸å¤§çš„BLOBå­—æ®µä¸€èµ·å·¥ä½œæ—¶ç›¸å½“å¿…è¦ï¼‰ï¼Œæ¯ä¸ªè¿æ¥ç‹¬ç«‹çš„å¤§å°ï¼Œå¤§å°åŠ¨æ€å¢åŠ ã€‚</span></span><br><span class="line"><span class="attr">max_allowed_packet</span> = <span class="string">16M</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">[mysqld]</span></span><br><span class="line"><span class="comment"># mysqld ç¨‹åºåœ¨å¯åŠ¨åå°†åœ¨ç»™å®š UNIX/Linux è´¦æˆ·ä¸‹æ‰§è¡Œã€‚mysqld å¿…é¡»ä» root è´¦æˆ·å¯åŠ¨æ‰èƒ½åœ¨å¯åŠ¨ååˆ‡æ¢åˆ°å¦ä¸€ä¸ªè´¦æˆ·ä¸‹æ‰§è¡Œã€‚mysqld_safe è„šæœ¬å°†é»˜è®¤ä½¿ç”¨ user=mysql é€‰é¡¹æ¥å¯åŠ¨ mysqld ç¨‹åºã€‚</span></span><br><span class="line"><span class="attr">user</span> = <span class="string">mysql</span></span><br><span class="line"><span class="comment"># æŒ‡å®š MySQL å®‰è£…çš„ç»å¯¹è·¯å¾„ï¼›</span></span><br><span class="line"><span class="attr">basedir</span> = <span class="string">/usr/local/mysql</span></span><br><span class="line"><span class="comment"># æŒ‡å®š MySQL æ•°æ®å­˜æ”¾çš„ç»å¯¹è·¯å¾„ï¼›</span></span><br><span class="line"><span class="attr">datadir</span> = <span class="string">/mydata/mysql/data</span></span><br><span class="line"><span class="comment"># ç›‘å¬çš„ipåœ°å€</span></span><br><span class="line"><span class="attr">bind-address</span> = <span class="string">0.0.0.0ã€€ã€€</span></span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯å£å·ï¼Œé»˜è®¤ä¸º 3306</span></span><br><span class="line"><span class="attr">port</span>=<span class="string">3306</span></span><br><span class="line"><span class="comment"># MySQL æœåŠ¡çš„å”¯ä¸€ç¼–å·ï¼Œæ¯ä¸ª MySQL æœåŠ¡çš„ id éœ€å”¯ä¸€ã€‚</span></span><br><span class="line"><span class="attr">server-id</span> = <span class="string">1</span></span><br><span class="line"><span class="comment"># socket æ–‡ä»¶æ‰€åœ¨ç›®å½•</span></span><br><span class="line"><span class="attr">socket</span>=<span class="string">/var/run/mysql/mysql.sock</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†ï¼Œä¸»æµå­—ç¬¦é›†æ”¯æŒä¸€äº›ç‰¹æ®Šè¡¨æƒ…ç¬¦å·ï¼ˆç‰¹æ®Šè¡¨æƒ…ç¬¦å ç”¨ 4 ä¸ªå­—èŠ‚ï¼‰</span></span><br><span class="line"><span class="attr">character-set-server</span> = <span class="string">utf8mb4</span></span><br><span class="line"><span class="comment"># æ•°æ®åº“å­—ç¬¦é›†å¯¹åº”ä¸€äº›æ’åºç­‰è§„åˆ™ï¼Œæ³¨æ„è¦å’Œ character-set-server å¯¹åº”</span></span><br><span class="line"><span class="attr">collation-server</span> = <span class="string">utf8mb4_general_ci</span></span><br><span class="line"><span class="comment"># è®¾ç½® client è¿æ¥ mysql æ—¶çš„å­—ç¬¦é›†ï¼Œé˜²æ­¢ä¹±ç </span></span><br><span class="line"><span class="attr">init_connect</span>=<span class="string">&#x27;SET NAMES utf8mb4&#x27;</span></span><br><span class="line"><span class="comment"># æ˜¯å¦å¯¹ sql è¯­å¥å¤§å°å†™æ•æ„Ÿï¼Œ1 è¡¨ç¤ºä¸æ•æ„Ÿ</span></span><br><span class="line"><span class="attr">lower_case_table_names</span> = <span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ç”¨äºæŒ‡å®šç´¢å¼•ç¼“å†²åŒºçš„å¤§å°</span></span><br><span class="line"><span class="attr">key_buffer_size</span>=<span class="string">6G</span></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸€æ¬¡æ¶ˆæ¯ä¼ è¾“çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="attr">max_allowed_packet</span>=<span class="string">8M</span></span><br><span class="line"><span class="comment"># ä»…ä»…å…è®¸ä½¿ç”¨é”®å€¼çš„ UPDATES å’Œ DELETES</span></span><br><span class="line"><span class="attr">no-auto-rehash</span></span><br><span class="line"><span class="comment"># è¡¨ç¤º SQL æ¨¡å¼çš„å‚æ•°ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®æ£€éªŒ SQL è¯­å¥çš„ä¸¥æ ¼ç¨‹åº¦</span></span><br><span class="line"><span class="attr">sql_mode</span>=<span class="string">TRADITIONAL</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ===================================skip options ======================================</span></span><br><span class="line"><span class="comment"># ç¦æ­¢ MySQL å¯¹å¤–éƒ¨è¿æ¥è¿›è¡Œ DNS è§£æï¼Œä½¿ç”¨è¿™ä¸€é€‰é¡¹å¯ä»¥æ¶ˆé™¤ MySQL è¿›è¡Œ DNS è§£æçš„æ—¶é—´ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œå¦‚æœå¼€å¯è¯¥é€‰é¡¹ï¼Œåˆ™æ‰€æœ‰è¿œç¨‹ä¸»æœºè¿æ¥æˆæƒéƒ½è¦ä½¿ç”¨ IP åœ°å€æ–¹å¼ï¼Œå¦åˆ™ MySQL å°†æ— æ³•æ­£å¸¸å¤„ç†è¿æ¥è¯·æ±‚ï¼</span></span><br><span class="line"><span class="attr">skip-name-resolve</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ä¸èƒ½ä½¿ç”¨è¿æ¥æ–‡ä»¶ï¼Œå¤šä¸ªå®¢æˆ·å¯èƒ½ä¼šè®¿é—®åŒä¸€ä¸ªæ•°æ®åº“ï¼Œå› æ­¤è¿™é˜²æ­¢å¤–éƒ¨å®¢æˆ·é”å®š MySQL æœåŠ¡å™¨ã€‚ è¯¥é€‰é¡¹é»˜è®¤å¼€å¯</span></span><br><span class="line"><span class="attr">skip-symbolic-links</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ä¸ä½¿ç”¨ç³»ç»Ÿé”å®šï¼Œè¦ä½¿ç”¨ myisamchk,å¿…é¡»å…³é—­æœåŠ¡å™¨ ,é¿å… MySQLçš„å¤–éƒ¨é”å®šï¼Œå‡å°‘å‡ºé”™å‡ ç‡å¢å¼ºç¨³å®šæ€§ã€‚</span></span><br><span class="line"><span class="attr">skip-external-locking</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¯åŠ¨ mysql,ä¸å¯åŠ¨å¤åˆ¶</span></span><br><span class="line"><span class="attr">skip-slave-start</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¼€å¯è¯¥é€‰é¡¹å¯ä»¥å½»åº•å…³é—­ MySQL çš„ TCP/IP è¿æ¥æ–¹å¼ï¼Œå¦‚æœ WEB æœåŠ¡å™¨æ˜¯ä»¥è¿œç¨‹è¿æ¥çš„æ–¹å¼è®¿é—® MySQL æ•°æ®åº“æœåŠ¡å™¨åˆ™ä¸è¦å¼€å¯è¯¥é€‰é¡¹ï¼å¦åˆ™å°†æ— æ³•æ­£å¸¸è¿æ¥ï¼ å¦‚æœæ‰€æœ‰çš„è¿›ç¨‹éƒ½æ˜¯åœ¨åŒä¸€å°æœåŠ¡å™¨è¿æ¥åˆ°æœ¬åœ°çš„ mysqld, è¿™æ ·è®¾ç½®å°†æ˜¯å¢å¼ºå®‰å…¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="attr">skip-networking</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŠŠSYSDATE å‡½æ•°ç¼–ç¨‹ä¸º NOWçš„åˆ«å</span></span><br><span class="line"><span class="attr">sysdate-is-now</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"># æŠŠSYSDATE å‡½æ•°ç¼–ç¨‹ä¸º NOWçš„åˆ«å</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ============================== ç³»ç»Ÿèµ„æºç›¸å…³é€‰é¡¹ ===============================#</span></span><br><span class="line"><span class="comment"># æ¥å—é˜Ÿåˆ—ï¼Œå¯¹äºæ²¡å»ºç«‹ tcp è¿æ¥çš„è¯·æ±‚é˜Ÿåˆ—æ”¾å…¥ç¼“å­˜ä¸­ï¼Œé˜Ÿåˆ—å¤§å°ä¸º back_logï¼Œå—é™åˆ¶ä¸ OS å‚æ•°ï¼Œè¯•å›¾è®¾å®š back_log é«˜äºä½ çš„æ“ä½œç³»ç»Ÿçš„é™åˆ¶å°†æ˜¯æ— æ•ˆçš„ã€‚é»˜è®¤å€¼ä¸º 50ã€‚å¯¹äº Linux ç³»ç»Ÿæ¨èè®¾ç½®ä¸ºå°äº512çš„æ•´æ•°ã€‚å¦‚æœç³»ç»Ÿåœ¨ä¸€ä¸ªçŸ­æ—¶é—´å†…æœ‰å¾ˆå¤šè¿æ¥ï¼Œåˆ™éœ€è¦å¢å¤§è¯¥å‚æ•°çš„å€¼</span></span><br><span class="line"><span class="attr">back_log</span> = <span class="string">50 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šMySQLå…è®¸çš„æœ€å¤§è¿æ¥è¿›ç¨‹æ•°ã€‚å¦‚æœåœ¨è®¿é—®æ•°æ®åº“æ—¶ç»å¸¸å‡ºç°&quot;Too Many Connections&quot;çš„é”™è¯¯æ ç¤ºï¼Œåˆ™éœ€è¦å¢å¤§è¯¥å‚æ•°å€¼ã€‚</span></span><br><span class="line"><span class="attr">max_connections</span> = <span class="string">1000 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœæŸä¸ªç”¨æˆ·å‘èµ·çš„è¿æ¥ error è¶…è¿‡è¯¥æ•°å€¼ï¼Œåˆ™è¯¥ç”¨æˆ·çš„ä¸‹æ¬¡è¿æ¥å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç®¡ç†å‘˜æ‰§è¡Œ flush hosts ; å‘½ä»¤æˆ–è€…æœåŠ¡é‡å¯ï¼Œ é˜²æ­¢é»‘å®¢ ï¼Œ éæ³•çš„å¯†ç ä»¥åŠå…¶ä»–åœ¨é“¾æ¥æ—¶çš„é”™è¯¯ä¼šå¢åŠ æ­¤å€¼</span></span><br><span class="line"><span class="attr">max_connect_errors</span> = <span class="string">10000 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># MySQLæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Œé»˜è®¤æœ€å°1024;å½“open_files_limitæ²¡æœ‰è¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒmax_connections*5å’Œulimit-nçš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªï¼Œå½“open_file_limitè¢«é…ç½®çš„æ—¶å€™ï¼Œæ¯”è¾ƒopen_files_limitå’Œmax_connections*5çš„å€¼ï¼Œå“ªä¸ªå¤§ç”¨å“ªä¸ªã€‚</span></span><br><span class="line"><span class="attr">open_files_limit</span> = <span class="string">10240 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è¿æ¥è¶…æ—¶ä¹‹å‰çš„æœ€å¤§ç§’æ•°,åœ¨ Linux å¹³å°ä¸Šï¼Œè¯¥è¶…æ—¶ä¹Ÿç”¨ä½œç­‰å¾…æœåŠ¡å™¨é¦–æ¬¡å›åº”çš„æ—¶é—´</span></span><br><span class="line"><span class="attr">connect-timeout</span> = <span class="string">10 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ç­‰å¾…å…³é—­è¿æ¥çš„æ—¶é—´</span></span><br><span class="line"><span class="attr">wait-timeout</span> = <span class="string">28800 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å…³é—­è¿æ¥ä¹‹å‰ï¼Œå…è®¸ interactive_timeoutï¼ˆå–ä»£äº†wait_timeoutï¼‰ç§’çš„ä¸æ´»åŠ¨æ—¶é—´ã€‚å®¢æˆ·ç«¯çš„ä¼šè¯ wait_timeout å˜é‡è¢«è®¾ä¸ºä¼šè¯interactive_timeout å˜é‡çš„å€¼ã€‚å¦‚æœå‰ç«¯ç¨‹åºé‡‡ç”¨çŸ­è¿æ¥ï¼Œå»ºè®®ç¼©çŸ­è¿™2ä¸ªå€¼, å¦‚æœå‰ç«¯ç¨‹åºé‡‡ç”¨é•¿è¿æ¥ï¼Œå¯ç›´æ¥æ³¨é‡Šæ‰è¿™ä¸¤ä¸ªé€‰é¡¹ï¼Œé»˜è®¤é…ç½®(8å°æ—¶)  </span></span><br><span class="line"><span class="attr">interactive-timeout</span> = <span class="string">28800 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ä»æœåŠ¡å™¨ä¹Ÿèƒ½å¤Ÿå¤„ç†ç½‘ç»œè¿æ¥ä¸­æ–­ã€‚ä½†æ˜¯ï¼Œåªæœ‰ä»æœåŠ¡å™¨è¶…è¿‡slave_net_timeout ç§’æ²¡æœ‰ä»ä¸»æœåŠ¡å™¨æ”¶åˆ°æ•°æ®æ‰é€šçŸ¥ç½‘ç»œä¸­æ–­</span></span><br><span class="line"><span class="attr">slave-net-timeout</span> = <span class="string">600 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ä»æœåŠ¡å™¨è¯»å–ä¿¡æ¯çš„è¶…æ—¶</span></span><br><span class="line"><span class="attr">net_read_timeout</span> = <span class="string">30 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ä»æœåŠ¡å™¨å†™å…¥ä¿¡æ¯çš„è¶…æ—¶</span></span><br><span class="line"><span class="attr">net_write_timeout</span> = <span class="string">60 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœæŸä¸ªé€šä¿¡ç«¯å£çš„è¯»æ“ä½œä¸­æ–­äº†ï¼Œåœ¨æ”¾å¼ƒå‰é‡è¯•å¤šæ¬¡</span></span><br><span class="line"><span class="attr">net_retry_count</span> = <span class="string">10 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åŒ…æ¶ˆæ¯ç¼“å†²åŒºåˆå§‹åŒ–ä¸º net_buffer_length å­—èŠ‚ï¼Œä½†éœ€è¦æ—¶å¯ä»¥å¢é•¿åˆ° max_allowed_packet å­—èŠ‚</span></span><br><span class="line"><span class="attr">net_buffer_length</span> = <span class="string">16384 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æœåŠ¡æ‰€èƒ½å¤„ç†çš„è¯·æ±‚åŒ…çš„æœ€å¤§å¤§å°ä»¥åŠæœåŠ¡æ‰€èƒ½å¤„ç†çš„æœ€å¤§çš„è¯·æ±‚å¤§å°(å½“ä¸å¤§çš„BLOB å­—æ®µä¸€èµ·å·¥ä½œæ—¶ç›¸å½“å¿…è¦)ï¼Œ æ¯ä¸ªè¿æ¥ç‹¬ç«‹çš„å¤§å°.å¤§å°åŠ¨æ€å¢åŠ ã€‚ è®¾ç½®æœ€å¤§åŒ…,é™åˆ¶serveræ¥å—çš„æ•°æ®åŒ…å¤§å°ï¼Œé¿å…è¶…é•¿SQLçš„æ‰§è¡Œæœ‰é—®é¢˜ é»˜è®¤å€¼ä¸º16Mï¼Œå½“MySQLå®¢æˆ·ç«¯æˆ–mysqld</span></span><br><span class="line"><span class="attr">max_allowed_packet</span> = <span class="string">64M</span></span><br><span class="line"><span class="attr">æœåŠ¡å™¨æ”¶åˆ°å¤§äº</span> <span class="string">max_allowed_packet å­—èŠ‚çš„ä¿¡æ¯åŒ…æ—¶ï¼Œå°†å‘å‡ºâ€œä¿¡æ¯åŒ…è¿‡å¤§â€é”™è¯¯ï¼Œå¹¶å…³é—­è¿æ¥ã€‚å¯¹äºæŸäº›å®¢æˆ·ç«¯ï¼Œå¦‚æœé€šä¿¡ä¿¡æ¯åŒ…è¿‡å¤§ï¼Œåœ¨æ‰§è¡ŒæŸ¥è¯¢æœŸé—´ï¼Œå¯èƒ½ä¼šé‡åˆ°â€œä¸¢å¤±ä¸ MySQL æœåŠ¡å™¨çš„è¿æ¥â€é”™è¯¯ã€‚é»˜è®¤å€¼ 16Mã€‚</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ‰€æœ‰çº¿ç¨‹æ‰€æ‰“å¼€è¡¨çš„æ•°é‡. å¢åŠ æ­¤å€¼å°±å¢åŠ äº†mysqldæ‰€éœ€è¦çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡è¿™æ ·ä½ éœ€è¦ç¡®è®¤åœ¨[mysqld_safe]ä¸­ â€œopen-files-limitâ€ å˜é‡è®¾ç½®æ‰“å¼€æ–‡ä»¶æ•°é‡å…è®¸è‡³å°‘4096</span></span><br><span class="line"><span class="attr">table_cache</span> = <span class="string">512 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># çº¿ç¨‹ä½¿ç”¨çš„å †å¤§å°. æ­¤å®¹é‡çš„å†…å­˜åœ¨æ¯æ¬¡è¿æ¥æ—¶è¢«é¢„ç•™.MySQL æœ¬èº«å¸¸ä¸ä¼šéœ€è¦è¶…è¿‡ 64K çš„å†…å­˜å¦‚æœä½ ä½¿ç”¨ä½ è‡ªå·±çš„éœ€è¦å¤§é‡å †çš„ UDF å‡½æ•°æˆ–è€…ä½ çš„æ“ä½œç³»ç»Ÿå¯¹äºæŸäº›æ“ä½œéœ€è¦æ›´å¤šçš„å †,ä½ ä¹Ÿè®¸éœ€è¦å°†å…¶è®¾ç½®çš„æ›´é«˜ä¸€ç‚¹.é»˜è®¤è®¾ç½®è¶³ä»¥æ»¡è¶³å¤§å¤šæ•°åº”ç”¨</span></span><br><span class="line"><span class="attr">thread_stack</span> = <span class="string">192K </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æˆ‘ä»¬åœ¨ cache ä¸­ä¿ç•™å¤šå°‘çº¿ç¨‹ç”¨äºé‡ç”¨.å½“ä¸€ä¸ªå®¢æˆ·ç«¯æ–­å¼€è¿æ¥å,å¦‚æœ cache ä¸­çš„çº¿ç¨‹è¿˜å°‘äº thread_cache_size,åˆ™å®¢æˆ·ç«¯çº¿ç¨‹è¢«æ”¾å…¥ cache ä¸­.è¿™å¯ä»¥åœ¨ä½ éœ€è¦å¤§é‡æ–°è¿æ¥çš„æ—¶å€™æå¤§çš„å‡å°‘çº¿ç¨‹åˆ›å»ºçš„å¼€é”€(ä¸€èˆ¬æ¥è¯´å¦‚æœä½ æœ‰å¥½çš„çº¿ç¨‹æ¨¡å‹çš„è¯,è¿™ä¸ä¼šæœ‰æ˜æ˜¾çš„æ€§èƒ½æå‡.)æœåŠ¡å™¨çº¿ç¨‹ç¼“å­˜è¿™ä¸ªå€¼è¡¨ç¤ºå¯ä»¥é‡æ–°åˆ©ç”¨ä¿å­˜åœ¨ç¼“å­˜ä¸­çº¿ç¨‹çš„æ•°é‡,å½“æ–­å¼€è¿æ¥æ—¶å¦‚æœç¼“å­˜ä¸­è¿˜æœ‰ç©ºé—´,é‚£ä¹ˆå®¢æˆ·ç«¯çš„çº¿ç¨‹å°†è¢«æ”¾åˆ°ç¼“å­˜ä¸­,å¦‚æœçº¿ç¨‹é‡æ–°è¢«è¯·æ±‚ï¼Œé‚£ä¹ˆè¯·æ±‚å°†ä»ç¼“å­˜ä¸­è¯»å–,å¦‚æœç¼“å­˜ä¸­æ˜¯ç©ºçš„æˆ–è€…æ˜¯æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°†è¢«é‡æ–°åˆ›å»º,å¦‚æœæœ‰å¾ˆå¤šæ–°çš„çº¿ç¨‹ï¼Œå¢åŠ è¿™ä¸ªå€¼å¯ä»¥æ”¹å–„ç³»ç»Ÿæ€§èƒ½.é€šè¿‡æ¯”è¾ƒ Connections å’Œ Threads_created çŠ¶æ€çš„å˜é‡ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªå˜é‡çš„ä½œç”¨</span></span><br><span class="line"><span class="comment">#   æ ¹æ®ç‰©ç†å†…å­˜è®¾ç½®è§„åˆ™å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">#   1G  â€”&gt; 8</span></span><br><span class="line"><span class="comment">#   2G  â€”&gt; 16</span></span><br><span class="line"><span class="comment">#   3G  â€”&gt; 32</span></span><br><span class="line"><span class="comment">#   å¤§äº3G  â€”&gt; 64</span></span><br><span class="line"><span class="attr">thread_cache_size</span> = <span class="string">20 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ­¤å…è®¸åº”ç”¨ç¨‹åºç»™äºˆçº¿ç¨‹ç³»ç»Ÿä¸€ä¸ªæç¤ºåœ¨åŒä¸€æ—¶é—´ç»™äºˆæ¸´æœ›è¢«è¿è¡Œçš„çº¿ç¨‹çš„æ•°é‡.è¯¥å‚æ•°å–å€¼ä¸ºæœåŠ¡å™¨é€»è¾‘CPUæ•°é‡Ã—2ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼ŒæœåŠ¡å™¨æœ‰ 2 é¢—ç‰©ç†CPUï¼Œè€Œæ¯é¢—ç‰©ç†CPUåˆæ”¯æŒH.Tè¶…çº¿ç¨‹ï¼Œæ‰€ä»¥å®é™…å–å€¼ä¸º 4 Ã— 2 ï¼ 8.è®¾ç½® thread_concurrencyçš„å€¼çš„æ­£ç¡®ä¸å¦, å¯¹ mysql çš„æ€§èƒ½å½±å“å¾ˆå¤§, åœ¨å¤šä¸ª cpu(æˆ–å¤šæ ¸)çš„æƒ…å†µä¸‹ï¼Œé”™è¯¯è®¾ç½®äº† thread_concurrency çš„å€¼, ä¼šå¯¼è‡´ mysql ä¸èƒ½å……åˆ†åˆ©ç”¨å¤š cpu(æˆ–å¤šæ ¸),å‡ºç°åŒä¸€æ—¶åˆ»åªèƒ½ä¸€ä¸ª cpu(æˆ–æ ¸)åœ¨å·¥ä½œçš„æƒ…å†µã€‚ thread_concurrency åº”è®¾ä¸º CPU æ ¸æ•°çš„ 2 å€.æ¯”å¦‚æœ‰ä¸€ä¸ªåŒæ ¸çš„ CPU, é‚£ä¹ˆ thread_concurrency çš„åº”è¯¥ä¸º 4; 2 ä¸ªåŒæ ¸çš„ cpu,thread_concurrency çš„å€¼åº”ä¸º 8,å±é‡ç‚¹ä¼˜åŒ–å‚æ•°</span></span><br><span class="line"><span class="attr">thread_concurrency</span> = <span class="string">8 </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"># =============================qcache settings ç›¸å…³é€‰é¡¹ ==================================#</span></span><br><span class="line"><span class="comment"># ä¸ç¼“å­˜æŸ¥è¯¢å¤§äºè¯¥å€¼çš„ç»“æœ.åªæœ‰å°äºæ­¤è®¾å®šå€¼çš„ç»“æœæ‰ä¼šè¢«ç¼“å†²,  æ­¤è®¾ç½®ç”¨æ¥ä¿æŠ¤æŸ¥è¯¢ç¼“å†²,é˜²æ­¢ä¸€ä¸ªæå¤§çš„ç»“æœé›†å°†å…¶ä»–æ‰€æœ‰çš„æŸ¥è¯¢ç»“æœéƒ½è¦†ç›–.</span></span><br><span class="line"><span class="attr">query_cache_limit</span> = <span class="string">2M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŸ¥è¯¢ç¼“å­˜åˆ†é…çš„æœ€å°å—å¤§å°.é»˜è®¤æ˜¯ 4KBï¼Œè®¾ç½®å€¼å¤§å¯¹å¤§æ•°æ®æŸ¥è¯¢æœ‰å¥½å¤„ï¼Œä½†å¦‚æœä½ çš„æŸ¥è¯¢éƒ½æ˜¯å°æ•°æ®æŸ¥è¯¢ï¼Œå°±å®¹æ˜“é€ æˆå†…å­˜ç¢ç‰‡å’Œæµªè´¹</span></span><br><span class="line"><span class="comment">#   æŸ¥è¯¢ç¼“å­˜ç¢ç‰‡ç‡ = Qcache_free_blocks / Qcache_total_blocks * 100%</span></span><br><span class="line"><span class="comment">#   å¦‚æœæŸ¥è¯¢ç¼“å­˜ç¢ç‰‡ç‡è¶…è¿‡ 20%ï¼Œå¯ä»¥ç”¨ FLUSH QUERY CACHE æ•´ç†ç¼“å­˜ç¢ç‰‡ï¼Œæˆ–è€…è¯•è¯•å‡å°query_cache_min_res_unitï¼Œå¦‚æœä½ çš„æŸ¥è¯¢éƒ½æ˜¯å°æ•°æ®é‡çš„è¯ã€‚</span></span><br><span class="line"><span class="comment">#   æŸ¥è¯¢ç¼“å­˜åˆ©ç”¨ç‡ = (query_cache_size â€“ Qcache_free_memory) / query_cache_size *100%</span></span><br><span class="line"><span class="comment">#   æŸ¥è¯¢ç¼“å­˜åˆ©ç”¨ç‡åœ¨ 25%ä»¥ä¸‹çš„è¯è¯´æ˜ query_cache_size è®¾ç½®çš„è¿‡å¤§ï¼Œå¯é€‚å½“å‡å°;æŸ¥è¯¢ç¼“å­˜åˆ©ç”¨ç‡åœ¨ 80%ä»¥ä¸Šè€Œä¸” Qcache_lowmem_prunes &gt; 50 çš„è¯è¯´æ˜ query_cache_size å¯èƒ½æœ‰ç‚¹å°ï¼Œè¦ä¸å°±æ˜¯ç¢ç‰‡å¤ªå¤šã€‚</span></span><br><span class="line"><span class="comment">#   æŸ¥è¯¢ç¼“å­˜å‘½ä¸­ç‡ = (Qcache_hits â€“ Qcache_inserts) / Qcache_hits * 100%</span></span><br><span class="line"><span class="attr">query_cache_min_res_unit</span> = <span class="string">2K </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®š MySQL æŸ¥è¯¢ç¼“å†²åŒºçš„å¤§å°ã€‚å¯ä»¥é€šè¿‡åœ¨ MySQL æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è§‚å¯Ÿï¼š</span></span><br><span class="line"><span class="comment">#   ä»£ç :</span></span><br><span class="line"><span class="comment">#   &gt; SHOW VARIABLES LIKE &#x27;%query_cache%&#x27;;</span></span><br><span class="line"><span class="comment">#   &gt; SHOW STATUS LIKE &#x27;Qcache%&#x27;;å¦‚æœ Qcache_lowmem_prunes çš„å€¼éå¸¸å¤§ï¼Œåˆ™è¡¨æ˜ç»å¸¸å‡ºç°ç¼“å†²ä¸å¤Ÿçš„æƒ…å†µï¼›</span></span><br><span class="line"><span class="comment">#   å¦‚æœ Qcache_hits çš„å€¼éå¸¸å¤§ï¼Œåˆ™è¡¨æ˜æŸ¥è¯¢ç¼“å†²ä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œå¦‚æœè¯¥å€¼è¾ƒå°åè€Œä¼šå½±å“æ•ˆç‡ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ä¸ç”¨æŸ¥è¯¢ç¼“å†²ï¼› Qcache_free_blocksï¼Œå¦‚æœè¯¥å€¼éå¸¸å¤§ï¼Œåˆ™è¡¨æ˜ç¼“å†²åŒºä¸­ç¢ç‰‡å¾ˆå¤šã€‚</span></span><br><span class="line"><span class="comment">#   memlock # å¦‚æœä½ çš„ç³»ç»Ÿæ”¯æŒ memlock() å‡½æ•°,ä½ ä¹Ÿè®¸å¸Œæœ›æ‰“å¼€æ­¤é€‰é¡¹ç”¨ä»¥è®©è¿è¡Œä¸­çš„ mysql åœ¨åœ¨å†…å­˜é«˜åº¦</span></span><br><span class="line"><span class="comment">#   ç´§å¼ çš„æ—¶å€™,æ•°æ®åœ¨å†…å­˜ä¸­ä¿æŒé”å®šå¹¶ä¸”é˜²æ­¢å¯èƒ½è¢« swapping out,æ­¤é€‰é¡¹å¯¹äºæ€§èƒ½æœ‰ç›Š</span></span><br><span class="line"><span class="attr">query_cache_size</span> = <span class="string">64M  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># =================================default settings ç›¸å…³é€‰é¡¹========================================</span></span><br><span class="line"><span class="comment"># å½“åˆ›å»ºæ–°è¡¨æ—¶ä½œä¸ºé»˜è®¤ä½¿ç”¨çš„è¡¨ç±»å‹,å¦‚æœåœ¨åˆ›å»ºè¡¨ç¤ºæ²¡æœ‰ç‰¹åˆ«æ‰§è¡Œè¡¨ç±»å‹,å°†ä¼šä½¿ç”¨æ­¤å€¼</span></span><br><span class="line"><span class="attr">default_table_type</span> = <span class="string">InnoDB </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æœåŠ¡å™¨æ—¶åŒº</span></span><br><span class="line"><span class="attr">default-time-zone</span> = <span class="string">system </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#é»˜è®¤å­˜å‚¨å¼•æ“</span></span><br><span class="line"><span class="attr">default-storage-engine</span> = <span class="string">InnoDB </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ====================================tmp &amp;&amp; heap settings ========================================</span></span><br><span class="line"><span class="comment">#ä¸´æ—¶è¡¨çš„æœ€å¤§å¤§å°ï¼Œå¦‚æœè¶…è¿‡è¯¥å€¼ï¼Œåˆ™ç»“æœæ”¾åˆ°ç£ç›˜ä¸­,æ­¤é™åˆ¶æ˜¯é’ˆå¯¹å•ä¸ªè¡¨çš„,è€Œä¸æ˜¯æ€»å’Œ.</span></span><br><span class="line"><span class="attr">tmp_table_size</span> = <span class="string">512M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#ç‹¬ç«‹çš„å†…å­˜è¡¨æ‰€å…è®¸çš„æœ€å¤§å®¹é‡.æ­¤é€‰é¡¹ä¸ºäº†é˜²æ­¢æ„å¤–åˆ›å»ºä¸€ä¸ªè¶…å¤§çš„å†…å­˜è¡¨å¯¼è‡´æ°¸å°½æ‰€æœ‰çš„å†…å­˜èµ„æº.</span></span><br><span class="line"><span class="attr">max_heap_table_size</span> = <span class="string">512M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#  ======================================log settings ç›¸å…³é€‰é¡¹ ======================================</span></span><br><span class="line"><span class="comment"># æ‰“å¼€äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½.åœ¨å¤åˆ¶(replication)é…ç½®ä¸­,ä½œä¸º MASTER ä¸»æœåŠ¡å™¨å¿…é¡»æ‰“å¼€æ­¤é¡¹.å¦‚æœä½ éœ€è¦ä»ä½ æœ€åçš„å¤‡ä»½ä¸­åšåŸºäºæ—¶é—´ç‚¹çš„æ¢å¤,ä½ ä¹ŸåŒæ ·éœ€è¦äºŒè¿›åˆ¶æ—¥å¿—.è¿™äº›è·¯å¾„ç›¸å¯¹äº datadir</span></span><br><span class="line"><span class="attr">log-bin</span> = <span class="string">mysql-bin </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è¡¨ç¤ºslaveå°†å¤åˆ¶äº‹ä»¶å†™è¿›è‡ªå·±çš„äºŒè¿›åˆ¶æ—¥å¿—</span></span><br><span class="line"><span class="attr">log_slave_updates</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># äºŒè¿›åˆ¶çš„ç´¢å¼•æ–‡ä»¶å</span></span><br><span class="line"><span class="attr">log-bin-index</span> = <span class="string">mysql-bin.index </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å®šä¹‰relay_logçš„ä½ç½®å’Œåç§°ï¼Œå¦‚æœå€¼ä¸ºç©ºï¼Œåˆ™é»˜è®¤ä½ç½®åœ¨æ•°æ®æ–‡ä»¶çš„ç›®å½•ï¼Œæ–‡ä»¶åä¸ºhost_name-relay-bin.nnnnnnï¼ˆBy default, relay log file names have the form host_name-relay-bin.nnnnnn in the data directoryï¼‰ï¼›</span></span><br><span class="line"><span class="attr">relay-log</span> = <span class="string">relay-log </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># relay-logçš„ç´¢å¼•æ–‡ä»¶å</span></span><br><span class="line"><span class="attr">relay_log_index</span> = <span class="string">relay-log.index  </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å°†è­¦å‘Šæ‰“å°è¾“å‡ºåˆ°é”™è¯¯ log æ–‡ä»¶.å¦‚æœä½ å¯¹äºMySQLæœ‰ä»»ä½•é—®é¢˜ï¼Œä½ åº”è¯¥æ‰“å¼€è­¦å‘Š log å¹¶ä¸”ä»”ç»†å®¡æŸ¥é”™è¯¯æ—¥å¿—,æŸ¥å‡ºå¯èƒ½çš„åŸå› .</span></span><br><span class="line"><span class="attr">log-warnings</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># é”™è¯¯æ—¥å¿—è·¯å¾„</span></span><br><span class="line"><span class="attr">log-error</span> =  <span class="string">/usr/local/mysql/log/mysql.err </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å‚æ•° log_output æŒ‡å®šäº†æ…¢æŸ¥è¯¢è¾“å‡ºçš„æ ¼å¼ï¼Œé»˜è®¤ä¸º FILEï¼Œä½ å¯ä»¥å°†å®ƒè®¾ä¸º TABLEï¼Œç„¶åå°±å¯ä»¥æŸ¥è¯¢ mysql æ¶æ„ä¸‹çš„ slow_log è¡¨äº†</span></span><br><span class="line"><span class="attr">log_output</span> = <span class="string">FILE </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šæ˜¯å¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—(è¯¥å‚æ•°è¦è¢«slow_query_logå–ä»£ï¼Œåšå…¼å®¹æ€§ä¿ç•™)</span></span><br><span class="line"><span class="attr">log_slow_queries</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šæ˜¯å¦å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—. æ…¢æŸ¥è¯¢æ˜¯æŒ‡æ¶ˆè€—äº†æ¯” â€œlong_query_timeâ€ å®šä¹‰çš„æ›´å¤šæ—¶é—´çš„æŸ¥è¯¢.å¦‚æœ log_long_format è¢«æ‰“å¼€,é‚£äº›æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢ä¹Ÿä¼šè¢«è®°å½•.å¦‚æœä½ ç»å¸¸å¢åŠ æ–°æŸ¥è¯¢åˆ°å·²æœ‰çš„ç³»ç»Ÿå†…çš„è¯. ä¸€èˆ¬æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå¥½ä¸»æ„,</span></span><br><span class="line"><span class="attr">slow_query_log</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®¾å®šæ…¢æŸ¥è¯¢çš„é˜€å€¼ï¼Œè¶…å‡ºæ¬¡è®¾å®šå€¼çš„SQLå³è¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œç¼ºçœå€¼ä¸º10s.æ‰€æœ‰çš„ä½¿ç”¨äº†æ¯”è¿™ä¸ªæ—¶é—´(ä»¥ç§’ä¸ºå•ä½)æ›´å¤šçš„æŸ¥è¯¢ä¼šè¢«è®¤ä¸ºæ˜¯æ…¢é€ŸæŸ¥è¯¢.ä¸è¦åœ¨è¿™é‡Œä½¿ç”¨â€1â€³, å¦åˆ™ä¼šå¯¼è‡´æ‰€æœ‰çš„æŸ¥è¯¢,ç”šè‡³éå¸¸å¿«çš„æŸ¥è¯¢é¡µè¢«è®°å½•ä¸‹æ¥(ç”±äºMySQL ç›®å‰æ—¶é—´çš„ç²¾ç¡®åº¦åªèƒ½è¾¾åˆ°ç§’çš„çº§åˆ«).</span></span><br><span class="line"><span class="attr">long-query-time</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åœ¨æ…¢é€Ÿæ—¥å¿—ä¸­è®°å½•æ›´å¤šçš„ä¿¡æ¯.ä¸€èˆ¬æ­¤é¡¹æœ€å¥½æ‰“å¼€ï¼Œæ‰“å¼€æ­¤é¡¹ä¼šè®°å½•ä½¿å¾—é‚£äº›æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢ä¹Ÿè¢«ä½œä¸ºåˆ°æ…¢é€ŸæŸ¥è¯¢é™„åŠ åˆ°æ…¢é€Ÿæ—¥å¿—é‡Œ</span></span><br><span class="line"><span class="attr">log_long_format</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šæ…¢æ—¥å¿—æ–‡ä»¶å­˜æ”¾ä½ç½®ï¼Œå¯ä»¥ä¸ºç©ºï¼Œç³»ç»Ÿä¼šç»™ä¸€ä¸ªç¼ºçœçš„æ–‡ä»¶host_name-slow.log</span></span><br><span class="line"><span class="attr">slow_query_log_file</span> =  <span class="string">/usr/local/mysql/log/slow.log </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœè¿è¡Œçš„SQLè¯­å¥æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œåˆ™mysqlæ•°æ®åº“åŒæ ·ä¼šå°†è¿™æ¡SQLè¯­å¥è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="attr">log-queries-not-using-indexes</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®°å½•é‚£äº›ç”±äºæŸ¥æ‰¾äº†å¤šä½™1000æ¬¡è€Œå¼•å‘çš„æ…¢æŸ¥è¯¢</span></span><br><span class="line"><span class="attr">min_examined_row_limit</span>=<span class="string">1000ã€€ã€€ã€€ã€€</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®°å½•é‚£äº›æ…¢çš„optimize tableï¼Œanalyze tableå’Œalter tableè¯­å¥</span></span><br><span class="line"><span class="attr">long-slow-admin-statements</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®°å½•ç”±Slaveæ‰€äº§ç”Ÿçš„æ…¢æŸ¥è¯¢</span></span><br><span class="line"><span class="attr">log-slow-slave-statements</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å°†æ‰€æœ‰åˆ°è¾¾MySQL Serverçš„SQLè¯­å¥è®°å½•ä¸‹æ¥,é»˜è®¤å…³é—­ </span></span><br><span class="line"><span class="attr">general_log</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># general_logè·¯å¾„</span></span><br><span class="line"><span class="attr">general_log_file</span> =  <span class="string">/usr/local/mysql/log/mysql.log </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœäºŒè¿›åˆ¶æ—¥å¿—å†™å…¥çš„å†…å®¹è¶…å‡ºç»™å®šå€¼ï¼Œæ—¥å¿—å°±ä¼šå‘ç”Ÿæ»šåŠ¨ã€‚ä½ ä¸èƒ½å°†è¯¥å˜é‡è®¾ç½®ä¸ºå¤§äº1GBæˆ–å°äº4096å­—èŠ‚ã€‚ é»˜è®¤å€¼æ˜¯1GBã€‚å¦‚æœä½ æ­£ä½¿ç”¨å¤§çš„äº‹åŠ¡ï¼ŒäºŒè¿›åˆ¶æ—¥å¿—è¿˜ä¼šè¶…è¿‡max_binlog_size</span></span><br><span class="line"><span class="attr">max_binlog_size</span> = <span class="string">1G </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ ‡è®°relaylogå…è®¸çš„æœ€å¤§å€¼ï¼Œå¦‚æœè¯¥å€¼ä¸º0ï¼Œåˆ™é»˜è®¤å€¼ä¸ºmax_binlog_size(1G)ï¼›å¦‚æœä¸ä¸º0ï¼Œåˆ™max_relay_log_sizeåˆ™ä¸ºæœ€å¤§çš„relay_logæ–‡ä»¶å¤§å°ï¼›</span></span><br><span class="line"><span class="attr">max_relay_log_size</span> = <span class="string">1G </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ˜¯å¦è‡ªåŠ¨æ¸…ç©ºä¸å†éœ€è¦ä¸­ç»§æ—¥å¿—æ—¶ã€‚é»˜è®¤å€¼ä¸º1(å¯ç”¨)</span></span><br><span class="line"><span class="attr">relay-log-purge</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è¶…è¿‡ 30 å¤©çš„ binlog åˆ é™¤</span></span><br><span class="line"><span class="attr">expire_logs_days</span> = <span class="string">30 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ binlog ä¸ºäº†è®°å½• SQL çŠ¶æ€æ‰€æŒæœ‰çš„ cache å¤§å°,å¦‚æœä½ ç»å¸¸ä½¿ç”¨å¤§çš„,å¤šå£°æ˜çš„äº‹åŠ¡,ä½ å¯ä»¥å¢åŠ æ­¤å€¼æ¥è·å–æ›´å¤§çš„æ€§èƒ½.æ‰€æœ‰ä»äº‹åŠ¡æ¥çš„çŠ¶æ€éƒ½å°†è¢«ç¼“å†²åœ¨ binlog ç¼“å†²ä¸­ç„¶ååœ¨æäº¤åä¸€æ¬¡æ€§å†™å…¥åˆ° binlog ä¸­,å¦‚æœäº‹åŠ¡æ¯”æ­¤å€¼å¤§, ä¼šä½¿ç”¨ç£ç›˜ä¸Šçš„ä¸´æ—¶æ–‡ä»¶æ¥æ›¿ä»£.æ­¤ç¼“å†²åœ¨æ¯ä¸ªè¿æ¥çš„äº‹åŠ¡ç¬¬ä¸€æ¬¡æ›´æ–°çŠ¶æ€æ—¶è¢«åˆ›å»º.session çº§åˆ«</span></span><br><span class="line"><span class="attr">binlog_cache_size</span> = <span class="string">1M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¤åˆ¶æ—¶å¿½ç•¥æ•°æ®åº“åŠè¡¨</span></span><br><span class="line"><span class="attr">replicate-wild-ignore-table</span> = <span class="string">mysql.% </span></span><br><span class="line"><span class="comment"># å®šä¹‰å¤åˆ¶è¿‡ç¨‹ä¸­ä»æœåŠ¡å™¨å¯ä»¥è‡ªåŠ¨è·³è¿‡çš„é”™è¯¯å·ï¼Œå½“å¤åˆ¶è¿‡ç¨‹ä¸­é‡åˆ°å®šä¹‰çš„é”™è¯¯å·ï¼Œå°±å¯ä»¥è‡ªåŠ¨è·³è¿‡ï¼Œç›´æ¥æ‰§è¡Œåé¢çš„SQLè¯­å¥ã€‚</span></span><br><span class="line"><span class="comment"># slave_skip_errorsé€‰é¡¹æœ‰å››ä¸ªå¯ç”¨å€¼ï¼Œåˆ†åˆ«ä¸ºï¼šoffï¼Œallï¼ŒErorCodeï¼Œddl_exist_errorsã€‚</span></span><br><span class="line"><span class="comment">#  é»˜è®¤æƒ…å†µä¸‹è¯¥å‚æ•°å€¼æ˜¯offï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å‡ºå…·ä½“çš„error codeï¼Œä¹Ÿå¯ä»¥é€‰æ‹©allï¼Œmysql5.6åŠMySQL Cluster NDB 7.3ä»¥åŠåç»­ç‰ˆæœ¬å¢åŠ äº†å‚æ•°ddl_exist_errorsï¼Œè¯¥å‚æ•°åŒ…å«ä¸€ç³»åˆ—error codeï¼ˆ1007,1008,1050,1051,1054,1060,1061,1068,1094,1146ï¼‰</span></span><br><span class="line"><span class="comment">#    ä¸€äº›error codeä»£è¡¨çš„é”™è¯¯å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">#    1007ï¼šæ•°æ®åº“å·²å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®åº“å¤±è´¥</span></span><br><span class="line"><span class="comment">#    1008ï¼šæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ é™¤æ•°æ®åº“å¤±è´¥</span></span><br><span class="line"><span class="comment">#    1050ï¼šæ•°æ®è¡¨å·²å­˜åœ¨ï¼Œåˆ›å»ºæ•°æ®è¡¨å¤±è´¥</span></span><br><span class="line"><span class="comment">#    1051ï¼šæ•°æ®è¡¨ä¸å­˜åœ¨ï¼Œåˆ é™¤æ•°æ®è¡¨å¤±è´¥</span></span><br><span class="line"><span class="comment">#    1054ï¼šå­—æ®µä¸å­˜åœ¨ï¼Œæˆ–ç¨‹åºæ–‡ä»¶è·Ÿæ•°æ®åº“æœ‰å†²çª</span></span><br><span class="line"><span class="comment">#    1060ï¼šå­—æ®µé‡å¤ï¼Œå¯¼è‡´æ— æ³•æ’å…¥</span></span><br><span class="line"><span class="comment">#    1061ï¼šé‡å¤é”®å</span></span><br><span class="line"><span class="comment">#    1068ï¼šå®šä¹‰äº†å¤šä¸ªä¸»é”®</span></span><br><span class="line"><span class="comment">#    1094ï¼šä½ç½®çº¿ç¨‹ID</span></span><br><span class="line"><span class="comment">#    1146ï¼šæ•°æ®è¡¨ç¼ºå¤±ï¼Œè¯·æ¢å¤æ•°æ®åº“</span></span><br><span class="line"><span class="comment">#    1053ï¼šå¤åˆ¶è¿‡ç¨‹ä¸­ä¸»æœåŠ¡å™¨å®•æœº</span></span><br><span class="line"><span class="comment">#    1062ï¼šä¸»é”®å†²çª Duplicate entry &#x27;%s&#x27; for key %d</span></span><br><span class="line"><span class="attr">slave_skip_errors</span>=<span class="string">all </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ==========================================MyISAM ç›¸å…³é€‰é¡¹ ========================================</span></span><br><span class="line"><span class="comment">#æŒ‡å®šç”¨äºç´¢å¼•çš„ç¼“å†²åŒºå¤§å°ï¼Œå¢åŠ å®ƒå¯å¾—åˆ°æ›´å¥½çš„ç´¢å¼•å¤„ç†æ€§èƒ½ã€‚å¦‚æœæ˜¯ä»¥InnoDBå¼•æ“ä¸ºä¸»çš„DBï¼Œä¸“ç”¨äºMyISAMå¼•æ“çš„ key_buffer_size å¯ä»¥è®¾ç½®è¾ƒå°ï¼Œ8MB å·²è¶³å¤Ÿ  å¦‚æœæ˜¯ä»¥MyISAMå¼•æ“ä¸ºä¸»ï¼Œå¯è®¾ç½®è¾ƒå¤§ï¼Œä½†ä¸èƒ½è¶…è¿‡4G. åœ¨è¿™é‡Œï¼Œå¼ºçƒˆå»ºè®®ä¸ä½¿ç”¨MyISAMå¼•æ“ï¼Œé»˜è®¤éƒ½æ˜¯ç”¨InnoDBå¼•æ“.æ³¨æ„ï¼šè¯¥å‚æ•°å€¼è®¾ç½®çš„è¿‡å¤§åè€Œä¼šæ˜¯æœåŠ¡å™¨æ•´ä½“æ•ˆç‡é™ä½ï¼</span></span><br><span class="line"><span class="attr">key_buffer_size</span> = <span class="string">256M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŸ¥è¯¢æ’åºæ—¶æ‰€èƒ½ä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ã€‚æ’åºç¼“å†²è¢«ç”¨æ¥å¤„ç†ç±»ä¼¼ ORDER BY ä»¥åŠ GROUP BY é˜Ÿåˆ—æ‰€å¼•èµ·çš„æ’åº.ä¸€ä¸ªç”¨æ¥æ›¿ä»£çš„åŸºäºç£ç›˜çš„åˆå¹¶åˆ†ç±»ä¼šè¢«ä½¿ç”¨.æŸ¥çœ‹ â€œSort_merge_passesâ€ çŠ¶æ€å˜é‡. åœ¨æ’åºå‘ç”Ÿæ—¶ç”±æ¯ä¸ªçº¿ç¨‹åˆ†é… æ³¨æ„ï¼šè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜æ˜¯æ¯è¿æ¥ç‹¬å ï¼å¦‚æœæœ‰ 100 ä¸ªè¿æ¥ï¼Œé‚£ä¹ˆå®é™…åˆ†é…çš„æ€»å…±æ’åºç¼“å†²åŒºå¤§å°ä¸º 100 Ã— 6 ï¼600MB,æ‰€ä»¥,å¯¹äºå†…å­˜åœ¨ 4GB å·¦å³çš„æœåŠ¡å™¨æ¨èè®¾ç½®ä¸º 6-8Mã€‚ </span></span><br><span class="line"><span class="attr">sort_buffer_size</span> = <span class="string">2M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è¯»æŸ¥è¯¢æ“ä½œæ‰€èƒ½ä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ã€‚å’Œ sort_buffer_size ä¸€æ ·ï¼Œè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜ä¹Ÿæ˜¯æ¯è¿æ¥ç‹¬äº«ï¼ç”¨æ¥åš MyISAM è¡¨å…¨è¡¨æ‰«æçš„ç¼“å†²å¤§å°.å½“å…¨è¡¨æ‰«æéœ€è¦æ—¶,åœ¨å¯¹åº”çº¿ç¨‹ä¸­åˆ†é….</span></span><br><span class="line"><span class="attr">read_buffer_size</span> = <span class="string">2M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è”åˆæŸ¥è¯¢æ“ä½œæ‰€èƒ½ä½¿ç”¨çš„ç¼“å†²åŒºå¤§å°ï¼Œå’Œ sort_buffer_size ä¸€æ ·ï¼Œè¯¥å‚æ•°å¯¹åº”çš„åˆ†é…å†…å­˜ä¹Ÿæ˜¯æ¯è¿æ¥ç‹¬äº«!æ­¤ç¼“å†²è¢«ä½¿ç”¨æ¥ä¼˜åŒ–å…¨è”åˆ(full JOINs ä¸å¸¦ç´¢å¼•çš„è”åˆ).ç±»ä¼¼çš„è”åˆåœ¨æå¤§å¤šæ•°æƒ…å†µä¸‹æœ‰éå¸¸ç³Ÿç³•çš„æ€§èƒ½è¡¨ç°, ä½†æ˜¯å°†æ­¤å€¼è®¾å¤§èƒ½å¤Ÿå‡è½»æ€§èƒ½å½±å“.é€šè¿‡ â€œSelect_full_joinâ€çŠ¶æ€å˜é‡æŸ¥çœ‹å…¨è”åˆçš„æ•°é‡ï¼Œ å½“å…¨è”åˆå‘ç”Ÿæ—¶,åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­åˆ†é…ã€‚</span></span><br><span class="line"><span class="attr">join_buffer_size</span> = <span class="string">8M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># MyISAM ä»¥ç´¢å¼•æ‰«æ(Random Scan)æ–¹å¼æ‰«ææ•°æ®çš„ bufferå¤§å° </span></span><br><span class="line"><span class="attr">read_rnd_buffer_size</span> = <span class="string">8M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># MyISAM ä½¿ç”¨ç‰¹æ®Šçš„ç±»ä¼¼æ ‘çš„ cache æ¥ä½¿å¾—çªå‘æ’å…¥(è¿™äº›æ’å…¥æ˜¯,INSERT â€¦ SELECT, INSERT â€¦ VALUES (â€¦), (â€¦), â€¦, ä»¥åŠ LOAD DATAINFILE) æ›´å¿«. æ­¤å˜é‡é™åˆ¶æ¯ä¸ªè¿›ç¨‹ä¸­ç¼“å†²æ ‘çš„å­—èŠ‚æ•°.è®¾ç½®ä¸º 0 ä¼šå…³é—­æ­¤ä¼˜åŒ–.ä¸ºäº†æœ€ä¼˜åŒ–ä¸è¦å°†æ­¤å€¼è®¾ç½®å¤§äº â€œkey_buffer_sizeâ€.å½“çªå‘æ’å…¥è¢«æ£€æµ‹åˆ°æ—¶æ­¤ç¼“å†²å°†è¢«åˆ†é…MyISAM ç”¨åœ¨å—æ’å…¥ä¼˜åŒ–ä¸­çš„æ ‘ç¼“å†²åŒºçš„å¤§å°ã€‚æ³¨é‡Šï¼šè¿™æ˜¯ä¸€ä¸ª per thread çš„é™åˆ¶ ï¼ˆ bulk å¤§é‡ï¼‰.æ­¤ç¼“å†²å½“ MySQL éœ€è¦åœ¨ REPAIR, OPTIMIZE, ALTER ä»¥åŠ LOAD DATA INFILEåˆ°ä¸€ä¸ªç©ºè¡¨ä¸­å¼•èµ·é‡å»ºç´¢å¼•æ—¶è¢«åˆ†é….è¿™åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­è¢«åˆ†é….æ‰€ä»¥åœ¨è®¾ç½®å¤§å€¼æ—¶éœ€è¦å°å¿ƒ.</span></span><br><span class="line"><span class="attr">bulk_insert_buffer_size</span> = <span class="string">64M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># MyISAM è®¾ç½®æ¢å¤è¡¨ä¹‹æ—¶ä½¿ç”¨çš„ç¼“å†²åŒºçš„å°ºå¯¸,å½“åœ¨REPAIR TABLE æˆ–ç”¨ CREATE INDEX åˆ›å»ºç´¢å¼•æˆ– ALTER TABLE è¿‡ç¨‹ä¸­æ’åº MyISAM ç´¢å¼•åˆ†é…çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="attr">myisam_sort_buffer_size</span> = <span class="string">64M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># mysqlé‡å»ºç´¢å¼•æ—¶å…è®¸ä½¿ç”¨çš„ä¸´æ—¶æ–‡ä»¶æœ€å¤§å¤§å°</span></span><br><span class="line"><span class="attr">myisam_max_sort_file_size</span> = <span class="string">10G</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœè¯¥å€¼å¤§äº 1ï¼Œåœ¨ Repair by sorting è¿‡ç¨‹ä¸­å¹¶è¡Œåˆ›å»ºMyISAM è¡¨ç´¢å¼•(æ¯ä¸ªç´¢å¼•åœ¨è‡ªå·±çš„çº¿ç¨‹å†…).å¦‚æœä¸€ä¸ªè¡¨æ‹¥æœ‰è¶…è¿‡ä¸€ä¸ªç´¢å¼•, MyISAM å¯ä»¥é€šè¿‡å¹¶è¡Œæ’åºä½¿ç”¨è¶…è¿‡ä¸€ä¸ªçº¿ç¨‹å»ä¿®å¤ä»–ä»¬.è¿™å¯¹äºæ‹¥æœ‰å¤šä¸ª CPU ä»¥åŠå¤§é‡å†…å­˜æƒ…å†µçš„ç”¨æˆ·,æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©.</span></span><br><span class="line"><span class="attr">myisam_repair_threads</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å…è®¸çš„ GROUP_CONCAT()å‡½æ•°ç»“æœçš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="attr">myisam_recover</span> = <span class="string">64K</span></span><br><span class="line"><span class="comment"># è®¾å®šé»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«.å¯ç”¨çš„çº§åˆ«å¦‚ä¸‹:READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ,SERIALIZABLE</span></span><br><span class="line"><span class="comment"># 1.READ UNCOMMITTED-è¯»æœªæäº¤ 2.READ COMMITTE-è¯»å·²æäº¤ 3.REPEATABLE READ -å¯é‡å¤è¯» 4.SERIALIZABLE -ä¸²è¡Œ</span></span><br><span class="line"><span class="attr">transaction_isolation</span> = <span class="string">REPEATABLE-READ </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ======================================== INNODB ç›¸å…³é€‰é¡¹ =========================================</span></span><br><span class="line"><span class="comment"># å¦‚æœä½ çš„ MySQL æœåŠ¡åŒ…å« InnoDB æ”¯æŒä½†æ˜¯å¹¶ä¸æ‰“ç®—ä½¿ç”¨çš„è¯,ä½¿ç”¨æ­¤é€‰é¡¹ä¼šèŠ‚çœå†…å­˜ä»¥åŠç£ç›˜ç©ºé—´,å¹¶ä¸”åŠ é€ŸæŸäº›éƒ¨åˆ†</span></span><br><span class="line"><span class="attr">skip-innodb</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># InnoDBä¸ºç‹¬ç«‹è¡¨ç©ºé—´æ¨¡å¼ï¼Œæ¯ä¸ªæ•°æ®åº“çš„æ¯ä¸ªè¡¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®ç©ºé—´</span></span><br><span class="line"><span class="comment">#  ç‹¬ç«‹è¡¨ç©ºé—´ä¼˜ç‚¹ï¼š</span></span><br><span class="line"><span class="comment">#   1ï¼æ¯ä¸ªè¡¨éƒ½æœ‰è‡ªå·²ç‹¬ç«‹çš„è¡¨ç©ºé—´ã€‚</span></span><br><span class="line"><span class="comment">#   2ï¼æ¯ä¸ªè¡¨çš„æ•°æ®å’Œç´¢å¼•éƒ½ä¼šå­˜åœ¨è‡ªå·²çš„è¡¨ç©ºé—´ä¸­ã€‚</span></span><br><span class="line"><span class="comment">#   3ï¼å¯ä»¥å®ç°å•è¡¨åœ¨ä¸åŒçš„æ•°æ®åº“ä¸­ç§»åŠ¨ã€‚</span></span><br><span class="line"><span class="comment">#   4ï¼ç©ºé—´å¯ä»¥å›æ”¶ï¼ˆé™¤drop tableæ“ä½œå¤„ï¼Œè¡¨ç©ºä¸èƒ½è‡ªå·²å›æ”¶ï¼‰</span></span><br><span class="line"><span class="comment">#  ç¼ºç‚¹ï¼š</span></span><br><span class="line"><span class="comment">#   1.å•è¡¨å¢åŠ è¿‡å¤§ï¼Œå¦‚è¶…è¿‡100G</span></span><br><span class="line"><span class="comment">#  ç»“è®ºï¼š</span></span><br><span class="line"><span class="comment">#   å…±äº«è¡¨ç©ºé—´åœ¨Insertæ“ä½œä¸Šå°‘æœ‰ä¼˜åŠ¿ã€‚å…¶å®ƒéƒ½æ²¡ç‹¬ç«‹è¡¨ç©ºé—´è¡¨ç°å¥½ã€‚å½“å¯ç”¨ç‹¬ç«‹è¡¨ç©ºé—´æ—¶ï¼Œè¯·åˆç†è°ƒæ•´ï¼šinnodb_open_files</span></span><br><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¯ç”¨InnoDBçš„status fileï¼Œä¾¿äºç®¡ç†å‘˜æŸ¥çœ‹ä»¥åŠç›‘æ§ç­‰</span></span><br><span class="line"><span class="attr">innodb_status_file</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># é™åˆ¶Innodbèƒ½æ‰“å¼€çš„è¡¨çš„æ•°æ®ï¼Œå¦‚æœåº“é‡Œçš„è¡¨ç‰¹åˆ«å¤šçš„æƒ…å†µï¼Œè¯·å¢åŠ è¿™ä¸ªã€‚è¿™ä¸ªå€¼é»˜è®¤æ˜¯300</span></span><br><span class="line"><span class="attr">innodb_open_files</span> = <span class="string">2048 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®¾ç½®InnoDBå­˜å‚¨å¼•æ“ç”¨æ¥å­˜æ”¾æ•°æ®å­—å…¸ä¿¡æ¯ä»¥åŠä¸€äº›å†…éƒ¨æ•°æ®ç»“æ„çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä¸€ä¸ªMySQL Instanceä¸­çš„æ•°æ®åº“å¯¹è±¡éå¸¸å¤šçš„æ—¶å€™ï¼Œæ˜¯éœ€è¦é€‚å½“è°ƒæ•´è¯¥å‚æ•°çš„å¤§å°ä»¥ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½èƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­æé«˜è®¿é—®æ•ˆç‡çš„ã€‚ </span></span><br><span class="line"><span class="attr">innodb_additional_mem_pool_size</span> = <span class="string">100M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åŒ…æ‹¬æ•°æ®é¡µã€ç´¢å¼•é¡µã€æ’å…¥ç¼“å­˜ã€é”ä¿¡æ¯ã€è‡ªé€‚åº”å“ˆå¸Œæ‰€ä»¥ã€æ•°æ®å­—å…¸ä¿¡æ¯.InnoDB ä½¿ç”¨ä¸€ä¸ªç¼“å†²æ± æ¥ä¿å­˜ç´¢å¼•å’ŒåŸå§‹æ•°æ®, ä¸åƒ MyISAM.è¿™é‡Œä½ è®¾ç½®è¶Šå¤§,ä½ åœ¨å­˜å–è¡¨é‡Œé¢æ•°æ®æ—¶æ‰€éœ€è¦çš„ç£ç›˜ I/O è¶Šå°‘.åœ¨ä¸€ä¸ªç‹¬ç«‹ä½¿ç”¨çš„æ•°æ®åº“æœåŠ¡å™¨ä¸Š,ä½ å¯ä»¥è®¾ç½®è¿™ä¸ªå˜é‡åˆ°æœåŠ¡å™¨ç‰©ç†å†…å­˜å¤§å°çš„ 80%,ä¸è¦è®¾ç½®è¿‡å¤§,å¦åˆ™,ç”±äºç‰©ç†å†…å­˜çš„ç«äº‰å¯èƒ½å¯¼è‡´æ“ä½œç³»ç»Ÿçš„æ¢é¡µé¢ ç°¸.æ³¨æ„åœ¨ 32 ä½ç³»ç»Ÿä¸Šä½ æ¯ä¸ªè¿›ç¨‹å¯èƒ½è¢«é™åˆ¶åœ¨ 2-3.5G ç”¨æˆ·å±‚é¢å†…å­˜é™åˆ¶,æ‰€ä»¥ä¸è¦è®¾ç½®çš„å¤ªé«˜.</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = <span class="string">2G </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># innodbä½¿ç”¨åå°çº¿ç¨‹å¤„ç†æ•°æ®é¡µä¸Šçš„è¯»å†™ I/O(è¾“å…¥è¾“å‡º)è¯·æ±‚,æ ¹æ®ä½ çš„ CPU æ ¸æ•°æ¥æ›´æ”¹,é»˜è®¤æ˜¯4</span></span><br><span class="line"><span class="comment"># æ³¨:è¿™ä¸¤ä¸ªå‚æ•°ä¸æ”¯æŒåŠ¨æ€æ”¹å˜,éœ€è¦æŠŠè¯¥å‚æ•°åŠ å…¥åˆ°my.cnfé‡Œï¼Œä¿®æ”¹å®Œåé‡å¯MySQLæœåŠ¡,å…è®¸å€¼çš„èŒƒå›´ä» 1-64</span></span><br><span class="line"><span class="attr">innodb_write_io_threads</span> = <span class="string">4</span></span><br><span class="line"><span class="attr">innodb_read_io_threads</span> = <span class="string">4</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># è®¾ç½®æ­¤é€‰é¡¹å¦‚æœä½ å¸Œæœ› InnoDB è¡¨ç©ºé—´æ–‡ä»¶è¢«ä¿å­˜åœ¨å…¶ä»–åˆ†åŒº.é»˜è®¤ä¿å­˜åœ¨ MySQL çš„ datadir ä¸­.</span></span><br><span class="line"><span class="attr">innodb_data_home_dir</span> =  <span class="string">/usr/local/mysql/var/ </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># InnoDBå°†æ•°æ®ä¿å­˜åœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°æ®æ–‡ä»¶ä¸­æˆä¸ºè¡¨ç©ºé—´.å¦‚æœä½ åªæœ‰å•ä¸ªé€»è¾‘é©±åŠ¨ä¿å­˜ä½ çš„æ•°æ®,ä¸€ä¸ªå•ä¸ªçš„è‡ªå¢æ–‡ä»¶å°±è¶³å¤Ÿå¥½äº†.å…¶ä»–æƒ…å†µä¸‹.æ¯ä¸ªè®¾å¤‡ä¸€ä¸ªæ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯ä¸ªå¥½çš„é€‰æ‹©.ä½ ä¹Ÿå¯ä»¥é…ç½® InnoDB æ¥ä½¿ç”¨è£¸ç›˜åˆ†åŒº â€“ è¯·å‚è€ƒæ‰‹å†Œæ¥è·å–æ›´å¤šç›¸å…³å†…å®¹</span></span><br><span class="line"><span class="attr">innodb_data_file_path</span> = <span class="string">ibdata1:500M;ibdata2:2210M:autoextend</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ç”¨æ¥åŒæ­¥ IO æ“ä½œçš„ IO çº¿ç¨‹çš„æ•°é‡. æ­¤å€¼åœ¨ Unix ä¸‹è¢«ç¡¬ç¼–ç ä¸º 4,ä½†æ˜¯åœ¨ Windows ç£ç›˜ I/O å¯èƒ½åœ¨ä¸€ä¸ªå¤§æ•°å€¼ä¸‹è¡¨ç°çš„æ›´å¥½.</span></span><br><span class="line"><span class="attr">innodb_file_io_threads</span> = <span class="string">4 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åœ¨InnoDb æ ¸å¿ƒå†…çš„å…è®¸çº¿ç¨‹æ•°é‡,InnoDB è¯•ç€åœ¨ InnoDB å†…ä¿æŒæ“ä½œç³»ç»Ÿçº¿ç¨‹çš„æ•°é‡å°‘äºæˆ–ç­‰äºè¿™ä¸ªå‚æ•°ç»™å‡ºçš„é™åˆ¶,æœ€ä¼˜å€¼ä¾èµ–äºåº”ç”¨ç¨‹åº,ç¡¬ä»¶ä»¥åŠæ“ä½œç³»ç»Ÿçš„è°ƒåº¦æ–¹å¼.è¿‡é«˜çš„å€¼å¯èƒ½å¯¼è‡´çº¿ç¨‹çš„äº’æ–¥é¢ ç°¸.é»˜è®¤è®¾ç½®ä¸º 0,è¡¨ç¤ºä¸é™åˆ¶å¹¶å‘æ•°ï¼Œè¿™é‡Œæ¨èè®¾ç½®ä¸º0ï¼Œæ›´å¥½å»å‘æŒ¥CPUå¤šæ ¸å¤„ç†èƒ½åŠ›ï¼Œæé«˜å¹¶å‘é‡</span></span><br><span class="line"><span class="attr">innodb_thread_concurrency</span> = <span class="string">16</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœè®¾ç½®ä¸º 1 ,InnoDB ä¼šåœ¨æ¯æ¬¡æäº¤ååˆ·æ–°(fsync)äº‹åŠ¡æ—¥å¿—åˆ°ç£ç›˜ä¸Š,è¿™æä¾›äº†å®Œæ•´çš„ ACID è¡Œä¸º.å¦‚æœä½ æ„¿æ„å¯¹äº‹åŠ¡å®‰å…¨æŠ˜è¡·, å¹¶ä¸”ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ªå°çš„é£Ÿç‰©, ä½ å¯ä»¥è®¾ç½®æ­¤å€¼åˆ° 0 æˆ–è€… 2 æ¥å‡å°‘ç”±äº‹åŠ¡æ—¥å¿—å¼•èµ·çš„ç£ç›˜ I/O</span></span><br><span class="line"><span class="comment">#   0 ä»£è¡¨æ—¥å¿—åªå¤§çº¦æ¯ç§’å†™å…¥æ—¥å¿—æ–‡ä»¶å¹¶ä¸”æ—¥å¿—æ–‡ä»¶åˆ·æ–°åˆ°ç£ç›˜.</span></span><br><span class="line"><span class="comment">#   2 ä»£è¡¨æ—¥å¿—å†™å…¥æ—¥å¿—æ–‡ä»¶åœ¨æ¯æ¬¡æäº¤å,ä½†æ˜¯æ—¥å¿—æ–‡ä»¶åªæœ‰å¤§çº¦æ¯ç§’æ‰ä¼šåˆ·æ–°åˆ°ç£ç›˜ä¸Š.</span></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span> = <span class="string">1 </span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"># ç”¨æ¥ç¼“å†²æ—¥å¿—æ•°æ®çš„ç¼“å†²åŒºçš„å¤§å°.å½“æ­¤å€¼å¿«æ»¡æ—¶, InnoDB å°†å¿…é¡»åˆ·æ–°æ•°æ®åˆ°ç£ç›˜ä¸Š.ç”±äºåŸºæœ¬ä¸Šæ¯ç§’éƒ½ä¼šåˆ·æ–°ä¸€æ¬¡,æ‰€ä»¥æ²¡æœ‰å¿…è¦å°†æ­¤å€¼è®¾ç½®çš„å¤ªå¤§(ç”šè‡³å¯¹äºé•¿äº‹åŠ¡è€Œè¨€)</span></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span> = <span class="string">8M</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># äº‹ç‰©æ—¥å¿—å¤§å°.åœ¨æ—¥å¿—ç»„ä¸­æ¯ä¸ªæ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼Œä½ åº”è¯¥è®¾ç½®æ—¥å¿—æ–‡ä»¶æ€»åˆå¤§å°åˆ°ä½ ç¼“å†²æ± å¤§å°çš„5%~100%ï¼Œæ¥é¿å…åœ¨æ—¥å¿—æ–‡ä»¶è¦†å†™ä¸Šä¸å¿…è¦çš„ç¼“å†²æ± åˆ·æ–°è¡Œä¸º.ä¸è®ºå¦‚ä½•, è¯·æ³¨æ„ä¸€ä¸ªå¤§çš„æ—¥å¿—æ–‡ä»¶å¤§å°ä¼šå¢åŠ æ¢å¤è¿›ç¨‹æ‰€éœ€è¦çš„æ—¶é—´.</span></span><br><span class="line"><span class="attr">innodb_log_file_size</span> = <span class="string">500M </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åœ¨æ—¥å¿—ç»„ä¸­çš„æ–‡ä»¶æ€»æ•°.é€šå¸¸æ¥è¯´ 2~3 æ˜¯æ¯”è¾ƒå¥½çš„.</span></span><br><span class="line"><span class="attr">innodb_log_files_in_group</span> = <span class="string">2 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># InnoDB çš„æ—¥å¿—æ–‡ä»¶æ‰€åœ¨ä½ç½®. é»˜è®¤æ˜¯ MySQL çš„ datadir.ä½ å¯ä»¥å°†å…¶æŒ‡å®šåˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç¡¬ç›˜ä¸Šæˆ–è€…ä¸€ä¸ª RAID1 å·ä¸Šæ¥æé«˜å…¶æ€§èƒ½innodb_max_dirty_pages_pct = 90 #innodb ä¸»çº¿ç¨‹åˆ·æ–°ç¼“å­˜æ± ä¸­çš„æ•°æ®ï¼Œä½¿è„æ•°æ®æ¯”ä¾‹å°äº 90%,è¿™æ˜¯ä¸€ä¸ªè½¯é™åˆ¶,ä¸è¢«ä¿è¯ç»å¯¹æ‰§è¡Œ.</span></span><br><span class="line"><span class="attr">innodb_log_group_home_dir</span> =  <span class="string">/usr/local/mysql/var/</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># InnoDB äº‹åŠ¡åœ¨è¢«å›æ»šä¹‹å‰å¯ä»¥ç­‰å¾…ä¸€ä¸ªé”å®šçš„è¶…æ—¶ç§’æ•°ã€‚InnoDB åœ¨å®ƒè‡ªå·±çš„ é”å®šè¡¨ä¸­è‡ªåŠ¨æ£€æµ‹äº‹åŠ¡æ­»é”å¹¶ä¸”å›æ»šäº‹åŠ¡ã€‚ InnoDB ç”¨ LOCK TABLES è¯­å¥æ³¨æ„åˆ°é”å®šè®¾ç½®ã€‚é»˜è®¤å€¼æ˜¯ 50 ç§’</span></span><br><span class="line"><span class="attr">innodb_lock_wait_timeout</span> = <span class="string">50 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># InnoDB ç”¨æ¥åˆ·æ–°æ—¥å¿—çš„æ–¹æ³•.è¡¨ç©ºé—´æ€»æ˜¯ä½¿ç”¨åŒé‡å†™å…¥åˆ·æ–°æ–¹æ³•.é»˜è®¤å€¼æ˜¯ â€œfdatasyncâ€, å¦ä¸€ä¸ªæ˜¯ â€œO_DSYNCâ€.</span></span><br><span class="line"><span class="attr">innodb_flush_method</span> = <span class="string">O_DSYNC </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¦‚æœä½ å‘ç° InnoDB è¡¨ç©ºé—´æŸå, è®¾ç½®æ­¤å€¼ä¸ºä¸€ä¸ªéé›¶å€¼å¯èƒ½å¸®åŠ©ä½ å¯¼å‡ºä½ çš„è¡¨.ä»1 å¼€å§‹å¹¶ä¸”å¢åŠ æ­¤å€¼çŸ¥é“ä½ èƒ½å¤ŸæˆåŠŸçš„å¯¼å‡ºè¡¨.</span></span><br><span class="line"><span class="attr">innodb_force_recovery</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åŠ é€Ÿ InnoDB çš„å…³é—­. è¿™ä¼šé˜»æ­¢ InnoDB åœ¨å…³é—­æ—¶åšå…¨æ¸…é™¤ä»¥åŠæ’å…¥ç¼“å†²åˆå¹¶.è¿™å¯èƒ½æå¤§å¢åŠ å…³æœºæ—¶é—´, ä½†æ˜¯å–è€Œä»£ä¹‹çš„æ˜¯ InnoDB å¯èƒ½åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶åšè¿™äº›æ“ä½œ.</span></span><br><span class="line"><span class="attr">innodb_fast_shutdown</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># ===================================== å…¶ä»– ç›¸å…³é€‰é¡¹ ===========================================</span></span><br><span class="line"><span class="attr">[mysqldump]</span></span><br><span class="line"><span class="comment"># æ”¯æŒè¾ƒå¤§æ•°æ®åº“çš„è½¬å‚¨ï¼Œåœ¨å¯¼å‡ºéå¸¸å·¨å¤§çš„è¡¨æ—¶éœ€è¦æ­¤é¡¹ã€‚å¢åŠ è¯¥å˜é‡çš„å€¼ååˆ†å®‰å…¨ï¼Œè¿™æ˜¯å› ä¸ºä»…å½“éœ€è¦æ—¶æ‰ä¼šåˆ†é…é¢å¤–å†…å­˜ã€‚ä¾‹å¦‚ï¼Œä»…å½“ä½ å‘å‡ºé•¿æŸ¥è¯¢æˆ–mysqldå¿…é¡»è¿”å›å¤§çš„ç»“æœè¡Œæ—¶mysqldæ‰ä¼šåˆ†é…æ›´å¤šå†…å­˜ã€‚è¯¥å˜é‡ä¹‹æ‰€ä»¥å–è¾ƒå°é»˜è®¤å€¼æ˜¯ä¸€ç§é¢„é˜²æªæ–½ï¼Œä»¥æ•è·å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é”™è¯¯ä¿¡æ¯åŒ…ï¼Œå¹¶ç¡®ä¿ä¸ä¼šå› å¶ç„¶ä½¿ç”¨å¤§çš„ä¿¡æ¯åŒ…è€Œå¯¼è‡´å†…å­˜æº¢å‡ºã€‚ å¦‚æœä½ æ­£æ˜¯ç”¨å¤§çš„BLOBå€¼ï¼Œè€Œä¸”æœªä¸ºmysqldæˆäºˆä¸ºå¤„ç†æŸ¥è¯¢è€Œè®¿é—®è¶³å¤Ÿå†…å­˜çš„æƒé™ï¼Œä¹Ÿä¼šé‡åˆ°ä¸å¤§ä¿¡æ¯åŒ…æœ‰å…³çš„å¥‡æ€ªé—®é¢˜ã€‚å¦‚æœæ€€ç–‘å‡ºç°äº†è¯¥æƒ…å†µï¼Œè¯·å°è¯•åœ¨mysqld_safeè„šæœ¬å¼€å§‹å¢åŠ ulimit -d 256000ï¼Œå¹¶é‡å¯mysqldã€‚</span></span><br><span class="line"><span class="attr">quick</span> <span class="string"></span></span><br><span class="line"></span><br><span class="line"><span class="attr">[mysql]</span></span><br><span class="line"><span class="comment"># å…è®¸é€šè¿‡ TAB é”®æç¤º</span></span><br><span class="line"><span class="attr">auto-rehash</span> <span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æ•°æ®åº“å­—ç¬¦é›†</span></span><br><span class="line"><span class="attr">default-character-set</span> = <span class="string">utf8 </span></span><br><span class="line"></span><br><span class="line"><span class="attr">connect-timeout</span> = <span class="string">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">[mysqld_safe]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¢åŠ æ¯ä¸ªè¿›ç¨‹çš„å¯æ‰“å¼€æ–‡ä»¶æ•°é‡.ç¡®è®¤ä½ å·²ç»å°†å…¨ç³»ç»Ÿé™åˆ¶è®¾å®šçš„è¶³å¤Ÿé«˜!æ‰“å¼€å¤§é‡è¡¨éœ€è¦å°†æ­¤å€¼è®¾å¤§</span></span><br><span class="line"><span class="attr">open-files-limit</span> = <span class="string">8192 </span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>mysqlä¸€èˆ¬ç”Ÿäº§é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">[client]</span></span><br><span class="line"></span><br><span class="line"><span class="attr">socket</span>=<span class="string">/usr/local/mysql/mysql.sock</span></span><br><span class="line"></span><br><span class="line"><span class="attr">port</span>=<span class="string">3306</span></span><br><span class="line"></span><br><span class="line"><span class="attr">[mysqld]</span></span><br><span class="line"></span><br><span class="line"><span class="attr">basedir</span>=<span class="string">/usr/local/mysql/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">datadir</span>=<span class="string">/usr/local/mysql/data</span></span><br><span class="line"></span><br><span class="line"><span class="attr">socket</span>=<span class="string">/usr/local/mysql/mysql.sock</span></span><br><span class="line"></span><br><span class="line"><span class="attr">default-storage-engine</span>=<span class="string">INNODB</span></span><br><span class="line"></span><br><span class="line"><span class="attr">character_set_server</span>=<span class="string">utf8mb4</span></span><br><span class="line"></span><br><span class="line"><span class="attr">collation_server</span>=<span class="string">utf8mb4_general_ciÂ </span></span><br><span class="line"></span><br><span class="line"><span class="attr">port</span>=<span class="string">3306</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># Disabling symbolic-links is recommended to prevent assorted security risks</span></span><br><span class="line"></span><br><span class="line"><span class="attr">symbolic-links</span>=<span class="string">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=<span class="string">/usr/local/mysql/log/mysqld3306.log</span></span><br><span class="line"></span><br><span class="line"><span class="attr">pid-file</span>=<span class="string">/usr/local/mysql/mysqld3306.pid</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log_bin</span>=<span class="string">mysql3306-bin</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server_id</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">##äºŒè¿›åˆ¶æ—¥å¿—æ ¼å¼STATEMENTï¼ŒROWï¼ŒMIXED</span></span><br><span class="line"></span><br><span class="line"><span class="attr">binlog_format</span>=<span class="string">ROW</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## æœ€å¤§è¿æ¥æ•°,MySQLæœåŠ¡å™¨å…è®¸çš„æœ€å¤§è¿æ¥æ•°16384,è¿æ¥æ•°è¶Šå¤šæ¶ˆè€—å†…å­˜è¶Šå¤š</span></span><br><span class="line"></span><br><span class="line"><span class="attr">max_connections</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## Enable Per Table Data for InnoDB to shrink ibdata1(innoDBè¡¨ä¼˜åŒ–)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_file_per_table</span> = <span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## æ—¥å¿—è¿‡æœŸæ—¶é—´,åŒ…æ‹¬äºŒè¿›åˆ¶æ—¥å¿—(è¿‡æœŸè‡ªåŠ¨åˆ é™¤)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">expire_logs_days</span> = <span class="string">15</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#é»˜è®¤128M,ç”¨äºå­˜å‚¨é¡µé¢ç¼“å­˜æ•°æ®å¤–ï¼Œå¦å¤–æ­£å¸¸æƒ…å†µä¸‹è¿˜æœ‰å¤§çº¦8%çš„å¼€é”€ï¼Œä¸»è¦ç”¨åœ¨æ¯ä¸ªç¼“å­˜é¡µå¸§çš„æè¿°ã€adaptive hashç­‰æ•°æ®ç»“æ„,é€‚å½“çš„å¢åŠ è¿™ä¸ªå‚æ•°çš„å¤§å°ï¼Œå¯ä»¥æœ‰æ•ˆçš„å‡å°‘ InnoDB ç±»å‹çš„è¡¨çš„ç£ç›˜ I/O</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = <span class="string">2048M</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_log_file_size</span> = <span class="string">512M</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#é»˜è®¤æ˜¯8MB,InnoDBåœ¨å†™äº‹åŠ¡æ—¥å¿—çš„æ—¶å€™ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œä¹Ÿæ˜¯å…ˆå°†ä¿¡æ¯å†™å…¥Innofb Log Bufferä¸­ï¼Œå½“æ»¡è¶³innodb_flush_log_trx_commitå‚æ•°æ‰€è®¾ç½®çš„ç›¸åº”æ¡ä»¶(æˆ–è€…æ—¥å¿—ç¼“å†²åŒºå†™æ»¡)ä¹‹åï¼Œæ‰ä¼šå°†æ—¥å¿—å†™åˆ°æ–‡ä»¶ (æˆ–è€…åŒæ­¥åˆ°ç£ç›˜)ä¸­</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span> = <span class="string">8M</span></span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span> = <span class="string">2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#è¡¨å¤§å°å†™ä¸æ•æ„Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="attr">lower_case_table_names</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#ç½‘ç»œè¯»å†™è¶…æ—¶æ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="attr">net_read_timeout</span>=<span class="string">28800</span></span><br><span class="line"></span><br><span class="line"><span class="attr">net_write_timeout</span>=<span class="string">28800</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#è·³è¿‡å¯†ç Â  å®‰è£…å®Œåå±è”½è¯¥é€‰é¡¹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#skip-grant-tables</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<p>æ…¢æŸ¥è¯¢æŸ¥çœ‹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.slow_log</span><br></pre></td></tr></table></figure>



<h1 id="é—®é¢˜æ’æŸ¥"><a href="#é—®é¢˜æ’æŸ¥" class="headerlink" title="é—®é¢˜æ’æŸ¥"></a>é—®é¢˜æ’æŸ¥</h1><h2 id="mysql-å¯åŠ¨æŠ¥é”™Host-name-could-not-be-resolvedè§£å†³åŠæ³•"><a href="#mysql-å¯åŠ¨æŠ¥é”™Host-name-could-not-be-resolvedè§£å†³åŠæ³•" class="headerlink" title="mysql å¯åŠ¨æŠ¥é”™Host name could not be resolvedè§£å†³åŠæ³•"></a>mysql å¯åŠ¨æŠ¥é”™Host name could not be resolvedè§£å†³åŠæ³•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">ä¸‹é¢ä¸€è¡ŒåŠ å…¥skip-name-resolveé‡å¯mysqlæœåŠ¡å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure>





<h2 id="mysqlé…ç½®å®Œæˆåï¼Œå¯åŠ¨mysqlæœåŠ¡åï¼Œè¿æ¥mysqlæŠ¥é”™ï¼šERROR-2002-HY000-Canâ€™t-connect-to-local-MySQL-server-through-socket-â€˜-x2F-var-x2F-lib-x2F-mysql-x2F-mysql-sockâ€™-2"><a href="#mysqlé…ç½®å®Œæˆåï¼Œå¯åŠ¨mysqlæœåŠ¡åï¼Œè¿æ¥mysqlæŠ¥é”™ï¼šERROR-2002-HY000-Canâ€™t-connect-to-local-MySQL-server-through-socket-â€˜-x2F-var-x2F-lib-x2F-mysql-x2F-mysql-sockâ€™-2" class="headerlink" title="mysqlé…ç½®å®Œæˆåï¼Œå¯åŠ¨mysqlæœåŠ¡åï¼Œè¿æ¥mysqlæŠ¥é”™ï¼šERROR 2002 (HY000): Canâ€™t connect to local MySQL server through socket â€˜&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sockâ€™ (2)"></a>mysqlé…ç½®å®Œæˆåï¼Œå¯åŠ¨mysqlæœåŠ¡åï¼Œè¿æ¥mysqlæŠ¥é”™ï¼šERROR 2002 (HY000): Canâ€™t connect to local MySQL server through socket â€˜&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sockâ€™ (2)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">[mysql]</span><br><span class="line">[client]</span><br><span class="line">ä¸‹é¢çš„socketå±æ€§é…ç½®ä¸ä¸€è‡´</span><br></pre></td></tr></table></figure>



<h2 id="ç¼ºå¤±åŒ…"><a href="#ç¼ºå¤±åŒ…" class="headerlink" title="ç¼ºå¤±åŒ…"></a>ç¼ºå¤±åŒ…</h2><h3 id="å®‰è£…mysql-community-libs-compatæ—¶æŠ¥é”™å¦‚ä¸‹ï¼š"><a href="#å®‰è£…mysql-community-libs-compatæ—¶æŠ¥é”™å¦‚ä¸‹ï¼š" class="headerlink" title="å®‰è£…mysql-community-libs-compatæ—¶æŠ¥é”™å¦‚ä¸‹ï¼š"></a>å®‰è£…mysql-community-libs-compatæ—¶æŠ¥é”™å¦‚ä¸‹ï¼š</h3><blockquote>
<p>é”™è¯¯ï¼šä¾èµ–æ£€æµ‹å¤±è´¥ï¼š<br>    libcrypto.so.10()(64bit) è¢« mysql-community-libs-compat-5.7.40-1.el7.x86_64 éœ€è¦<br>    libcrypto.so.10(libcrypto.so.10)(64bit) è¢« mysql-community-libs-compat-5.7.40-1.el7.x86_64 éœ€è¦<br>    libssl.so.10()(64bit) è¢« mysql-community-libs-compat-5.7.40-1.el7.x86_64 éœ€è¦<br>    libssl.so.10(libssl.so.10)(64bit) è¢« mysql-community-libs-compat-5.7.40-1.el7.x86_64 éœ€è¦</p>
</blockquote>
<p>è¿‡ç¨‹ ï¼šgoogleæ—¶å‘ç°åº“</p>
<p><a target="_blank" rel="noopener" href="https://pkgs.org/download/libcrypto.so.10()(64bit)">https://pkgs.org/download/libcrypto.so.10()(64bit)</a></p>
<p>å‘ç°äº†compat-openssl10ä»¥åŠè§£é‡Šï¼Œå¤§æ„ä¸ºcompat-openssl10åªåŒ…å«librariesï¼Œæä¾›ä¸ä¸æ”¯æŒä½¿ç”¨OpenSSL-1.1ç¼–è¯‘çš„æ—©æœŸç‰ˆæœ¬å’Œè½¯ä»¶çš„å…¼å®¹æ€§ã€‚</p>
<blockquote>
<p>The OpenSSL toolkit provides support for secure communications between machines. This version of OpenSSL package contains only the libraries and is provided for compatibility with previous releases and software that does not support compilation with OpenSSL-1.1.</p>
</blockquote>
<p>ä»stackoverflowå¯ä»¥å‘ç°opensslæä¾›äº†libcrypto.so.10å´æ²¡æœ‰æ¨¡å—åï¼Œè®©ç³»ç»Ÿä»¥ä¸ºç¼ºå°‘ä¾èµ–</p>
<blockquote>
<p>In your case, openssl seems to provide only libcrypto.so.10 without any module name, making geramer-server believe that dependency is missing as it requires libcrypto.so.10 from module libcrypto.so.10.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/20518183/dependency-resolution-fails-on-installed-library">https://stackoverflow.com/questions/20518183/dependency-resolution-fails-on-installed-library</a></p>
<p>è§£å†³ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install compat-openssl10 -y</span><br></pre></td></tr></table></figure>

<h3 id="å®‰è£…mysql-community-clientæ—¶é”™æŠ¥"><a href="#å®‰è£…mysql-community-clientæ—¶é”™æŠ¥" class="headerlink" title="å®‰è£…mysql-community-clientæ—¶é”™æŠ¥"></a>å®‰è£…mysql-community-clientæ—¶é”™æŠ¥</h3><blockquote>
<p>è­¦å‘Šï¼šmysql-community-client-5.7.40-1.el7.x86_64.rpm: å¤´V4 RSA&#x2F;SHA256 Signature, å¯†é’¥ ID 3a79bd29: NOKEY<br>é”™è¯¯ï¼šä¾èµ–æ£€æµ‹å¤±è´¥ï¼š<br>    libncurses.so.5()(64bit) è¢« mysql-community-client-5.7.40-1.el7.x86_64 éœ€è¦<br>    libtinfo.so.5()(64bit) è¢« mysql-community-client-5.7.40-1.el7.x86_64 éœ€è¦</p>
</blockquote>
<p>è§£å†³ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install libncurses*</span><br></pre></td></tr></table></figure>



<h2 id="å®‰è£…mysql-community-serveræŠ¥é”™"><a href="#å®‰è£…mysql-community-serveræŠ¥é”™" class="headerlink" title="å®‰è£…mysql-community-serveræŠ¥é”™"></a>å®‰è£…mysql-community-serveræŠ¥é”™</h2><p>é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>[&#x2F;usr&#x2F;lib&#x2F;tmpfiles.d&#x2F;mysql.conf:23] Line references path below legacy directory &#x2F;var&#x2F;run&#x2F;, updating &#x2F;var&#x2F;run&#x2F;mysqld â†’ &#x2F;run&#x2F;mysqld; please update the tmpfiles.d&#x2F; drop-in file accordingly.</p>
</blockquote>
<p>æŒ‰ç…§é”™è¯¯æç¤ºï¼šç¼–è¾‘&#x2F;usr&#x2F;lib&#x2F;tmpfiles.d&#x2F;mysql.confæ–‡ä»¶ï¼Œå°† &#x2F;var&#x2F;run&#x2F;mysqldè·¯å¾„æ”¹ä¸º&#x2F;run&#x2F;mysqld</p>
<h2 id="ä¿®æ”¹æ•°æ®ç›®å½•åå¯åŠ¨æŠ¥é”™"><a href="#ä¿®æ”¹æ•°æ®ç›®å½•åå¯åŠ¨æŠ¥é”™" class="headerlink" title="ä¿®æ”¹æ•°æ®ç›®å½•åå¯åŠ¨æŠ¥é”™"></a>ä¿®æ”¹æ•°æ®ç›®å½•åå¯åŠ¨æŠ¥é”™</h2><blockquote>
<p>2æœˆ 28 00:22:29 localhost.localdomain setroubleshoot[46262]: SELinux is preventing &#x2F;usr&#x2F;sbin&#x2F;mysqld from write access on the dir&gt;<br>2æœˆ 28 00:22:29 localhost.localdomain setroubleshoot[46262]: SELinux is preventing &#x2F;usr&#x2F;sbin&#x2F;mysqld from write access on the dir&gt;<br>              *****  Plugin catchall_labels (83.8 confidence) suggests   *******</p>
<p>â€‹              If you want to allow mysqld to have write access on the data direc&gt;<br>â€‹              Then you need to change the label on &#x2F;mysql&#x2F;data<br>â€‹              Do<br>â€‹              #semanage fcontext -a -t FILE_TYPE â€˜&#x2F;mysql&#x2F;dataâ€™<br>â€‹              where FILE_TYPE is one of the following: faillog_t, krb5_host_rcac&gt;<br>â€‹              Then execute:<br>â€‹              restorecon -v â€˜&#x2F;mysql&#x2F;dataâ€™</p>
<p>â€‹             *****Plugin catchall (17.1 confidence) suggests   **************</p>
<p>â€‹              If you believe that mysqld should be allowed write access on the d<br>â€‹              Then you should report this as a bug.<br>â€‹              You can generate a local policy module to allow this access.<br>â€‹              Do</p>
<p>â€‹              allow this access for now by executing:</p>
<p>â€‹              #ausearch -c â€˜mysqldâ€™ â€“raw | audit2allow -M my-mysqld</p>
<p>â€‹              #semodule -X 300 -i my-mysqld.pp</p>
<p>2æœˆ 28 00:22:29 localhost.localdomain setroubleshoot[46262]: AnalyzeThread.run(): Set alarm timeout to 10<br>2æœˆ 28 00:22:29 localhost.localdomain setroubleshoot[46262]: AnalyzeThread.run(): Cancel pending alarm<br>2æœˆ 28 00:22:29 localhost.localdomain setroubleshoot[46262]: failed to retrieve rpm info for &#x2F;mysql&#x2F;data</p>
</blockquote>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<p>è¯¥é—®é¢˜æ˜¯ç”±äºSelinuxå®‰å…¨ç­–ç•¥é€ æˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§é”™è¯¯æç¤ºè¿›è¡Œä¿®æ”¹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œå‘½ä»¤å‰å…ˆæŠŠmysqlç”Ÿæˆçš„æ–‡ä»¶åˆ é™¤ä»¥é˜²æŠŠè‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ç­–ç•¥ä¿®æ”¹</span></span><br><span class="line">semanage fcontext -a -t mysqld_db_t /mysql/data</span><br><span class="line">restorecon -v /mysql/data</span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥ç”¨å…¶ä»–å‘½ä»¤<code>chcon -R -t mysqld_db_t -u system_u -r object_r æ–°çš„mysql-dataç›®å½•</code>ï¼ˆç›´æ¥ä¿®æ”¹æ–‡ä»¶å¤¹å®‰å…¨æƒé™ï¼‰æˆ–è€…<code>chcon -R --reference=/var/lib/mysql æ–°çš„mysql-dataç›®å½•</code>ï¼ˆå¤åˆ¶æºæ–‡ä»¶å¤¹çš„æƒé™ç»™æ–°æ–‡ä»¶å¤¹ï¼‰ï¼›ä¸è¿‡ç”±äºæœ¬äººæ²¡æœ‰æ·±å…¥äº†è§£è¿™äº›å‘½ä»¤é€ æˆä¿®æ”¹æˆåŠŸäº†ä¸€éƒ¨åˆ†ï¼Œæœªå®Œå…¨ä¿®æ”¹æˆåŠŸ</p>
<p>â€‹          </p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">æ±‚æ‰“èµ</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/AliPay.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/AliPay.png" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><span class="icon iconify" data-icon="ri:alipay-line"></span></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/WechatPay.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/WechatPay.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><span class="icon iconify" data-icon="ri:wechat-pay-line"></span></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Michael Chan</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://michaelchan90.github.io/2023/02/10/Centos7%E5%AE%89%E8%A3%85MySQL/" title="Centos7å®‰è£…MySQL">http://michaelchan90.github.io/2023/02/10/Centos7%E5%AE%89%E8%A3%85MySQL/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul><script>document.addEventListener('copy', function (event) {
  const clipboardData = event.clipboardData || window.clipboardData;
  if (!clipboardData) { return; }
  const text = window.getSelection().toString();
  if (text) {
    event.preventDefault();
    clipboardData.setData('text/plain', text + '\n\næœ¬æ–‡ä½œè€…ï¼šMichael Chan\næœ¬æ–‡é“¾æ¥ï¼šhttp://michaelchan90.github.io/2023/02/10/Centos7%E5%AE%89%E8%A3%85MySQL/\nç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ CC BY-NC-SA 4.0 è®¸å¯åè®®ã€‚');
  }
});</script></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2023/02/11/Centos7%E5%AE%89%E8%A3%85SFTP/" rel="prev" title="Centos7å®‰è£…SFTP"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">Centos7å®‰è£…SFTP</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/12/14/Mac%E5%8D%B8%E8%BD%BDJava/" rel="next" title="Macå¸è½½Java"><span class="post-nav-text">Macå¸è½½Java</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">äº¬ICPå¤‡xxxxxxxxå·</a></div><div class="copyright"><span>&copy; 2023 </span><span class="with-love" id="animate" title="æ˜Ÿæ— å°˜çš„èµåŠ©è€…"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Michael Chan</span></div><div class="live-time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2023-01-01T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} å¤© ${passHour} å°æ—¶ ${passMinute} åˆ† ${passSecond} ç§’`;
}
blog_live_time();
</script></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div class="search-result-container"></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18","12-13"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>