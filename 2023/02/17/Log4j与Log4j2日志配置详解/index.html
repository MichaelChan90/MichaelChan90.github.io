<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Michael Chan"><meta name="copyright" content="Michael Chan"><meta name="generator" content="Hexo 6.3.0"><meta name="theme" content="hexo-theme-yun"><title>Log4jä¸Log4j2æ—¥å¿—é…ç½®è¯¦è§£ | MichaelChan Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="mask-icon" href="/favicon.svg" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"michaelchan90.github.io","root":"/","title":"æ˜Ÿæ— å°˜çš„åšå®¢","version":"1.10.9","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=UA-164931119-1"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-164931119-1');
}</script><script data-ad-client="ca-pub-9775647830683925" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><meta name="description" content="[toc] Log4jé…ç½®log4j.propertiesé…ç½®æ ·ä¾‹ 123456789101112131415log4j.rootLogger &#x3D; INFO, FILE, CONSOLElog4j.appender.FILE&#x3D;org.apache.log4j.FileAppenderlog4j.appender.FILE.File&#x3D;D:&#x2F;logs&#x2F;log.outlog4j.appender.FIL">
<meta property="og:type" content="article">
<meta property="og:title" content="Log4jä¸Log4j2æ—¥å¿—é…ç½®è¯¦è§£">
<meta property="og:url" content="http://michaelchan90.github.io/2023/02/17/Log4j%E4%B8%8ELog4j2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="MichaelChan Blog">
<meta property="og:description" content="[toc] Log4jé…ç½®log4j.propertiesé…ç½®æ ·ä¾‹ 123456789101112131415log4j.rootLogger &#x3D; INFO, FILE, CONSOLElog4j.appender.FILE&#x3D;org.apache.log4j.FileAppenderlog4j.appender.FILE.File&#x3D;D:&#x2F;logs&#x2F;log.outlog4j.appender.FIL">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-02-17T11:05:44.000Z">
<meta property="article:modified_time" content="2023-03-10T06:11:14.407Z">
<meta property="article:author" content="Michael Chan">
<meta name="twitter:card" content="summary"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="Michael Chan"><img width="96" loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/go.jpg" alt="Michael Chan"><span class="site-author-status" title="åˆæ˜¯æ–°çš„ä¸€å¤©">ğŸ¤”</span></a><div class="site-author-name"><a href="/about/">Michael Chan</a></div><a class="site-name" href="/about/site.html">MichaelChan Blog</a><sub class="site-subtitle">æ˜Ÿæ— å°˜</sub><div class="site-description"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="ä¸»é¡µ"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£(archives)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">19</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»(categories)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾(tags)"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">3</span></a></div></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/michaelchan90" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:michaelchan90@outlook.com" title="E-Mail" target="_blank" style="color:#8E71C1"><span class="icon iconify" data-icon="ri:mail-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Log4j%E9%85%8D%E7%BD%AE"><span class="toc-number">1.</span> <span class="toc-text">Log4jé…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%A0%B9Logger"><span class="toc-number">1.1.</span> <span class="toc-text">é…ç½®æ ¹Logger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%E7%9B%AE%E7%9A%84%E5%9C%B0"><span class="toc-number">1.2.</span> <span class="toc-text">é…ç½®æ—¥å¿—è¾“å‡ºç›®çš„åœ°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DailyRollingFileAppender%E5%8D%95%E7%8B%AC%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">DailyRollingFileAppenderå•ç‹¬é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RollingFileAppender%E5%8D%95%E7%8B%AC%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">RollingFileAppenderå•ç‹¬é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%87%BA%E5%88%B0%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">è¾“å‡ºåˆ°æ§åˆ¶å°çš„é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.3.</span> <span class="toc-text">é€šç”¨é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PatternLayout%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%A0%B7%E5%BC%8F"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">PatternLayoutè‡ªå®šä¹‰é…ç½®æ ·å¼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%92%A9%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.3.</span> <span class="toc-text">é’©å­ç¨‹åº</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Log4j2%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">Log4j2é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4j2%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.</span> <span class="toc-text">Log4j2åŸºç¡€é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4j2%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">2.2.</span> <span class="toc-text">Log4j2åŠ è½½é…ç½®çš„é¡ºåº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Log4j2%E6%8F%90%E4%BE%9B%E4%BA%86%E6%A0%B9%E6%8D%AE%E8%87%AA%E5%AE%9A%E4%B9%89%E7%8E%AF%E5%A2%83%E6%9D%A5%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84Log4j2%E9%85%8D%E7%BD%AE%EF%BC%88Arbiter%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">Log4j2æä¾›äº†æ ¹æ®è‡ªå®šä¹‰ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒçš„Log4j2é…ç½®ï¼ˆArbiterï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%92%88%E5%AF%B9%E6%9F%90%E4%B8%AA%E7%B1%BB%E8%BF%9B%E8%A1%8C%E5%8D%95%E7%8B%AC%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%BE%E7%BD%AE"><span class="toc-number">2.4.</span> <span class="toc-text">ä½¿ç”¨é’ˆå¯¹æŸä¸ªç±»è¿›è¡Œå•ç‹¬çš„æ—¥å¿—è®¾ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configuration%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7"><span class="toc-number">2.5.</span> <span class="toc-text">Configurationé…ç½®å±æ€§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEFilter%EF%BC%88%E9%85%8D%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8%EF%BC%8C%E8%80%8C%E9%9D%9E%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97%E8%BF%87%E6%BB%A4%E5%99%A8%EF%BC%89"><span class="toc-number">2.6.</span> <span class="toc-text">é…ç½®Filterï¼ˆé…ç½®è¿‡æ»¤å™¨ï¼Œè€Œéæ‰“å°æ—¥å¿—è¿‡æ»¤å™¨ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE%E4%BA%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">2.7.</span> <span class="toc-text">è‡ªå®šä¹‰å±æ€§é…ç½®äºä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Scripts"><span class="toc-number">2.8.</span> <span class="toc-text">ä½¿ç”¨Scripts</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://michaelchan90.github.io/2023/02/17/Log4j%E4%B8%8ELog4j2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Michael Chan"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="MichaelChan Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Log4jä¸Log4j2æ—¥å¿—é…ç½®è¯¦è§£</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-17 19:05:44" itemprop="dateCreated datePublished" datetime="2023-02-17T19:05:44+08:00">2023-02-17</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-03-10 14:11:14" itemprop="dateModified" datetime="2023-03-10T14:11:14+08:00">2023-03-10</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><span class="icon iconify" data-icon="ri:file-word-line"></span></span> <span title="æœ¬æ–‡å­—æ•°">9.2k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><span class="icon iconify" data-icon="ri:timer-line"></span></span> <span title="é˜…è¯»æ—¶é•¿">43m</span></span></span><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><span class="icon iconify" data-icon="ri:eye-line"></span> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E8%BF%90%E7%BB%B4%E5%AE%89%E8%A3%85/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">è¿ç»´å®‰è£…</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E8%BF%90%E7%BB%B4%E5%AE%89%E8%A3%85/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">æ—¥å¿—ç³»ç»Ÿ</span></a></span></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>[toc]</p>
<h1 id="Log4jé…ç½®"><a href="#Log4jé…ç½®" class="headerlink" title="Log4jé…ç½®"></a>Log4jé…ç½®</h1><p><code>log4j.properties</code>é…ç½®æ ·ä¾‹</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.rootLogger</span> = <span class="string">INFO, FILE, CONSOLE</span></span><br><span class="line"><span class="attr">log4j.appender.FILE</span>=<span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.File</span>=<span class="string">D:/logs/log.out</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.ImmediateFlush</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.Threshold</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.Append</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.FILE.layout.conversionPattern</span>=<span class="string">%d&#123; ABSOLUTE&#125; %5p %c&#123; 1&#125;:%L - %m%n</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.Target</span>=<span class="string">System.out</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.ImmediateFlush</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.Threshold</span> = <span class="string">DEBUG</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.encoding</span>=<span class="string">UTF-8</span></span><br><span class="line"><span class="attr">log4j.appender.CONSOLE.layout.conversionPattern</span>=<span class="string">%d&#123; ABSOLUTE&#125; %5p %c&#123; 1&#125;:%L - %m%n</span></span><br></pre></td></tr></table></figure>



<p><code>log4j.xml</code>é…ç½®æ ·ä¾‹</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">log4j</span>:configuration <span class="keyword">SYSTEM</span> <span class="string">&quot;log4j.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">log4j:configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;CONSOLE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;target&quot;</span> <span class="attr">value</span>=<span class="string">&quot;System.out&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;immediateFlush&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;threshold&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;append&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d - %c -%-4r [%t] %-5p %x - %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.FileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;File&quot;</span> <span class="attr">value</span>=<span class="string">&quot;D:/logs/log.out&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ImmediateFlush&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Threshold&quot;</span> <span class="attr">value</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Append&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å•ç‹¬é…ç½®æŸä¸ªç±»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">name</span>=<span class="string">&quot;cn.ling.logs&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">priority</span> <span class="attr">value</span>=<span class="string">&quot;ERROR&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;FILE&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>







<h2 id="é…ç½®æ ¹Logger"><a href="#é…ç½®æ ¹Logger" class="headerlink" title="é…ç½®æ ¹Logger"></a>é…ç½®æ ¹Logger</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.rootLogger</span> = <span class="string">[ level ] , appenderName, appenderName, â€¦</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>levelæŒ‡çš„æ˜¯æ ¹loggerå¯¹è±¡çš„æ—¥å¿—ç­‰çº§ï¼ŒALL &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; OFF</p>
</li>
<li><p>Log4jå»ºè®®åªä½¿ç”¨4ä¸ªçº§åˆ«ï¼Œä»é«˜åˆ°ä½åˆ†åˆ«ä¸ºERROR &gt; WARN &gt; INFO &gt; DEBUGï¼›</p>
</li>
<li><p>appenderNameæŒ‡çš„æ˜¯æ ¹loggerå¯¹è±¡çš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºç›®çš„åœ°ï¼Œåœ¨æ­¤å¯ä»¥æŒ‡å®šå¤šä¸ªè¾“å‡ºç›®çš„åœ°ï¼›<br>æ—¥å¿—è¾“å‡ºçº§åˆ«INFO<br>è¾“å‡ºç›®çš„åœ° FILE CONSOLE<br><code>log4j.rootLogger = INFO, FILE, CONSOLE</code></p>
</li>
</ul>
<h2 id="é…ç½®æ—¥å¿—è¾“å‡ºç›®çš„åœ°"><a href="#é…ç½®æ—¥å¿—è¾“å‡ºç›®çš„åœ°" class="headerlink" title="é…ç½®æ—¥å¿—è¾“å‡ºç›®çš„åœ°"></a>é…ç½®æ—¥å¿—è¾“å‡ºç›®çš„åœ°</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName]</span> = <span class="string">[className]</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>appenderNameæŒ‡çš„æ˜¯æ—¥å¿—ä¿¡æ¯è¾“å‡ºç›®çš„åœ°çš„åç§°ï¼Œå¯è‡ªå®šä¹‰ï¼Œéœ€è¦ä¸æ ¹Loggerä¸­çš„appenderNameä¸€è‡´ï¼›</p>
</li>
<li><p>classNameæŒ‡çš„æ˜¯æ—¥å¿—è¾“å‡ºç›®çš„åœ°å¤„ç†ç±»ï¼Œå¿…é¡»ä¸ºå…¨é™å®šç±»åï¼›</p>
<p>å¸¸ç”¨çš„è¾“å‡ºç«¯æœ‰ï¼š</p>
<p>1ï¼‰æ§åˆ¶å°ï¼ˆ<code>org.apache.log4j.ConsoleAppender</code>ï¼‰</p>
<p>2ï¼‰æ–‡ä»¶ï¼ˆ<code>org.apache.log4j.FileAppender</code>&lt;å•ä¸ªæ–‡ä»¶&gt;ã€</p>
<p>â€‹          <code>org.apache.log4j.DailyRollingFileAppender</code>&lt;æ¯å¤©éƒ½äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶&gt;ã€ </p>
<p>â€‹          <code>org.apache.log4j.RollingFileAppender</code>&lt;æ–‡ä»¶å¤§å°è¾¾åˆ°æŒ‡å®šå°ºå¯¸æ—¶äº§ç”Ÿä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œæ–‡ä»¶åç§°ä¸Šä¼šè‡ªåŠ¨æ·»åŠ æ•°å­—åºå·&gt;ï¼‰</p>
<p>â€‹          <code>org.apache.log4j.varia.ExternallyRolledFileAppender</code>&lt;æ‰©å±•äº†<code>RollingFileAppender</code>&gt;</p>
<p>â€‹          </p>
<p>3ï¼‰æ•°æ®åº“ï¼ˆ<code>org.apache.log4j.jdbc.JDBCAppender</code> ï¼‰</p>
<p>4ï¼‰é‚®ä»¶ï¼ˆ<code>org.apache.log4j.net.SMTPAppender</code>ï¼‰</p>
<p>5ï¼‰å¼‚æ­¥æ‰“å°ï¼ˆ<code>org.apache.log4j.AsyncAppender</code>ï¼‰</p>
<p>6ï¼‰<code>org.apache.log4j.lf5.LF5Appender</code></p>
</li>
</ul>
<p>â€‹       7ï¼‰<code>org.apache.log4j.nt.NTEventLogAppender</code></p>
<p>â€‹       8ï¼‰<code>org.apache.log4j.varia.NullAppender</code></p>
<p>â€‹       9ï¼‰<code>org.apache.log4j.rewrite.RewriteAppender</code></p>
<p>â€‹       10ï¼‰<code>org.apache.log4j.net.SocketAppender</code></p>
<p>â€‹       11ï¼‰<code>org.apache.log4j.net.SocketHubAppender</code></p>
<p>â€‹       12ï¼‰<code>org.apache.log4j.net.SyslogAppender</code></p>
<p>â€‹       13ï¼‰<code>org.apache.log4j.net.TelnetAppender</code></p>
<p>â€‹       14ï¼‰å°†æ—¥å¿—ä¿¡æ¯ä»¥æµæ ¼å¼å‘é€åˆ°ä»»æ„æŒ‡å®šçš„åœ°æ–¹ï¼ˆ<code>org.apache.log4j.WriterAppender</code>ï¼‰</p>
<h3 id="è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„é…ç½®"><a href="#è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„é…ç½®" class="headerlink" title="è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„é…ç½®"></a>è¾“å‡ºåˆ°æ–‡ä»¶ä¸­çš„é…ç½®</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName]</span> = <span class="string">org.apache.log4j.FileAppender</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è¾“å‡ºä¸ºæ–‡ä»¶ç±»å‹çš„Appenderï¼š<code>FileAppender</code>ã€<code>DailyRollingFileAppender</code>ã€<code>RollingFileAppender</code></li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].File</span>=<span class="string">[D:/logs/log.out]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å°†æ—¥å¿—è¾“å‡ºåˆ°Dç›˜çš„logs&#x2F;log.outæ–‡ä»¶ä¸­</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].Append</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å°†æ–°å¢æ—¥å¿—è¿½åŠ åˆ°æ–‡ä»¶ä¸­,é»˜è®¤ä¸ºtrueä¸ºä¸è¦†ç›–,falseä¸ºè¦†ç›–</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].BufferedIO</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è¯·æ±‚çš„æ—¥å¿—æ¶ˆæ¯ä¸ä¼šç«‹å³è¾“å‡ºï¼Œå­˜å‚¨åˆ°ç¼“å­˜å½“ä¸­ï¼Œå½“ç¼“å­˜æ»¡äº†åæ‰è¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œé»˜è®¤ä¸ºfalse,æ­¤æ—¶<code>ImmediateFlush</code>åº”å½“è®¾ç½®ä¸ºfalse</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].BufferSize</span>= <span class="string">8192</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç¼“å­˜å¤§å°ï¼Œé»˜è®¤ä¸º8k</li>
</ul>
<h4 id="DailyRollingFileAppenderå•ç‹¬é…ç½®"><a href="#DailyRollingFileAppenderå•ç‹¬é…ç½®" class="headerlink" title="DailyRollingFileAppenderå•ç‹¬é…ç½®"></a>DailyRollingFileAppenderå•ç‹¬é…ç½®</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].DatePattern</span>=<span class="string">â€™.â€™yyyy-MM-dd-HH-mm</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ ‡è¯†æ¯å¤©äº§ç”Ÿä¸€ä¸ªæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šæŒ‰æœˆã€å‘¨ã€æ—¶ã€åˆ†ï¼Œå…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š<br>1)â€™.â€™yyyy-MM: æ¯æœˆ<br>2)â€™.â€™yyyy-ww: æ¯å‘¨<br>3)â€™.â€™yyyy-MM-dd: æ¯å¤©<br>4)â€™.â€™yyyy-MM-dd-a: æ¯å¤©ä¸¤æ¬¡<br>5)â€™.â€™yyyy-MM-dd-HH: æ¯å°æ—¶<br>6)â€™.â€™yyyy-MM-dd-HH-mm: æ¯åˆ†é’Ÿ</li>
</ul>
<h4 id="RollingFileAppenderå•ç‹¬é…ç½®"><a href="#RollingFileAppenderå•ç‹¬é…ç½®" class="headerlink" title="RollingFileAppenderå•ç‹¬é…ç½®"></a>RollingFileAppenderå•ç‹¬é…ç½®</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].MaxFileSize</span>=<span class="string">100KB</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æŒ‡å®šæ—¥å¿—æ–‡ä»¶åˆ‡å‰²å¤§å°ï¼Œé»˜è®¤<code>10MB</code>ï¼Œå•ä½<code>KB/MB/GB</code>ï¼›å½“æ—¥å¿—æ–‡ä»¶è¾¾åˆ°æŒ‡å®šå¤§å°åï¼Œå°†å½“å‰æ—¥å¿—æ–‡ä»¶å†…å®¹å‰ªåˆ‡åˆ°æ–°çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ–°çš„æ–‡ä»¶é»˜è®¤ä»¥â€œåŸæ–‡ä»¶å+.1â€ã€â€œåŸæ–‡ä»¶å+.2â€çš„å½¢å¼å‘½å</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.RFILE.MaxBackupIndex</span>=<span class="string">2</span></span><br></pre></td></tr></table></figure>

<ul>
<li>äº§ç”Ÿçš„åˆ‡å‰²æ–‡ä»¶æœ€å¤§æ•°é‡ï¼Œå¦‚æœç¬¬äºŒä¸ªæ–‡ä»¶è¶…è¿‡äº†æŒ‡å®šå¤§å°ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ–‡ä»¶å°†ä¼šè¢«åˆ é™¤</li>
</ul>
<h3 id="è¾“å‡ºåˆ°æ§åˆ¶å°çš„é…ç½®"><a href="#è¾“å‡ºåˆ°æ§åˆ¶å°çš„é…ç½®" class="headerlink" title="è¾“å‡ºåˆ°æ§åˆ¶å°çš„é…ç½®"></a>è¾“å‡ºåˆ°æ§åˆ¶å°çš„é…ç½®</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Targetå¯é€‰System.out,System.error</span></span><br><span class="line"><span class="attr">log4j.appender.[appenderName].Target</span>=<span class="string">System.out</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Targetå¯é€‰é…ç½®<code>System.out</code>ï¼Œ<code>System.error</code>ï¼›ä¸€èˆ¬ä½¿ç”¨<code>System.out</code></li>
</ul>
<h3 id="é€šç”¨é…ç½®"><a href="#é€šç”¨é…ç½®" class="headerlink" title="é€šç”¨é…ç½®"></a>é€šç”¨é…ç½®</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].Threshold</span> = <span class="string">[DEBUG]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æŒ‡å®šæ—¥å¿—è¾“å‡ºçš„æœ€ä½çº§åˆ«ï¼Œé»˜è®¤ä¸ºDEBUG;å¦‚æœæ—¥å¿—è¯·æ±‚çš„çº§åˆ«ä½äºæ­¤çº§åˆ«ï¼Œåˆ™ä¸ä¼šè¾“å‡ºæ­¤è¯·æ±‚æ—¥å¿—ä¿¡æ¯</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">og4j.appender.[appenderName].Encoding</span>=<span class="string">UTF-8</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç¼–ç </li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].ImmediateFlush</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è¯·æ±‚çš„æ—¥å¿—æ¶ˆæ¯è¢«ç«‹å³è¾“å‡º,é»˜è®¤ä¸ºtrue</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.[appenderName].layout</span> = <span class="string">[className]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¯æ¸²æŸ“çš„è¾“å‡ºç±»å‹ï¼š</li>
</ul>
<p>  1ï¼‰<code>org.apache.log4j.HTMLLayout</code>ï¼ˆä»¥htmlè¡¨æ ¼å½¢å¼å¸ƒå±€ï¼‰</p>
<p>  2ï¼‰ <code>org.apache.log4j.SimpleLayout</code>ï¼ˆç®€å•é£æ ¼å¸ƒå±€ï¼ŒåªåŒ…å«æ—¥å¿—ä¿¡æ¯å’Œçº§åˆ«ï¼‰</p>
<p>  3ï¼‰<code>org.apache.log4j.PatternLayout</code>ï¼ˆè‡ªå®šä¹‰é£æ ¼å¸ƒå±€ï¼Œå¯ä»¥åŒ…å«æ—¶é—´ï¼Œæ—¥å¿—çº§åˆ«ï¼Œæ—¥å¿—ç±»ï¼‰</p>
<p>  é€šå¸¸ä½¿ç”¨ç¬¬ä¸‰ä¸ª</p>
<h4 id="PatternLayoutè‡ªå®šä¹‰é…ç½®æ ·å¼"><a href="#PatternLayoutè‡ªå®šä¹‰é…ç½®æ ·å¼" class="headerlink" title="PatternLayoutè‡ªå®šä¹‰é…ç½®æ ·å¼"></a>PatternLayoutè‡ªå®šä¹‰é…ç½®æ ·å¼</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">log4j.appender.console.layout.ConversionPattern</span> = <span class="string">[%p][%d&#123;yyyy-MM-dd HH:mm:ss&#125;][%c]%m%n</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è¾“å‡ºæ ·å¼ ï¼š</p>
<p>  <code>%m</code>: è¾“å‡ºä»£ç ä¸­æŒ‡å®šçš„æ¶ˆæ¯<br>  <code>%p</code>: è¾“å‡ºä¼˜å…ˆçº§ï¼Œå³DEBUGï¼ŒINFOï¼ŒWARNï¼ŒERRORï¼ŒFATAL<br>  <code>%r</code>: è¾“å‡ºè‡ªåº”ç”¨å¯åŠ¨åˆ°è¾“å‡ºè¯¥logä¿¡æ¯è€—è´¹çš„æ¯«ç§’æ•°<br>  <code>%c</code>ï¼šè¾“å‡ºæ—¥å¿—ä¿¡æ¯æ‰€å±çš„æ—¥å¿—å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯getLogger()ä¸­çš„å†…å®¹ã€‚<br>  %Cï¼šè¾“å‡ºæ—¥å¿—ä¿¡æ¯æ‰€å±çš„ç±»ç›®ï¼›<br>  %loggerï¼šlog4jä¸­æ²¡æœ‰æ­¤æ ¼å¼ï¼›<br>  <code>%t</code>:  è¾“å‡ºäº§ç”Ÿè¯¥æ—¥å¿—äº‹ä»¶çš„çº¿ç¨‹å<br>  <code>%n</code>: è¾“å‡ºä¸€ä¸ªå›è½¦æ¢è¡Œç¬¦ï¼ŒWindowså¹³å°ä¸ºâ€rnâ€ï¼ŒUnixå¹³å°ä¸ºâ€nâ€<br>  <code>%d</code>:  è¾“å‡ºæ—¥å¿—æ—¶é—´ç‚¹çš„æ—¥æœŸæˆ–æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ä¸ºISO8601ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶åæŒ‡å®šæ ¼å¼ï¼Œ<br>  æ¯”å¦‚ï¼š<code>%d&#123;yyyy MM dd HH:mm:ss,SSS&#125;</code>ï¼Œè¾“å‡ºç±»ä¼¼ï¼š<code>2002å¹´10æœˆ18æ—¥ 22:10:28,921</code><br>  <code>%x</code>: è¾“å‡ºå’Œå½“å‰çº¿ç¨‹ç›¸å…³è”çš„NDC(åµŒå¥—è¯Šæ–­ç¯å¢ƒ),å°¤å…¶ç”¨åˆ°åƒjava servletsè¿™æ ·çš„å¤šå®¢æˆ·å¤šçº¿ç¨‹çš„åº”ç”¨ä¸­ã€‚<br>  <code>%%</code>: è¾“å‡ºä¸€ä¸ªâ€%â€å­—ç¬¦<br>  <code>%F</code>: è¾“å‡ºæ—¥å¿—æ¶ˆæ¯äº§ç”Ÿæ—¶æ‰€åœ¨çš„æ–‡ä»¶åç§°<br>  <code>%M</code>: è¾“å‡ºäº§ç”Ÿæ—¥å¿—ä¿¡æ¯çš„æ–¹æ³•å<br>  <code>%L</code>: è¾“å‡ºä»£ç ä¸­çš„è¡Œå·<br>  <code>%l</code>: è¾“å‡ºæ—¥å¿—äº‹ä»¶çš„å‘ç”Ÿä½ç½®ï¼Œç›¸å½“äº<code>%c.%M(%F:%L)</code>çš„ç»„åˆï¼ŒåŒ…æ‹¬ç±»å…¨åã€æ–¹æ³•ã€æ–‡ä»¶åä»¥åŠåœ¨ä»£ç ä¸­çš„è¡Œæ•°ã€‚<br>  ä¾‹å¦‚ï¼š<code>test.Log4jTest.main(Log4jTest.java:10)</code>ã€‚</p>
</li>
</ul>
<h2 id="é’©å­ç¨‹åº"><a href="#é’©å­ç¨‹åº" class="headerlink" title="é’©å­ç¨‹åº"></a>é’©å­ç¨‹åº</h2><p>â€‹        log4jåœ¨å¼€å¯ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œlog4jçš„æ€§èƒ½å¾—åˆ°äº†å¤§å¹…åº¦æå‡ã€‚æ—¢ç„¶ç¼“å­˜çš„ä¼˜åŠ¿è¿™ä¹ˆæ˜æ˜¾ï¼Œä¸ºä»€ä¹ˆlog4jä¸é»˜è®¤å¼€å¯ç¼“å­˜å‘¢ï¼Ÿ<br>ç¼“å­˜çš„å­˜åœ¨ï¼Œæœ‰åˆ©æœ‰å¼Šã€‚åˆ©ï¼Œæå‡ç³»ç»Ÿå“åº”æ€§èƒ½ï¼›å¼Šï¼Œå½“ç³»ç»Ÿå› ä¸ºå¼‚å¸¸è€Œå´©æºƒï¼Œåˆæˆ–è€…jvmè¢«å¼ºè¡Œå…³é—­ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜ä¸­çš„æ•°æ®ä¸¢å¤±ï¼Œæ—¥å¿—ä¸å­˜åœ¨ï¼Œæ— æ³•åŠæ—¶ç¡®å®šå¼‚å¸¸åŸå› ã€‚æˆ‘æƒ³ï¼Œè¿™ä¸ªæ‰æ˜¯log4jå¹¶æ²¡æœ‰é»˜è®¤å¼€å¯ç¼“å­˜çš„åŸå› ï¼<br>â€‹       æ—¥å¿—çš„å­˜åœ¨ï¼Œä¸€æ–¹é¢ä¸ºäº†è®°å½•ç³»ç»Ÿè¯·æ±‚çš„ä¿¡æ¯ï¼›å¦ä¸€æ–¹é¢ï¼Œå¸®åŠ©develpoeråŠæ—¶å‘ç°ã€æ’é™¤é”™è¯¯åŸå› ã€‚å¦‚æœè¿æ—¥å¿—çš„å®Œæ•´æ€§éƒ½ä¸èƒ½ä¿ç•™ï¼Œé‚£ä¹ˆæ—¥å¿—å­˜åœ¨çš„æ„ä¹‰åˆæ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥ï¼Œlog4jå¹¶æ²¡æœ‰å°†ç¼“å­˜è®¾ç½®ä¸ºé»˜è®¤å¼€å¯ï¼Œåªæ˜¯æä¾›äº†ä¸€ä¸ªé€‰é¡¹ï¼›<br>â€‹       é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿é±¼å’Œç†ŠæŒå¯ä»¥å…¼å¾—å‘¢ï¼Ÿåœ¨log4jæä¾›çš„apiä¸­æš‚æ—¶æ— æ³•å®ç°æ­¤éœ€æ±‚ï¼Œä¸è¿‡jvmå‘æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ï¼Œè¿™å°±æ˜¯jvmå…³é—­é’©å­ç¨‹åºï¼›<br>â€‹       åœ¨jvmä¸­æ³¨å†Œä¸€ä¸ªé’©å­ç¨‹åºï¼Œå½“jvmå…³é—­çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œç³»ç»Ÿä¸­å·²ç»è®¾ç½®çš„æ‰€æœ‰é€šè¿‡æ–¹æ³•addShutdownHookæ·»åŠ çš„é’©å­ï¼Œå½“ç³»ç»Ÿæ‰§è¡Œå®Œè¿™äº›é’©å­åï¼Œjvmæ‰ä¼šå…³é—­ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºæ–°çš„Appender,ç»§æ‰¿FileAppenderï¼Œåœ¨æ„é€ ä¸­æ·»åŠ é’©å­ç¨‹åºä»£ç ï¼š</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HookFileAppender</span> <span class="keyword">extends</span> <span class="title class_">FileAppender</span> &#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HookFileAppender</span><span class="params">()</span>&#123; </span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="comment">//æ·»åŠ é’©å­ç¨‹åºï¼š</span></span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Log4jHockThread</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HookFileAppender</span><span class="params">(Layout layout, String filename)</span> <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">        <span class="built_in">super</span>(layout,filename);</span><br><span class="line">        <span class="comment">//æ·»åŠ é’©å­ç¨‹åºï¼š</span></span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Log4jHockThread</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HookFileAppender</span><span class="params">(Layout layout, String filename, <span class="type">boolean</span> append)</span> <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">        <span class="built_in">super</span>(layout,filename,append);</span><br><span class="line">        <span class="comment">//æ·»åŠ é’©å­ç¨‹åºï¼š</span></span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Log4jHockThread</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HookFileAppender</span><span class="params">(Layout layout, String filename, <span class="type">boolean</span> append, <span class="type">boolean</span> bufferedIO,</span></span><br><span class="line"><span class="params">                 <span class="type">int</span> bufferSize)</span> <span class="keyword">throws</span> IOException &#123; </span><br><span class="line">        <span class="built_in">super</span>(layout,filename,append,bufferedIO,bufferSize);</span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Log4jHockThread</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Log4jHockThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123; </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123; </span><br><span class="line">            <span class="comment">//jvmç»“æŸä¹‹å‰ï¼Œè¿è¡Œflushæ“ä½œï¼Œå°†æ—¥å¿—è½ç›˜ï¼›</span></span><br><span class="line">            <span class="keyword">if</span>(qw != <span class="literal">null</span>)&#123; </span><br><span class="line">                qw.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="Log4j2é…ç½®"><a href="#Log4j2é…ç½®" class="headerlink" title="Log4j2é…ç½®"></a>Log4j2é…ç½®</h1><p><code>log4j2.xml</code>é…ç½®è¯¦è§£:</p>
<p>å®˜ç½‘æ–‡æ¡£ï¼š</p>
<p>1ï¼‰Configurationé…ç½®ï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/manual/configuration.html">https://logging.apache.org/log4j/2.x/manual/configuration.html</a></p>
<p>2ï¼‰å„ç§Appenderé…ç½®ï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/manual/appenders.html">https://logging.apache.org/log4j/2.x/manual/appenders.html</a></p>
<p>3ï¼‰å„ç§è¾“å‡ºå½¢å¼ï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/manual/layouts.html">https://logging.apache.org/log4j/2.x/manual/layouts.html</a></p>
<p>4ï¼‰æ—¥å¿—è¿‡æ»¤å™¨ï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/manual/filters.html">https://logging.apache.org/log4j/2.x/manual/filters.html</a></p>
<p>5ï¼‰å¼‚æ­¥æ—¥å¿—ï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/manual/async.html">https://logging.apache.org/log4j/2.x/manual/async.html</a></p>
<p>6ï¼‰Log4j SpringBootï¼š<a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/log4j-spring-boot.html">https://logging.apache.org/log4j/2.x/log4j-spring-boot.html</a></p>
<p>7ï¼‰Log4j SpringCloud Config Clientï¼š <a target="_blank" rel="noopener" href="https://logging.apache.org/log4j/2.x/log4j-spring-cloud-config-client.html">https://logging.apache.org/log4j/2.x/log4j-spring-cloud-config-client.html</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ—¥å¿—çº§åˆ«ä»¥åŠä¼˜å…ˆçº§æ’åº: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Configurationåé¢çš„statusï¼Œè¿™ä¸ªç”¨äºè®¾ç½®log4j2è‡ªèº«å†…éƒ¨çš„ä¿¡æ¯è¾“å‡ºï¼Œå¯ä»¥ä¸è®¾ç½®ï¼Œå½“è®¾ç½®æˆtraceæ—¶ï¼Œä½ ä¼šçœ‹åˆ°log4j2å†…éƒ¨å„ç§è¯¦ç»†è¾“å‡º--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--monitorIntervalï¼šLog4jèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ä¿®æ”¹é…ç½® æ–‡ä»¶å’Œé‡æ–°é…ç½®æœ¬èº«ï¼Œå¯è®¾ç½®ä¸€ä¸ªéé›¶çš„é—´éš”ç§’æ•°æ¥æ£€æµ‹é…ç½®å˜æ›´ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;WARN&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;60&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è‡ªå®šä¹‰ä¸€äº›å˜é‡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å˜é‡å®šä¹‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;log_base_dir&quot;</span>&gt;</span>/app_data/logs/my_app<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Appenderåœ¨å°†æ—¥å¿—æ•°æ®å†™å…¥ç›®æ ‡ä½ç½®ä¹‹å‰ï¼Œä¸€èˆ¬ä¼šå°†æ—¥å¿—æ•°æ®é€šè¿‡Layoutè¿›è¡Œæ ¼å¼åŒ–ã€‚PatternLayoutå¯ä»¥ä½¿ç”¨ä¸Cè¯­è¨€printfå‡½æ•°ç±»ä¼¼çš„è½¬æ¢æ¨¡å¼æ¥æŒ‡å®šè¾“å‡ºæ ¼å¼ã€‚å¸¸è§çš„é…ç½®å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">        - %d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; : æ—¥å¿—ç”Ÿæˆæ—¶é—´ï¼Œè¾“å‡ºæ ¼å¼ä¸ºâ€œå¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’.æ¯«ç§’â€</span></span><br><span class="line"><span class="comment">        - %p : æ—¥å¿—è¾“å‡ºæ ¼å¼</span></span><br><span class="line"><span class="comment">        - %c : loggerçš„åç§°</span></span><br><span class="line"><span class="comment">        - %m : æ—¥å¿—å†…å®¹ï¼Œå³ logger.info(&quot;message&quot;)</span></span><br><span class="line"><span class="comment">        - %n : æ¢è¡Œç¬¦</span></span><br><span class="line"><span class="comment">        - %T : çº¿ç¨‹å·</span></span><br><span class="line"><span class="comment">        - %L : æ—¥å¿—è¾“å‡ºæ‰€åœ¨è¡Œæ•°</span></span><br><span class="line"><span class="comment">        - %M : æ—¥å¿—è¾“å‡ºæ‰€åœ¨æ–¹æ³•å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;log_pattern&quot;</span>&gt;</span>[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;][%-5p][%T][%c.%M:%L] %msg%xEx%n<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼Œå•ä½å¯ä»¥æ˜¯KB, MB or GB --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;max_single_file_size&quot;</span>&gt;</span>1MB<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨Appenderså…ƒç´ å¯ä»¥å°†æ—¥å¿—äº‹ä»¶æ•°æ®å†™åˆ°å„ç§ç›®æ ‡ä½ç½®ï¼ˆç›®å‰å¯ä»¥ä¸ºæ§åˆ¶å°ã€æ–‡ä»¶ã€å¤šç§æ•°æ®åº“APIã€è¿œç¨‹å¥—æ¥å­—æœåŠ¡å™¨ã€Apache Flumeã€JMSã€è¿œç¨‹UNIX Syslog daemonï¼‰ï¼Œå…¶å†…çš„æ¯ä¸ªAppenderéƒ½å¿…é¡»è¦æœ‰ä¸€ä¸ªnameå±æ€§ä½œä¸ºå”¯ä¸€æ ‡è¯†ï¼Œè¯¥æ ‡è¯†çš„å€¼åœ¨Loggerä¸­é€šè¿‡AppenderRefæ¥å¼•ç”¨ï¼Œä»è€Œå°†è¯¥Appenderé…ç½®åˆ°è¯¥Loggerä¸­ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Console Appenderå¸¸ç”¨äºå°†æ—¥å¿—è¾“å‡ºåˆ°System.outï¼Œä¸€èˆ¬ç”¨åœ¨å¼€å‘ç¯å¢ƒ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- åªæ¥å—ç¨‹åºä¸­DEBUGçº§åˆ«çš„æ—¥å¿—è¿›è¡Œå¤„ç†--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒAppenderå°†æ ¼å¼åŒ–LogEventçš„è´£ä»»å§”æ‰˜ç»™Layout --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- RollingFile Appenderä¼šå°†æ—¥å¿—è¾“å‡ºåˆ°fileNameå±æ€§æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼Œä¸”éœ€è¦æŒ‡å®šTriggeringPolicyå’ŒRolloverStrategyã€‚å…¶ä¸­TriggeringPolicyå†³å®šæ˜¯å¦ç”Ÿæˆæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼ŒRolloverStrategyå†³å®šå¦‚ä½•ç”Ÿæˆæ–°çš„æ—¥å¿—æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰é…ç½®RolloverStrategyï¼Œåˆ™ä¼šä½¿ç”¨DefaultRolloverStrategyã€‚ä»2.5å¼€å§‹ï¼Œå¯ä»¥åœ¨DefaultRolloverStrategyä¸­é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„åˆ é™¤åŠ¨ä½œã€‚ä»2.8å¼€å§‹ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶åï¼Œåˆ™ä¼šä½¿ç”¨DirectWriteRolloverStrategyæ¥ä»£æ›¿DefaultRolloverStrategy --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- è¿™ä¸ªRollingFile Appenderä¼šæ‰“å°å‡ºæ‰€æœ‰çš„DEBUGåŠä»¥ä¸‹çº§åˆ«ï¼ˆDEBUGã€INFOã€ERRORã€FATALã€OFFï¼‰çš„ä¿¡æ¯ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;DebugLogRollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/my_app_debug.log&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/$$&#123;date:yyyy_MM_dd&#125;/my_app_debug_%d&#123;yyyy_MM_dd_HH&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Policiesè¡¨ç¤ºä¸€ä¸ªCompositeTriggeringPolicyï¼Œå¯ä»¥ç»„åˆå¤šä¸ªTriggeringPolicyï¼Œåªè¦å†…éƒ¨çš„ä»»æ„ä¸€ä¸ªTriggeringPolicyæ»¡è¶³è§¦å‘æ¡ä»¶ï¼Œéƒ½ä¼šæ»šåŠ¨æ—¥å¿— --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- TimeBasedTriggeringPolicyç”¨äºæŒ‰æ—¶é—´æ»šåŠ¨æ—¥å¿—ã€‚åªè¦filePatternå±æ€§å€¼ä¸­çš„æ—¥æœŸ/æ—¶é—´æ¨¡å¼ï¼ˆpatternï¼‰ä¸å†åº”ç”¨äºå½“å‰æ–‡ä»¶æ—¶å°±è¿›è¡Œæ—¥å¿—æ»šåŠ¨ã€‚è¿™ç§è§„åˆ™é€šè¿‡intervalå’Œmodulateå±æ€§æ¥é…ç½®ã€‚intervalå±æ€§æŒ‡å®šä¸€ä¸ªæ•´æ•°ï¼Œç”¨äºåŸºäºæ—¥æœŸ/æ—¶é—´æ¨¡å¼ä¸­çš„æœ€å°çš„æ—¶é—´å•ä½æ•°æ»šåŠ¨ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼ŒfilePatternå€¼ä¸º/app_data/logs/my_app/$$&#123;date:yyyy_MM_dd&#125;/my_app_%d&#123;yyyy_MM_dd_HH&#125;_%i.logï¼Œè¿™é‡Œä½¿ç”¨å°æ—¶ä½œä¸ºæœ€å°çš„æ—¶é—´å•ä½æ—¶ï¼Œå‡å¦‚intervalå‚æ•°å€¼ä¸º4ï¼Œåˆ™è¡¨ç¤ºæ¯4å°æ—¶æ»šåŠ¨ä¸€æ¬¡ã€‚é»˜è®¤å€¼ä¸º1ã€‚modulateè¡¨ç¤ºæ˜¯å¦è°ƒæ•´intervalå±æ€§å€¼ä»¥ä¾¿ä¸‹æ¬¡æ»šåŠ¨å‘ç”Ÿåœ¨intervalè¾¹ç•Œå¤„ã€‚å¦‚æœæ—¶é—´æœ€å°å•ä½ä¸ºå°æ—¶ï¼Œå½“å‰æ—¶é—´ä¸ºæ—©ä¸Š3ç‚¹ï¼Œé—´éš”ä¸º4å°æ—¶ï¼Œåˆ™ç¬¬ä¸€æ¬¡æ»šåŠ¨å°†å‘ç”Ÿåœ¨æ—©ä¸Š4ç‚¹æ—¶ï¼ˆè€Œä¸æ˜¯æ—©ä¸Š7ç‚¹ï¼‰ï¼Œåç»­æ»šåŠ¨å°†å‘ç”Ÿåœ¨æ—©ä¸Š8ç‚¹ã€ä¸­åˆ12ç‚¹ã€ä¸‹åˆ4ç‚¹ç­‰æ—¶åˆ» --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> <span class="attr">interval</span>=<span class="string">&quot;1&quot;</span> <span class="attr">modulate</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- SizeBasedTriggeringPolicyç”¨äºæŒ‰æ–‡ä»¶å¤§å°æ»šåŠ¨æ—¥å¿—ã€‚æ¯å½“æ—¥å¿—æ–‡ä»¶è¶…è¿‡sizeæŒ‡å®šçš„å¤§å°ï¼ˆä¸€èˆ¬ä¸è¶…è¿‡å‡ åMBï¼Œå¦åˆ™ä½¿ç”¨è½¯ä»¶æ‰“å¼€å¯¼å‡ºçš„æ—¥å¿—æ—¶å¾ˆä¸æ–¹ä¾¿ï¼‰ï¼Œåˆ™è¿™sizeå¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰filePatternå±æ€§æŒ‡å®šå»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©å­˜æ¡£ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;max_single_file_size&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- DefaultRolloverStrategyå¯ä»¥åŒæ—¶æ¥å—RollingFileAppenderä¸­filePatternå±æ€§å€¼ä¸­æ—¥æœŸ/æ—¶é—´å’Œæ•´æ•°è®¡æ•°å™¨ï¼ˆ%iï¼‰çš„patternï¼Œå½“æ—¥æœŸ/æ—¶é—´æ»¡è¶³æ¡ä»¶æ—¶ï¼Œåˆ™ä¼šä½¿ç”¨å½“å‰çš„æ—¥æœŸ/æ—¶é—´ç”Ÿæˆæ–°çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¦‚æœfilePatternå±æ€§å€¼ä¸­å«æœ‰ä¸€ä¸ªæ•´æ•°è®¡æ•°å™¨%iï¼Œåˆ™åœ¨æ¯æ¬¡æ»šåŠ¨æ—¶è¯¥æ•´æ•°éƒ½ä¼šå¢åŠ ï¼Œå¦‚æœfilePatternå±æ€§å€¼ä¸­åŒæ—¶åŒ…å«äº†æ—¥æœŸ/æ—¶é—´å’Œæ•´æ•°è®¡æ•°å™¨ï¼ˆ%iï¼‰ï¼Œè®¡æ•°å™¨ä¼šåœ¨æ—¥æœŸ/æ—¶é—´ä¸å˜æ—¶è€Œæ»¡è¶³å…¶ä»–æ»šåŠ¨è§¦å‘æ¡ä»¶æ—¶ï¼ˆæ–‡ä»¶å¤§å°ï¼‰å¼€å§‹è‡ªå¢ï¼Œç›´åˆ°æ—¥æœŸ/æ—¶é—´å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè®¡æ•°å™¨ä¼šé‡æ–°è‡ªå¢ã€‚ä»¥.gzã€.zipã€.bz2ã€deflateã€pack200æˆ–xzç»“å°¾çš„filePatternå€¼ï¼Œä¼šåœ¨æ—¥å¿—æ–‡ä»¶å½’æ¡£æ—¶ä»¥åç¼€å¯¹åº”çš„æ ¼å¼è¿›è¡Œå‹ç¼©ã€‚minå±æ€§æŒ‡å®šè®¡æ•°å™¨çš„æœ€å°å€¼ï¼Œé»˜è®¤ä¸º1ã€‚maxå±æ€§æŒ‡å®šè®¡æ•°å™¨çš„æœ€å¤§å€¼ï¼Œä¸€æ—¦è®¡æ•°å™¨è¾¾åˆ°äº†æœ€å¤§å€¼ï¼Œæœ€æ—©çš„å½’æ¡£å°†ä¼šåœ¨æ¯æ¬¡æ»šåŠ¨æ—¶è¢«åˆ é™¤ï¼Œé»˜è®¤å€¼ä¸º7ã€‚fileIndexå±æ€§å¦‚æœè®¾ç½®ä¸ºmaxï¼ˆé»˜è®¤ï¼‰ï¼Œåˆ™å…·æœ‰æ›´å¤§ç´¢å¼•çš„æ–‡ä»¶æ¯”å…·æœ‰æ›´å°ç´¢å¼•çš„æ–‡ä»¶å†…å®¹æ›´æ–°ï¼Œå¦‚æœè®¾ç½®ä¸ºminï¼Œæ–‡ä»¶å°†é‡å‘½åä¸”è®¡æ•°å™¨å°†éµå¾ªFixed Windowç­–ç•¥ï¼Œè¿™ä¸¤ç§æƒ…å†µå‡æœ‰å¯èƒ½å¯¼è‡´æ‰¹é‡çš„æ–‡ä»¶é‡å‘½åï¼Œè‡ª2.8ç‰ˆæœ¬å¼€å§‹ï¼Œå¦‚æœfileIndexå±æ€§è®¾ç½®ä¸ºnomaxï¼Œåˆ™minå’Œmaxå±æ€§å€¼éƒ½å°†ä¼šè¢«å¿½ç•¥ï¼Œæ–‡ä»¶ç¼–å·å°†æ¯æ¬¡é€’å¢1ï¼Œæ¯æ¬¡æ»šåŠ¨éƒ½ä¼šé€’å¢åˆ°æ›´å¤§çš„å€¼ï¼Œä¸”æ²¡æœ‰æœ€å¤§æ–‡ä»¶ç¼–å·çš„é™åˆ¶ --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;DefaultRolloverStrategy max=&quot;100&quot; min=&quot;1&quot; fileIndex = &quot;nomax&quot;/&gt;--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">fileIndex</span>=<span class="string">&quot;nomax&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- Log4j 2.5å¼•å…¥äº†åˆ é™¤åŠ¨ä½œï¼ˆDeleteå…ƒç´ ï¼‰ã€‚åœ¨æ»šåŠ¨åˆ é™¤æ—§çš„æ—¥å¿—æ–‡ä»¶æ—¶ï¼Œç›¸æ¯”ä½¿ç”¨DefaultRolloverStrategyçš„maxå±æ€§ï¼Œè¯¥åŠŸèƒ½å¯ä»¥è®©ç”¨æˆ·æ‹¥æœ‰æ›´å¤šçš„åˆ é™¤æ§åˆ¶ã€‚åˆ é™¤åŠ¨ä½œå¯ä»¥è®©ç”¨æˆ·é…ç½®è‹¥å¹²ä¸ªæ¡ä»¶æ¥åˆ é™¤ç›¸å¯¹äºåŸºå‡†ç›®å½•çš„æ–‡ä»¶ã€‚è¯¥åŠŸèƒ½å¯ä»¥åˆ é™¤éæ—¥å¿—æ–‡ä»¶ï¼Œä½¿ç”¨æ—¶ä¸€å®šè¦å°å¿ƒã€‚å¯ä»¥é€šè¿‡testModeå±æ€§æ¥æµ‹è¯•é…ç½®æ˜¯å¦ä¼šé”™åˆ æ–‡ä»¶ã€‚basePathå±æ€§å€¼ç”¨äºæŒ‡å®šåˆ é™¤æ–‡ä»¶çš„åŸºå‡†ç›®å½•ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šã€‚maxDepthå±æ€§æŒ‡å®šæ‰«æç›®å½•çš„æœ€å¤§å±‚çº§ï¼Œ0è¡¨ç¤ºä»…èƒ½è®¿é—®åŸºå‡†ç›®å½•ï¼ˆå®‰å…¨é™åˆ¶ä¸èƒ½è®¿é—®çš„æƒ…å†µé™¤å¤–ï¼‰ï¼ŒInteger.MAX_VALUEå€¼è¡¨ç¤ºå¯ä»¥è®¿é—®æ‰€æœ‰å±‚çº§ã€‚é»˜è®¤å€¼ä¸º1ï¼Œè¡¨ç¤ºä»…æ‰«æåŸºå‡†ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚testModeå±æ€§å€¼å¦‚æœè®¾ç½®ä¸ºtrueï¼Œæ–‡ä»¶ä¸ä¼šå®é™…åˆ é™¤ï¼Œè€Œæ˜¯åœ¨status loggeræ‰“å°ä¸€æ¡INFOçº§åˆ«çš„æ¶ˆæ¯ï¼Œå¯ä»¥ä½¿ç”¨è¯¥åŠŸèƒ½æ¥æµ‹è¯•æ˜¯å¦ä¼šé”™åˆ ç›®æ ‡æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºfalseã€‚--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- è¿™é‡Œçš„Deleteå…ƒç´ é…ç½®äº†æ¯æ¬¡æ»šåŠ¨éƒ½ä¼šåˆ é™¤åŸºå‡†ç›®å½•ä¸‹åŒ¹é…â€œ*/my_app_debug_*.log.gzâ€æ—¥å¿—æ–‡ä»¶ï¼Œåªè¦9åˆ†é’Ÿä»¥å‰çš„æ—¥å¿—æ–‡ä»¶æ€»å¤§å°è¶…è¿‡2MBï¼Œæˆ–9åˆ†é’Ÿä»¥å‰çš„æ—¥å¿—æ–‡ä»¶æ–‡ä»¶æ€»æ•°è¶…è¿‡2ä¸ªå°±æŒ‰æ—¶é—´é¡ºåºåˆ é™¤è¾ƒæ—©çš„æ—¥å¿—æ–‡ä»¶ã€‚è¯¥å…ƒç´ å¯ä»¥é˜²æ­¢æ—¥å¿—æ–‡ä»¶æ‰€åœ¨åˆ†åŒºçš„ç£ç›˜ç©ºé—´è¢«å æ»¡ã€‚ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰åœ¨å‘ç”Ÿæ—¥å¿—æ»šåŠ¨æ—¶æ‰ä¼šå°è¯•è¿›è¡Œåˆ é™¤ï¼Œå¦åˆ™å³ä½¿æ»¡è¶³äº†åˆ é™¤æ¡ä»¶ï¼Œä½†å¦‚æœæ²¡æœ‰æ–°çš„æ»šåŠ¨æ—¥å¿—ç”Ÿæˆçš„è¯ä¹Ÿä¸ä¼šå‘ç”Ÿåˆ é™¤æ“ä½œã€‚ --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Delete</span> <span class="attr">basePath</span>=<span class="string">&quot;$&#123;log_base_dir&#125;&quot;</span> <span class="attr">maxDepth</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- Deleteå…ƒç´ é‡Œå¯ä»¥æŒ‡å®šè‹¥å¹²ä¸ªPathConditionç±»å‹çš„å…ƒç´ ã€‚å¦‚æœæŒ‡å®šäº†ä¸æ­¢ä¸€ä¸ªæ¡ä»¶ï¼Œåˆ™è¿™äº›æ¡ä»¶éƒ½éœ€è¦åœ¨åˆ é™¤ä¹‹å‰æ¥å—æŸä¸ªè·¯å¾„ã€‚è¿™äº›æ¡ä»¶å¯ä»¥åµŒå¥—ï¼Œåªæœ‰å¤–éƒ¨æ¡ä»¶æ¥å—æŸä¸ªè·¯å¾„ä¹‹åï¼Œå…¶å†…éƒ¨æ¡ä»¶æ‰ä¼šå†³å®šæ˜¯å¦æ¥å—è¯¥è·¯å¾„ã€‚å¦‚æœè¿™äº›æ¡ä»¶æ²¡æœ‰åµŒå¥—ï¼Œåˆ™å®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯ä»»æ„çš„ã€‚è¿™äº›æ¡ä»¶ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨IfAll, IfAnyå’ŒIfNotç­‰ç»„åˆæ¡ä»¶è¿›è¡ŒANDã€ORå’ŒNOTç­‰é€»è¾‘è¿ç®—ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ¡ä»¶æˆ–ä½¿ç”¨å†…ç½®æ¡ä»¶ï¼š</span></span><br><span class="line"><span class="comment">                    - IfFileNameï¼šæ¥å—åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼æˆ–globçš„æ–‡ä»¶è·¯å¾„ï¼›</span></span><br><span class="line"><span class="comment">                    - IfLastModifiedï¼šæ¥å—æ¯”æŒ‡å®šæ—¶æ®µæ—©æˆ–ä¸€æ ·æ—©çš„æ–‡ä»¶ï¼›</span></span><br><span class="line"><span class="comment">                    - IfAccumulatedFileCountï¼šåœ¨éå†æ–‡ä»¶æ ‘æ—¶æ–‡ä»¶æ€»æ•°è¶…è¿‡æ–‡ä»¶æ•°ä¸Šé™åæ¥å—è·¯å¾„ï¼›</span></span><br><span class="line"><span class="comment">                    - IfAccumulatedFileSizeï¼šåœ¨éå†æ–‡ä»¶æ ‘æ—¶æ–‡ä»¶æ€»å¤§å°è¶…è¿‡ä¸Šé™åæ¥å—è·¯å¾„ï¼›</span></span><br><span class="line"><span class="comment">                    - IfAllï¼šå¦‚æœæ‰€æœ‰å†…åµŒæ¡ä»¶éƒ½æ¥å—äº†æŸä¸ªè·¯å¾„æ‰ä¼šæ¥å—è¯¥è·¯å¾„ï¼Œç›¸å½“äºANDé€»è¾‘ï¼Œå…¶å†…åµŒæ¡ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯ä»»æ„çš„ï¼›</span></span><br><span class="line"><span class="comment">                    - IfAnyï¼šå¦‚æœä»»æ„ä¸€ä¸ªå†…åµŒæ¡ä»¶æ¥å—äº†æŸä¸ªç›®å½•å°±æ¥å—è¯¥ç›®å½•ï¼Œç›¸å½“äºORé€»è¾‘ï¼Œå…¶å†…åµŒæ¡ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯ä»»æ„çš„ï¼›</span></span><br><span class="line"><span class="comment">                    - IfNotï¼šå¦‚æœå†…åµŒæ¡ä»¶ä¸æ¥å—æŸä¸ªè·¯å¾„å°±æ¥æ”¶è¯¥è·¯å¾„ï¼Œç›¸å½“äºNOTé€»è¾‘ã€‚--&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- IfFileNameå¯ä»¥é€šè¿‡globï¼ˆä½¿ç”¨å—é™çš„æ¨¡å¼è¯­è¨€,æ¯”æ­£åˆ™æ›´ç®€å•ï¼‰æˆ–regexå±æ€§ï¼ˆæ­£åˆ™ï¼‰æ¥åŒ¹é…ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºDeleteçš„basePathå±æ€§æŒ‡å®šçš„åŸºå‡†ç›®å½•ï¼‰--&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- å½“å¤–éƒ¨çš„æ¡ä»¶æ»¡è¶³æ—¶æ‰ä¼šè®¡ç®—å†…éƒ¨çš„æ¡ä»¶ï¼Œå†…éƒ¨çš„åŒçº§æ¡ä»¶çš„è®¡ç®—é¡ºåºæ˜¯ä»»æ„çš„ã€‚ --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">IfFileName</span> <span class="attr">glob</span>=<span class="string">&quot;*/my_app_debug_*.log.gz&quot;</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- IfLastModifiedå¯ä»¥é€šè¿‡ageå±æ€§å€¼æ¥æŒ‡å®šæ¥å—æœ€åä¿®æ”¹æ—¶é—´ä¸ºæŒ‡å®šæ—¶é—´æˆ–æ—©äºæŒ‡å®šæ—¶é—´çš„è·¯å¾„ï¼Œè¯¥å±æ€§çš„å€¼å¯å‚è€ƒorg.apache.logging.log4j.core.appender.rolling.action.Duration.parse(CharSequence text)æ–¹æ³•çš„æ–‡æ¡£ --&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- è¿™é‡Œçš„IfLastModifiedæŒ‡å®šåˆ é™¤è¾¾åˆ°æˆ–è¶…è¿‡60å¤©å†…çš„æ–‡ä»¶ --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">IfLastModified</span> <span class="attr">age</span>=<span class="string">&quot;9m&quot;</span>&gt;</span></span><br><span class="line">                            <span class="comment">&lt;!-- è¿™é‡Œçš„IfAnyå†…åµŒäº†ä¸¤ä¸ªPathConditionï¼Œè¡¨ç¤ºæ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å³å¯ --&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                                <span class="comment">&lt;!-- IfAccumulatedFileSizeå¯é€šè¿‡exceedså±æ€§å€¼æŒ‡å®šä¸€ä¸ªæ–‡ä»¶æ€»å¤§å°ä¸Šé™å€¼ã€‚å¦‚æœæ–‡ä»¶æ•°è¶…è¿‡äº†è¯¥ä¸Šé™å€¼åˆ™åˆ é™¤æ–‡ä»¶ --&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">IfAccumulatedFileSize</span> <span class="attr">exceeds</span>=<span class="string">&quot;2MB&quot;</span>/&gt;</span></span><br><span class="line">                                <span class="comment">&lt;!-- IfAccumulatedFileCountå¯é€šè¿‡exceedså±æ€§å€¼æŒ‡å®šä¸€ä¸ªæ–‡ä»¶æ€»æ•°ä¸Šé™å€¼ã€‚å¦‚æœæ–‡ä»¶æ•°è¶…è¿‡äº†è¯¥ä¸Šé™å€¼åˆ™åˆ é™¤æ–‡ä»¶ --&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">IfAccumulatedFileCount</span> <span class="attr">exceeds</span>=<span class="string">&quot;2&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">IfLastModified</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">IfFileName</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">Delete</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">DefaultRolloverStrategy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;InfoLogRollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/my_app_info.log&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/$$&#123;date:yyyy_MM_dd&#125;/my_app_info_%d&#123;yyyy_MM_dd_HH&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;max_single_file_size&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">fileIndex</span>=<span class="string">&quot;nomax&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Delete</span> <span class="attr">basePath</span>=<span class="string">&quot;$&#123;log_base_dir&#125;&quot;</span> <span class="attr">maxDepth</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">IfFileName</span> <span class="attr">glob</span>=<span class="string">&quot;*/my_app_info_*.log.gz&quot;</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- è¿™é‡Œè¡¨ç¤ºåŒ¹é…â€œ*/my_app_info_*.log.gzâ€æ¨¡å¼çš„æ—¥å¿—æ–‡ä»¶çš„åˆ é™¤ç­–ç•¥å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment">                        - åªè¦æ—¥å¿—æ–‡ä»¶æ€»æ•°é‡è¶…è¿‡5ä¸ªå°±åˆ é™¤æŒ‰æ—¶é—´é¡ºåºæœ€æ—©çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"><span class="comment">                        - åªè¦æ—¥å¿—æ–‡ä»¶æ€»å¤§å°è¶…è¿‡10MBå°±ä¼šåˆ é™¤æŒ‰æ—¶é—´é¡ºåºæœ€æ—©çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"><span class="comment">                        - åªè¦æ—¥å¿—æ–‡ä»¶æœ€è¿‘ä¿®æ”¹æ—¶é—´ä¸º9åˆ†é’Ÿå‰æˆ–æ›´æ—©å°±ä¼šåˆ é™¤æŒ‰æ—¶é—´é¡ºåºæœ€æ—©çš„æ—¥å¿—æ–‡ä»¶ --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileSize</span> <span class="attr">exceeds</span>=<span class="string">&quot;8MB&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileCount</span> <span class="attr">exceeds</span>=<span class="string">&quot;5&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfLastModified</span> <span class="attr">age</span>=<span class="string">&quot;9m&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">IfFileName</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">Delete</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">DefaultRolloverStrategy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;WarnLogRollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/my_app_warn.log&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/$$&#123;date:yyyy_MM_dd&#125;/my_app_warn_%d&#123;yyyy_MM_dd_HH&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;WARN&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;max_single_file_size&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">fileIndex</span>=<span class="string">&quot;nomax&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Delete</span> <span class="attr">basePath</span>=<span class="string">&quot;$&#123;log_base_dir&#125;&quot;</span> <span class="attr">maxDepth</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">IfFileName</span> <span class="attr">glob</span>=<span class="string">&quot;*/my_app_warn_*.log.gz&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileSize</span> <span class="attr">exceeds</span>=<span class="string">&quot;3GB&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileCount</span> <span class="attr">exceeds</span>=<span class="string">&quot;3000&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfLastModified</span> <span class="attr">age</span>=<span class="string">&quot;30d&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">IfFileName</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">Delete</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">DefaultRolloverStrategy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;ErrorLogRollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/my_app_error.log&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/$$&#123;date:yyyy_MM_dd&#125;/my_app_error_%d&#123;yyyy_MM_dd_HH&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;max_single_file_size&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">fileIndex</span>=<span class="string">&quot;nomax&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Delete</span> <span class="attr">basePath</span>=<span class="string">&quot;$&#123;log_base_dir&#125;&quot;</span> <span class="attr">maxDepth</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">IfFileName</span> <span class="attr">glob</span>=<span class="string">&quot;*/my_app_error_*.log.gz&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileSize</span> <span class="attr">exceeds</span>=<span class="string">&quot;3GB&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileCount</span> <span class="attr">exceeds</span>=<span class="string">&quot;3000&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfLastModified</span> <span class="attr">age</span>=<span class="string">&quot;30d&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">IfFileName</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">Delete</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">DefaultRolloverStrategy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- è®°å½•druidçš„SQLè¯­å¥ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;DruidSqlRollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/druid.log&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">filePattern</span>=<span class="string">&quot;$&#123;log_base_dir&#125;/$$&#123;date:yyyy_MM_dd&#125;/druid_%d&#123;yyyy_MM_dd_HH&#125;_%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;$&#123;log_pattern&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;$&#123;max_single_file_size&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">fileIndex</span>=<span class="string">&quot;nomax&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Delete</span> <span class="attr">basePath</span>=<span class="string">&quot;$&#123;log_base_dir&#125;&quot;</span> <span class="attr">maxDepth</span>=<span class="string">&quot;2&quot;</span> <span class="attr">testMode</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">IfFileName</span> <span class="attr">glob</span>=<span class="string">&quot;*/druid_*.log.gz&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileSize</span> <span class="attr">exceeds</span>=<span class="string">&quot;3GB&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfAccumulatedFileCount</span> <span class="attr">exceeds</span>=<span class="string">&quot;3000&quot;</span>/&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">IfLastModified</span> <span class="attr">age</span>=<span class="string">&quot;30d&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">IfAny</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">IfFileName</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">Delete</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">DefaultRolloverStrategy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å®šä¹‰loggerï¼Œåªæœ‰å®šä¹‰äº†loggerå¹¶å¼•å…¥çš„appenderï¼Œappenderæ‰ä¼šç”Ÿæ•ˆ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å½“Loggeråœ¨é…ç½®æ–‡ä»¶ä¸­å£°æ˜æ—¶ï¼Œå°±åˆ›å»ºäº†ä¸€ä¸ªLoggerConfigå¯¹è±¡ï¼Œä¸¤è€…ä¸€ä¸€å¯¹åº”ï¼ŒLoggerConfigåŒ…å«ä¸€äº›Filterã€è¿™äº›Filtersç”¨äºè¿‡æ»¤ä¼ é€’ç»™ä»»æ„Appenderçš„LogEventï¼Œå®ƒè¿˜åŒ…å«ä¸€äº›Appenderçš„å¼•ç”¨ã€‚Loggeræœ¬èº«æ‰§è¡Œæ— æŒ‡å‘çš„åŠ¨ä½œï¼Œå®ƒä»…å«æœ‰ä¸€ä¸ªä¸LoggerConfigå…³è”çš„åç§°ï¼ˆé€šè¿‡nameå±æ€§æŒ‡å®šï¼‰ï¼Œroot Loggerå…·æœ‰å›ºå®šçš„é»˜è®¤åç§°ï¼Œå…¶ä»–Loggeréœ€è¦æŒ‡å®šå„è‡ªçš„nameå±æ€§å€¼ã€‚LoggerConfigä¼šè¢«åˆ†é…ä¸€ä¸ªæ—¥å¿—çº§åˆ«ï¼Œé€šè¿‡levelå±æ€§æ¥æŒ‡å®šã€‚å†…å»ºçš„æ—¥å¿—çº§åˆ«æŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°åº•æ’åºæœ‰ï¼šOFF &gt; FATAL &gt;ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALLï¼ŒLog4j 2 ä¹Ÿæ”¯æŒè‡ªå®šä¹‰çš„æ—¥å¿—çº§åˆ«ã€‚ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;ALL&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;InfoLogRollingFile&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;WarnLogRollingFile&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;DebugLogRollingFile&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;ErrorLogRollingFile&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- æ¯ä¸ªLoggerConfigçš„æ—¥å¿—çº§åˆ«å¦‚æœæ²¡æœ‰æ˜¾å¼é…ç½®ï¼Œåˆ™ä¼šç»§æ‰¿å…¶çˆ¶çº§LoggerConfigçš„æ—¥å¿—çº§åˆ«ï¼Œè€Œroot LoggerConfigå¦‚æœæ²¡æœ‰é…ç½®æ—¥å¿—çº§åˆ«ï¼Œåˆ™ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªé»˜è®¤çš„ERRORçº§åˆ« --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æŸä¸ªLoggeræ‰€å…è®¸çš„æ¯æ¡æ—¥å¿—æ‰“å°è¯·æ±‚éƒ½ä¼šä¼ é€’ç»™å…¶LoggerConfigä¸­çš„æ‰€æœ‰Appenderï¼Œä¹Ÿä¼šä¼ é€’ç»™è¯¥LoggerConfigçš„parent LoggerConfigä¸­çš„Appenderï¼Œè¿™ç§ç°è±¡ç§°ä¸ºç›¸åŠ æ€§ï¼ˆAdditivityï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAppenderä¼šä»LoggerConfigçš„ç»§æ‰¿ä¸­ç»§æ‰¿ç›¸åŠ æ€§ã€‚è¿™ç§ç‰¹æ€§å¯ä»¥ç”¨æ¥æ±‡æ•´æŸå‡ ä¸ªloggerçš„è¾“å‡ºï¼Œå¯ä»¥åœ¨å£°æ˜Loggerçš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½®additivity=&quot;false&quot;æ¥ç¦ç”¨è¿™ç§å åŠ ç»§æ‰¿ --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è®°å½•druid-sqlçš„è®°å½•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;druid.sql.Statement&quot;</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;DruidSqlRollingFile&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--è¿‡æ»¤æ‰springå’Œmybatisçš„ä¸€äº›æ— ç”¨çš„DEBUGä¿¡æ¯--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.springframework&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.mybatis&quot;</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--log4j2 è‡ªå¸¦è¿‡æ»¤æ—¥å¿—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.catalina.startup.DigesterFactory&quot;</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.catalina.util.LifecycleBase&quot;</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.sshd.common.util.SecurityUtils&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.tomcat.util.net.NioSelectorPool&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.crsh.plugin&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.crsh.ssh&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.eclipse.jetty.util.component.AbstractLifeCycle&quot;</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.hibernate.validator.internal.util.Version&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.springframework.boot.actuate.autoconfigure.CrshAutoConfiguration&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.springframework.boot.actuate.endpoint.jmx&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.thymeleaf&quot;</span> <span class="attr">level</span>=<span class="string">&quot;warn&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Log4j2åŸºç¡€é…ç½®"><a href="#Log4j2åŸºç¡€é…ç½®" class="headerlink" title="Log4j2åŸºç¡€é…ç½®"></a>Log4j2åŸºç¡€é…ç½®</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;HH:mm:ss.SSS&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Log4j2åŠ è½½é…ç½®çš„é¡ºåº"><a href="#Log4j2åŠ è½½é…ç½®çš„é¡ºåº" class="headerlink" title="Log4j2åŠ è½½é…ç½®çš„é¡ºåº"></a>Log4j2åŠ è½½é…ç½®çš„é¡ºåº</h2><ol>
<li>ä»ç³»ç»Ÿå±æ€§<code>log4j2.configurationFile</code>è·å–é…ç½®æ–‡ä»¶URI<ul>
<li>å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘ç»œæ–‡ä»¶ã€‚é€šè¿‡é…ç½®<code>log4j2.Configuration.allowedProtocols</code>ï¼ˆ å¯é€‰é…ç½®https, file, jarï¼‰æ¥æŒ‡å®šä½¿ç”¨ä»€ä¹ˆåè®®åŠ è½½æ–‡ä»¶<code>http://</code>ã€<code>file://</code>ç­‰ï¼‰ï¼Œ</li>
<li>åŒæ—¶å¦‚æœä½¿ç”¨httpåè®®åŠ è½½æ—¶å¦‚æœç”¨åˆ°äº†é‰´æƒï¼š<ul>
<li>å¯ä»¥ä½¿ç”¨ <code>log4j2.Configuration.username</code> å’Œ<code>log4j2.Configuration.password</code></li>
<li>æˆ–è€…ä½¿ç”¨<code>log4j2.Configuration.authenticationProvider</code>æ¥æŒ‡å®šé‰´æƒçš„ç±»åï¼ˆ<code>AuthenticationProvider</code>çš„å­ç±»ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li><code>log4j2-test.properties</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2.configurationFile</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2-test.yaml</code>æˆ–è€…<code>log4j2-test.yml</code>:åœ¨æ‰¾ä¸åˆ°<code>log4j2-test.properties</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2-test.json</code>æˆ–è€…<code>log4j2-test.jsn</code>:åœ¨æ‰¾ä¸åˆ°<code>log4j2-test.yaml</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2-test.xml</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2-test.json</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2.properties</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2-test.xml</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2.yaml</code>æˆ–<code>log4j2.yml</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2.properties</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2.json</code>æˆ–<code>log4j2.jsn</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2.yaml</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li><code>log4j2.xml</code>ï¼šåœ¨æ‰¾ä¸åˆ°<code>log4j2.json</code>çš„æƒ…å†µä¸‹ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶</li>
<li>å½“ä¸Šè¿°é…ç½®æ–‡ä»¶éƒ½æ‰¾ä¸åˆ°æ—¶ï¼Œåˆ™ä½¿ç”¨DefaultConfigurationçš„é»˜è®¤é…ç½®</li>
</ol>
<h2 id="Log4j2æä¾›äº†æ ¹æ®è‡ªå®šä¹‰ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒçš„Log4j2é…ç½®ï¼ˆArbiterï¼‰"><a href="#Log4j2æä¾›äº†æ ¹æ®è‡ªå®šä¹‰ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒçš„Log4j2é…ç½®ï¼ˆArbiterï¼‰" class="headerlink" title="Log4j2æä¾›äº†æ ¹æ®è‡ªå®šä¹‰ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒçš„Log4j2é…ç½®ï¼ˆArbiterï¼‰"></a>Log4j2æä¾›äº†æ ¹æ®è‡ªå®šä¹‰ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒçš„Log4j2é…ç½®ï¼ˆArbiterï¼‰</h2><p>æˆ‘ä»¬å®é™…ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿæ—¶éœ€è¦æ ¹æ®ä¸åŒçš„ç¯å¢ƒæ¥ä½¿ç”¨ä¸åŒé…ç½®çš„Log4j2é…ç½®ï¼Œè¿™å°±ç”¨åˆ°äº†log4j2é‡è¦çš„å±æ€§arbiteré…ç½®ï¼Œå¸¸ç”¨çš„Arbiteræœ‰<code>SystemPropertyArbiter </code>ï¼Œ<code>ScriptArbiter</code>ï¼Œ<code>SpringProfile </code></p>
<ol>
<li><p>SystemPropertyArbiterä½¿ç”¨</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">name</span>=<span class="string">&quot;ConfigTest&quot;</span> <span class="attr">status</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">SystemPropertyArbiter</span> <span class="attr">propertyName</span>=<span class="string">&quot;env&quot;</span> <span class="attr">propertyValue</span>=<span class="string">&quot;dev&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m%n&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">SystemPropertyArbiter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">SystemPropertyArbiter</span> <span class="attr">propertyName</span>=<span class="string">&quot;env&quot;</span> <span class="attr">propertyValue</span>=<span class="string">&quot;prod&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">List</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">SystemPropertyArbiter</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.test&quot;</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p><code>ScriptArbiter</code>é…åˆ<code>Select</code>ä½¿ç”¨</p>
</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">name</span>=<span class="string">&quot;ConfigTest&quot;</span> <span class="attr">status</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ScriptArbiter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ScriptFile</span> <span class="attr">language</span>=<span class="string">&quot;JavaScript&quot;</span> <span class="attr">path</span>=<span class="string">&quot;src/test/resources/scripts/prodtest.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m%n&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ScriptArbiter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">DefaultArbiter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">List</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">DefaultArbiter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Select</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.test&quot;</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ol start="3">
<li>SpringProfileä½¿ç”¨ç¤ºä¾‹</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">name</span>=<span class="string">&quot;ConfigTest&quot;</span> <span class="attr">status</span>=<span class="string">&quot;ERROR&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">SpringProfile</span> <span class="attr">name</span>=<span class="string">&quot;dev | staging&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m%n&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">SpringProfile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">SpringProfile</span> <span class="attr">name</span>=<span class="string">&quot;prod&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">List</span> <span class="attr">name</span>=<span class="string">&quot;Out&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">SpringProfile</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.test&quot;</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Out&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="ä½¿ç”¨é’ˆå¯¹æŸä¸ªç±»è¿›è¡Œå•ç‹¬çš„æ—¥å¿—è®¾ç½®"><a href="#ä½¿ç”¨é’ˆå¯¹æŸä¸ªç±»è¿›è¡Œå•ç‹¬çš„æ—¥å¿—è®¾ç½®" class="headerlink" title="ä½¿ç”¨é’ˆå¯¹æŸä¸ªç±»è¿›è¡Œå•ç‹¬çš„æ—¥å¿—è®¾ç½®"></a>ä½¿ç”¨é’ˆå¯¹æŸä¸ªç±»è¿›è¡Œå•ç‹¬çš„æ—¥å¿—è®¾ç½®</h2><p>ä»¥ä¸‹ç¤ºä¾‹å°±æ˜¯é’ˆå¯¹<code>com.foo.Bar</code>è¯¥ç±»çš„æ—¥å¿—è¿›è¡Œè®¾ç½®æ—¥å¿—ç­‰çº§ä»¥åŠè¾“å‡ºå¤®è§†</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;HH:mm:ss.SSS&#125; [%t] %-5level %logger&#123;36&#125; - %msg%n&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Loggerä¸ºå¯é€‰é…ç½®ï¼Œadditivityå±æ€§ç”¨äºï¼Œé»˜è®¤ä¸ºtureï¼šé‚£ä¹ˆå½“Rootå’ŒLoggeréƒ½èƒ½å…³è”åˆ°è¯¥ç±»æ—¶åˆ™ä¼šé‡å¤æ‰“å°ä¸¤æ¬¡æ—¥å¿—ï¼Œå¦‚æœå…³è”è¿‡å¤šå¯èƒ½ä¼šå‡ºç°å¤§é‡é‡å¤æ—¥å¿—ï¼Œæ‰€ä»¥è¯¥å±æ€§å»ºè®®å…³é—­&#x27;false&#x27; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;com.foo.Bar&quot;</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- Rootä¸ºå¿…é€‰é…ç½®ï¼Œè€Œä¸”ä¸æ”¯æŒnameå±æ€§ï¼Œä¸”ä¸æ”¯æŒadditivityå±æ€§  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Configurationé…ç½®å±æ€§"><a href="#Configurationé…ç½®å±æ€§" class="headerlink" title="Configurationé…ç½®å±æ€§"></a><code>Configuration</code>é…ç½®å±æ€§</h2><p>é€šè¿‡é…ç½®<code>Configuration</code>çš„<code>monitorInterval</code>æ¥é…ç½®é…ç½®æ–‡ä»¶åˆ·æ–°çš„æ—¶é—´é—´éš”</p>
<table>
<thead>
<tr>
<th align="left">å±æ€§åç§°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">advertiser</td>
<td align="left">(å»ºè®®å±æ€§)ç”¨äºFileAppenderæˆ–è€…SocketAppender çš„é…ç½®ï¼Œåªæœ‰ä¸€ä¸ªå€¼å¯å¡«å†™ï¼š<code>multicastdns</code></td>
</tr>
<tr>
<td align="left">dest</td>
<td align="left">æ–‡ä»¶è·¯å¾„ï¼ŒURLæˆ–è€…ç”¨äºstderrçš„<code>err</code>, ç”¨äºstdoutçš„<code>out</code></td>
</tr>
<tr>
<td align="left">monitorInterval</td>
<td align="left">æ£€æŸ¥Log4j2é…ç½®æ–‡ä»¶æœ€å°çš„æ—¶é—´é—´éš”ï¼Œå•ä½ï¼ˆç§’ï¼‰</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">é…ç½®çš„åç§°</td>
</tr>
<tr>
<td align="left">packages</td>
<td align="left">(è¯¥å±æ€§å·²ç»åœ¨Log4j 3.0ä¸­ç§»é™¤é‡Œäº†)è¯¥æ’ä»¶ç”¨äºæ‰«ælog4jæ³¨è§£çš„ç±»ï¼Œè€Œä¸”ä»…ä»…åœ¨é¦–æ¬¡ç±»åŠ è½½ï¼ˆclassloader ï¼‰æ—¶è¿›è¡Œæ‰«æï¼Œåç»­ä¸ä¼šäºŒæ¬¡æ‰«æã€‚</td>
</tr>
<tr>
<td align="left">schema</td>
<td align="left">schemaæ–‡ä»¶çš„URLï¼Œç”¨äºä¸¥æ ¼æ ¡éªŒXMLæ–‡ä»¶çš„åˆæ³•æ€§ã€‚</td>
</tr>
<tr>
<td align="left">shutdownHook</td>
<td align="left">Log4j2çš„é’©å­ï¼Œé»˜è®¤å€¼<code>enable</code>,å¯ä»¥ä½¿ç”¨<code>disable</code>ç¦ç”¨ã€‚æŒ‡å®š Log4j æ˜¯å¦åº”åœ¨ JVM å…³é—­æ—¶è‡ªåŠ¨å…³é—­</td>
</tr>
<tr>
<td align="left">shutdownTimeout</td>
<td align="left">æŒ‡å®šappenderåœ¨JVMå…³é—­å‰å¤šå°‘æ¯«ç§’å†…å…³é—­ã€‚é»˜è®¤å€¼ä¸º0ã€‚ï¼ˆæ³¨ï¼šå¼‚æ­¥å†™å…¥æ—¥å¿—æ—¶ç«‹å³å…³é—­appenderå¯èƒ½æˆ–å¯¼è‡´éƒ¨é—¨æ—¥å¿—ä¸¢å¤±ï¼‰ ï¼Œå¦‚æœ <code>shutdownHook</code>è®¾ç½®ä¸º<code>disable</code>  ï¼Œé‚£ä¹ˆè¯¥å±æ€§åˆ™ä¸ç”Ÿæ•ˆã€‚</td>
</tr>
<tr>
<td align="left">status</td>
<td align="left">æ—¥å¿—çº§åˆ«ï¼šâ€offâ€, â€œtraceâ€, â€œdebugâ€, â€œinfoâ€, â€œwarnâ€, â€œerrorâ€, â€œfatalâ€, â€œallâ€ã€‚</td>
</tr>
<tr>
<td align="left">strict</td>
<td align="left">æ˜¯å¦ä¸¥æ ¼æ ¡éªŒXMLçš„æ ¼å¼ã€‚<code>true</code>,<code>false</code></td>
</tr>
<tr>
<td align="left">verbose</td>
<td align="left">åŠ è½½æ’ä»¶æ—¶å¯ç”¨è¯Šæ–­ä¿¡æ¯</td>
</tr>
</tbody></table>
<h2 id="é…ç½®Filterï¼ˆé…ç½®è¿‡æ»¤å™¨ï¼Œè€Œéæ‰“å°æ—¥å¿—è¿‡æ»¤å™¨ï¼‰"><a href="#é…ç½®Filterï¼ˆé…ç½®è¿‡æ»¤å™¨ï¼Œè€Œéæ‰“å°æ—¥å¿—è¿‡æ»¤å™¨ï¼‰" class="headerlink" title="é…ç½®Filterï¼ˆé…ç½®è¿‡æ»¤å™¨ï¼Œè€Œéæ‰“å°æ—¥å¿—è¿‡æ»¤å™¨ï¼‰"></a>é…ç½®Filterï¼ˆé…ç½®è¿‡æ»¤å™¨ï¼Œè€Œéæ‰“å°æ—¥å¿—è¿‡æ»¤å™¨ï¼‰</h2><p>Log4j2å…è®¸é…ç½®filterçš„4ç§æ–¹å¼ï¼š</p>
<ol>
<li>äº<code>appenders</code>,<code>loggers </code>,<code>properties </code>åŒçº§çš„æ ‡ç­¾ï¼šåœ¨ä¼ å…¥LoggerConfigå‰å¯¹é…ç½®è¿›è¡Œè¿‡æ»¤</li>
<li><code>Logger</code>çš„å­æ ‡ç­¾ï¼šç”¨äºLoggerçš„è¿‡æ»¤å™¨</li>
<li><code>Appender</code>çš„å­æ ‡ç­¾ï¼šç”¨äºAppenderçš„äº‹ä»¶çš„è¿‡æ»¤</li>
<li><code>Appender</code>çš„å…³è”æ ‡ç­¾å¤„ï¼šç”¨äºå†³å®šAppenderæ˜¯å¦åº”ç”¨äºLogger</li>
</ol>
<p>ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">name</span>=<span class="string">&quot;XMLConfigTest&quot;</span> <span class="attr">packages</span>=<span class="string">&quot;org.apache.logging.log4j.test&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;filename&quot;</span>&gt;</span>target/test.log<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Properties</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--è¿‡æ»¤å™¨1--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m MDC%X%n&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;FLOW&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- this pattern outputs class name and line number --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%C&#123;1&#125;.%M %m %ex%n&quot;</span>/&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--è¿‡æ»¤å™¨2--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">filters</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MarkerFilter</span> <span class="attr">marker</span>=<span class="string">&quot;FLOW&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;NEUTRAL&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MarkerFilter</span> <span class="attr">marker</span>=<span class="string">&quot;EXCEPTION&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">filters</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">File</span> <span class="attr">name</span>=<span class="string">&quot;File&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;filename&#125;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d %p %C&#123;1.&#125; [%t] %m%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.logging.log4j.test1&quot;</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--è¿‡æ»¤å™¨3--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThreadContextMapFilter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">KeyValuePair</span> <span class="attr">key</span>=<span class="string">&quot;test&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ThreadContextMapFilter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.logging.log4j.test2&quot;</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>$&#123;sys:user.name&#125;<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;File&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--è¿‡æ»¤å™¨4--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ThreadContextMapFilter</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">KeyValuePair</span> <span class="attr">key</span>=<span class="string">&quot;test&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ThreadContextMapFilter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">AppenderRef</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="è‡ªå®šä¹‰å±æ€§é…ç½®äºä½¿ç”¨"><a href="#è‡ªå®šä¹‰å±æ€§é…ç½®äºä½¿ç”¨" class="headerlink" title="è‡ªå®šä¹‰å±æ€§é…ç½®äºä½¿ç”¨"></a>è‡ªå®šä¹‰å±æ€§é…ç½®äºä½¿ç”¨</h2><p>å±æ€§é…ç½®å‰ç¼€ï¼š</p>
<table>
<thead>
<tr>
<th align="left">Prefix</th>
<th align="left">Context</th>
</tr>
</thead>
<tbody><tr>
<td align="left">base64</td>
<td align="left">base64åŠ å¯†çš„æ•°æ®ï¼Œä½¿ç”¨æ–¹å¼  <code>$&#123;base64:Base64_encoded_data&#125;</code>. ä¾‹å¦‚: <code>$&#123;base64:SGVsbG8gV29ybGQhCg==&#125;</code> è¡¨ç¤º<code>Hello World!</code>.</td>
</tr>
<tr>
<td align="left">bundle</td>
<td align="left">å±æ€§é›†åˆï¼Œç±»ä¼¼Mapã€‚ä½¿ç”¨æ–¹å¼ï¼š <code>$&#123;bundle:BundleName:BundleKey&#125;</code>. ä¾‹å¦‚: <code>$&#123;bundle:com.domain.Messages:MyKey&#125;</code>.</td>
</tr>
<tr>
<td align="left">ctx</td>
<td align="left">çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼ˆThread Context Map (MDC)ï¼‰</td>
</tr>
<tr>
<td align="left">date</td>
<td align="left">ä½¿ç”¨å½“å‰æ—¥æœŸã€æ—¶é—´ ï¼Œé€šè¿‡è®¾ç½®æ—¥æœŸæ ¼å¼</td>
</tr>
<tr>
<td align="left">env</td>
<td align="left">è·å–ç³»ç»Ÿå˜é‡å±æ€§ï¼Œä½¿ç”¨æ–¹å¼ï¼š <code>$&#123;env:ENV_NAME&#125;</code> æˆ–è€… <code>$&#123;env:ENV_NAME:-default_value&#125;</code>.</td>
</tr>
<tr>
<td align="left">jndi</td>
<td align="left">ä»JNDIä¸Šä¸‹æ–‡ä¸­è·å–å¯¹åº”çš„å€¼ã€‚éœ€è¦è®¾ç½®ç³»ç»Ÿå±æ€§<code>log4j2.enableJndiLookup</code>ä¸º<code>true</code></td>
</tr>
<tr>
<td align="left">jvmrunargs</td>
<td align="left">é€šè¿‡JMXè·å–JVMçš„è¾“å…¥å‚æ•°ï¼ˆémainæ–¹æ³•çš„è¾“å…¥å‚æ•°ï¼‰ï¼Œç¨‹åºä¸­å¯ä»¥é€šè¿‡ä½¿ç”¨<code>RuntimeMXBean.getInputArguments()</code>è·å–ã€‚è¯¥å‰ç¼€åœ¨å®‰å“ä¸­æ— æ³•ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td align="left">log4j</td>
<td align="left">ä»Log4jçš„é…ç½®å±æ€§ä¸­è·å–ã€‚ä½¿ç”¨æ–¹å¼ <code>$&#123;log4j:configLocation&#125;</code> æˆ–è€…<code>$&#123;log4j:configParentLocation&#125;</code></td>
</tr>
<tr>
<td align="left">main</td>
<td align="left">é€šè¿‡<code>MapLookup.setMainArguments(String[])</code> è®¾ç½®çš„å€¼</td>
</tr>
<tr>
<td align="left">map</td>
<td align="left">ä»Mapä¸­è·å–æŸä¸€å±æ€§</td>
</tr>
<tr>
<td align="left">sd</td>
<td align="left">ä»ç»“æ„åŒ–çš„æ•°æ®ä¸­è·å–å¯¹åº”çš„å€¼ã€‚A value from a StructuredDataMessage. The key â€œidâ€ will return the name of the StructuredDataId without the enterprise number. The key â€œtypeâ€ will return the message type. Other keys will retrieve individual elements from the Map.</td>
</tr>
<tr>
<td align="left">sys</td>
<td align="left">ç³»ç»Ÿå±æ€§ï¼Œä½¿ç”¨æ–¹å¼ <code>$&#123;sys:some.property&#125;</code> æˆ–è€… <code>$&#123;sys:some.property:-default_value&#125;</code>.</td>
</tr>
</tbody></table>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">name</span>=<span class="string">&quot;RoutingTest&quot;</span> <span class="attr">packages</span>=<span class="string">&quot;org.apache.logging.log4j.test&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Property</span> <span class="attr">name</span>=<span class="string">&quot;filename&quot;</span>&gt;</span>target/rolling1/rollingtest-$$&#123;sd:type&#125;.log<span class="tag">&lt;/<span class="name">Property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span>/&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m%n&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Routing</span> <span class="attr">name</span>=<span class="string">&quot;Routing&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Routes</span> <span class="attr">pattern</span>=<span class="string">&quot;$$&#123;sd:type&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Route</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;Rolling-$&#123;sd:type&#125;&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;filename&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">filePattern</span>=<span class="string">&quot;target/rolling1/test1-$&#123;sd:type&#125;.%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d %p %c&#123;1.&#125; [%t] %m%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;500&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">key</span>=<span class="string">&quot;Audit&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Routes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Routing</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;EventLogger&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Routing&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="ä½¿ç”¨Scripts"><a href="#ä½¿ç”¨Scripts" class="headerlink" title="ä½¿ç”¨Scripts"></a>ä½¿ç”¨Scripts</h2><p>å¯ä»¥ä½¿ç”¨çš„æ ‡ç­¾ï¼š</p>
<ol>
<li><code>&lt;script&gt;</code>ï¼šå¯ä»¥åŒ…å«Scriptæ–‡æœ¬</li>
<li><code>&lt;scriptFile&gt;</code>ï¼š</li>
<li><code>&lt;scriptRef&gt;</code></li>
</ol>
<p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">name</span>=<span class="string">&quot;RoutingTest&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Scripts</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Script</span> <span class="attr">name</span>=<span class="string">&quot;selector&quot;</span> <span class="attr">language</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml">&lt;![CDATA[</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            var result;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            if (logEvent.getLoggerName().equals(&quot;JavascriptNoLocation&quot;)) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">                result = &quot;NoLocation&quot;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            &#125; else if (logEvent.getMarker() != null &amp;&amp; logEvent.getMarker().isInstanceOf(&quot;FLOW&quot;)) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">                result = &quot;Flow&quot;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            result;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">            ]]&gt;</span></span><span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ScriptFile</span> <span class="attr">name</span>=<span class="string">&quot;groovy.filter&quot;</span> <span class="attr">path</span>=<span class="string">&quot;scripts/filter.groovy&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Scripts</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ScriptPatternSelector</span> <span class="attr">defaultPattern</span>=<span class="string">&quot;%d %p %m%n&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ScriptRef</span> <span class="attr">ref</span>=<span class="string">&quot;selector&quot;</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">PatternMatch</span> <span class="attr">key</span>=<span class="string">&quot;NoLocation&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;[%-5level] %c&#123;1.&#125; %msg%n&quot;</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">PatternMatch</span> <span class="attr">key</span>=<span class="string">&quot;Flow&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;[%-5level] %c&#123;1.&#125; ====== %C&#123;1.&#125;.%M:%L %msg ======%n&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ScriptPatternSelector</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%m%n&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Logger</span> <span class="attr">name</span>=<span class="string">&quot;EventLogger&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ScriptFilter</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMisMatch</span>=<span class="string">&quot;DENY&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">Script</span> <span class="attr">name</span>=<span class="string">&quot;GroovyFilter&quot;</span> <span class="attr">language</span>=<span class="string">&quot;groovy&quot;</span>&gt;</span><span class="language-javascript">&lt;![<span class="variable constant_">CDATA</span>[</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (logEvent.<span class="title function_">getMarker</span>() != <span class="literal">null</span> &amp;&amp; logEvent.<span class="title function_">getMarker</span>().<span class="title function_">isInstanceOf</span>(<span class="string">&quot;FLOW&quot;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (logEvent.<span class="title function_">getContextMap</span>().<span class="title function_">containsKey</span>(<span class="string">&quot;UserId&quot;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            ]]&gt;</span></span><br><span class="line"><span class="language-javascript">          </span><span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ScriptFilter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Logger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;error&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ScriptFilter</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMisMatch</span>=<span class="string">&quot;DENY&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ScriptRef</span> <span class="attr">ref</span>=<span class="string">&quot;groovy.filter&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ScriptFilter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">æ±‚æ‰“èµ</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/AliPay.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/AliPay.png" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><span class="icon iconify" data-icon="ri:alipay-line"></span></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/WechatPay.png"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/michaelchan90/blog-imgbed/img/WechatPay.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><span class="icon iconify" data-icon="ri:wechat-pay-line"></span></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Michael Chan</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://michaelchan90.github.io/2023/02/17/Log4j%E4%B8%8ELog4j2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/" title="Log4jä¸Log4j2æ—¥å¿—é…ç½®è¯¦è§£">http://michaelchan90.github.io/2023/02/17/Log4j%E4%B8%8ELog4j2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> è®¸å¯åè®®ã€‚</li></ul><script>document.addEventListener('copy', function (event) {
  const clipboardData = event.clipboardData || window.clipboardData;
  if (!clipboardData) { return; }
  const text = window.getSelection().toString();
  if (text) {
    event.preventDefault();
    clipboardData.setData('text/plain', text + '\n\næœ¬æ–‡ä½œè€…ï¼šMichael Chan\næœ¬æ–‡é“¾æ¥ï¼šhttp://michaelchan90.github.io/2023/02/17/Log4j%E4%B8%8ELog4j2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/\nç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ CC BY-NC-SA 4.0 è®¸å¯åè®®ã€‚');
  }
});</script></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2023/02/25/MySQL%E5%A4%87%E4%BB%BD%E4%B9%8Bercona-xtrabackup/" rel="prev" title="MySQLå¤‡ä»½ä¹‹ercona-xtrabackup"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">MySQLå¤‡ä»½ä¹‹ercona-xtrabackup</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2023/02/13/Centos7%E5%86%85%E6%A0%B8%E7%94%B13.10%E5%8D%87%E7%BA%A7%E5%88%B05.4%E7%89%88%E6%9C%AC/" rel="next" title="Centos7å†…æ ¸ç”±3.10å‡çº§åˆ°5.4ç‰ˆæœ¬"><span class="post-nav-text">Centos7å†…æ ¸ç”±3.10å‡çº§åˆ°5.4ç‰ˆæœ¬</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">äº¬ICPå¤‡xxxxxxxxå·</a></div><div class="copyright"><span>&copy; 2023 </span><span class="with-love" id="animate" title="æ˜Ÿæ— å°˜çš„èµåŠ©è€…"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> Michael Chan</span></div><div class="live-time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2023-01-01T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} å¤© ${passHour} å°æ—¶ ${passMinute} åˆ† ${passSecond} ç§’`;
}
blog_live_time();
</script></div><div id="busuanzi"><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><span class="icon iconify" data-icon="ri:user-line"></span></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><span class="icon iconify" data-icon="ri:eye-line"></span></span><span id="busuanzi_value_site_pv"></span></span><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:search-line"></span></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="https://fastly.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js"></script><script src="/js/search/local-search.js" defer type="module"></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><span class="icon iconify" data-icon="ri:close-line"></span></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div class="search-result-container"></div></div><script>function initMourn() {
  const date = new Date();
  const today = (date.getMonth() + 1) + "-" + date.getDate()
  const mourn_days = ["4-4","9-18","12-13"]
  if (mourn_days.includes(today)) {
    document.documentElement.style.filter = "grayscale(1)";
  }
}
initMourn();</script></body></html>